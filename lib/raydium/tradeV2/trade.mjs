import{get as Lt,set as yn}from"lodash";import Ct from"dayjs";import wn from"dayjs/plugin/utc";Ct.extend(wn);var Xe=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Ct().utc().format("YYYY/MM/DD HH:mm:ss UTC")}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let n=t.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},Nt={},xn={};function F(e){let t=Lt(Nt,e);if(!t){let n=Lt(xn,e);t=new Xe({name:e,logLevel:n}),yn(Nt,e,t)}return t}import{PublicKey as is}from"@solana/web3.js";import ss from"bn.js";import kr from"big.js";import Ko from"bn.js";import G from"bn.js";var ce=9e15,ne=1e9,Qe="0123456789abcdef",Ne="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Ce="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",$e={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-ce,maxE:ce,crypto:!1},Mt,X,B=!0,Ee="[DecimalError] ",te=Ee+"Invalid argument: ",Dt=Ee+"Precision limit exceeded",_t=Ee+"crypto unavailable",vt="[object Decimal]",V=Math.floor,v=Math.pow,Tn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Pn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,An=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Ot=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,z=1e7,P=7,Bn=9007199254740991,Sn=Ne.length-1,et=Ce.length-1,m={toStringTag:vt};m.absoluteValue=m.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),T(e)};m.ceil=function(){return T(new this.constructor(this),this.e+1,2)};m.clampedTo=m.clamp=function(e,t){var n,r=this,i=r.constructor;if(e=new i(e),t=new i(t),!e.s||!t.s)return new i(NaN);if(e.gt(t))throw Error(te+t);return n=r.cmp(e),n<0?e:r.cmp(t)>0?t:new i(r)};m.comparedTo=m.cmp=function(e){var t,n,r,i,o=this,s=o.d,a=(e=new o.constructor(e)).d,c=o.s,u=e.s;if(!s||!a)return!c||!u?NaN:c!==u?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-u:0;if(c!==u)return c;if(o.e!==e.e)return o.e>e.e^c<0?1:-1;for(r=s.length,i=a.length,t=0,n=r<i?r:i;t<n;++t)if(s[t]!==a[t])return s[t]>a[t]^c<0?1:-1;return r===i?0:r>i^c<0?1:-1};m.cosine=m.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+P,r.rounding=1,n=kn(r,Ut(r,n)),r.precision=e,r.rounding=t,T(X==2||X==3?n.neg():n,e,t,!0)):new r(1):new r(NaN)};m.cubeRoot=m.cbrt=function(){var e,t,n,r,i,o,s,a,c,u,f=this,l=f.constructor;if(!f.isFinite()||f.isZero())return new l(f);for(B=!1,o=f.s*v(f.s*f,1/3),!o||Math.abs(o)==1/0?(n=O(f.d),e=f.e,(o=(e-n.length+1)%3)&&(n+=o==1||o==-2?"0":"00"),o=v(n,1/3),e=V((e+1)/3)-(e%3==(e<0?-1:2)),o==1/0?n="5e"+e:(n=o.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),r=new l(n),r.s=f.s):r=new l(o.toString()),s=(e=l.precision)+3;;)if(a=r,c=a.times(a).times(a),u=c.plus(f),r=N(u.plus(f).times(a),u.plus(c),s+2,1),O(a.d).slice(0,s)===(n=O(r.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!i&&n=="4999"){if(!i&&(T(a,e+1,0),a.times(a).times(a).eq(f))){r=a;break}s+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(T(r,e+1,1),t=!r.times(r).times(r).eq(f));break}return B=!0,T(r,e,l.rounding,t)};m.decimalPlaces=m.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-V(this.e/P))*P,e=t[e],e)for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n};m.dividedBy=m.div=function(e){return N(this,new this.constructor(e))};m.dividedToIntegerBy=m.divToInt=function(e){var t=this,n=t.constructor;return T(N(t,new n(e),0,1,1),n.precision,n.rounding)};m.equals=m.eq=function(e){return this.cmp(e)===0};m.floor=function(){return T(new this.constructor(this),this.e+1,3)};m.greaterThan=m.gt=function(e){return this.cmp(e)>0};m.greaterThanOrEqualTo=m.gte=function(e){var t=this.cmp(e);return t==1||t===0};m.hyperbolicCosine=m.cosh=function(){var e,t,n,r,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(e=Math.ceil(i/3),t=(1/Me(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),o=le(s,1,o.times(t),new s(1),!0);for(var c,u=e,f=new s(8);u--;)c=o.times(o),o=a.minus(c.times(f.minus(c.times(f))));return T(o,s.precision=n,s.rounding=r,!0)};m.hyperbolicSine=m.sinh=function(){var e,t,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(t=o.precision,n=o.rounding,o.precision=t+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=le(o,2,i,i,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,i=i.times(1/Me(5,e)),i=le(o,2,i,i,!0);for(var s,a=new o(5),c=new o(16),u=new o(20);e--;)s=i.times(i),i=i.times(a.plus(s.times(c.times(s).plus(u))))}return o.precision=t,o.rounding=n,T(i,t,n,!0)};m.hyperbolicTangent=m.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,N(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)};m.inverseCosine=m.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),i=n.precision,o=n.rounding;return r!==-1?r===0?t.isNeg()?j(n,i,o):new n(0):new n(NaN):t.isZero()?j(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,t=t.asin(),e=j(n,i+4,o).times(.5),n.precision=i,n.rounding=o,e.minus(t))};m.inverseHyperbolicCosine=m.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,B=!1,n=n.times(n).minus(1).sqrt().plus(n),B=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)};m.inverseHyperbolicSine=m.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,B=!1,n=n.times(n).plus(1).sqrt().plus(n),B=!0,r.precision=e,r.rounding=t,n.ln())};m.inverseHyperbolicTangent=m.atanh=function(){var e,t,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=o.precision,t=o.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?T(new o(i),e,t,!0):(o.precision=n=r-i.e,i=N(i.plus(1),new o(1).minus(i),n+e,1),o.precision=e+4,o.rounding=1,i=i.ln(),o.precision=e,o.rounding=t,i.times(.5))):new o(NaN)};m.inverseSine=m.asin=function(){var e,t,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(t=i.abs().cmp(1),n=o.precision,r=o.rounding,t!==-1?t===0?(e=j(o,n+4,r).times(.5),e.s=i.s,e):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))};m.inverseTangent=m.atan=function(){var e,t,n,r,i,o,s,a,c,u=this,f=u.constructor,l=f.precision,p=f.rounding;if(u.isFinite()){if(u.isZero())return new f(u);if(u.abs().eq(1)&&l+4<=et)return s=j(f,l+4,p).times(.25),s.s=u.s,s}else{if(!u.s)return new f(NaN);if(l+4<=et)return s=j(f,l+4,p).times(.5),s.s=u.s,s}for(f.precision=a=l+10,f.rounding=1,n=Math.min(28,a/P+2|0),e=n;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(B=!1,t=Math.ceil(a/P),r=1,c=u.times(u),s=new f(u),i=u;e!==-1;)if(i=i.times(c),o=s.minus(i.div(r+=2)),i=i.times(c),s=o.plus(i.div(r+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===o.d[e]&&e--;);return n&&(s=s.times(2<<n-1)),B=!0,T(s,f.precision=l,f.rounding=p,!0)};m.isFinite=function(){return!!this.d};m.isInteger=m.isInt=function(){return!!this.d&&V(this.e/P)>this.d.length-2};m.isNaN=function(){return!this.s};m.isNegative=m.isNeg=function(){return this.s<0};m.isPositive=m.isPos=function(){return this.s>0};m.isZero=function(){return!!this.d&&this.d[0]===0};m.lessThan=m.lt=function(e){return this.cmp(e)<0};m.lessThanOrEqualTo=m.lte=function(e){return this.cmp(e)<1};m.logarithm=m.log=function(e){var t,n,r,i,o,s,a,c,u=this,f=u.constructor,l=f.precision,p=f.rounding,d=5;if(e==null)e=new f(10),t=!0;else{if(e=new f(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new f(NaN);t=e.eq(10)}if(n=u.d,u.s<0||!n||!n[0]||u.eq(1))return new f(n&&!n[0]?-1/0:u.s!=1?NaN:n?0:1/0);if(t)if(n.length>1)o=!0;else{for(i=n[0];i%10===0;)i/=10;o=i!==1}if(B=!1,a=l+d,s=ee(u,a),r=t?Ie(f,a+10):ee(e,a),c=N(s,r,a,1),de(c.d,i=l,p))do if(a+=10,s=ee(u,a),r=t?Ie(f,a+10):ee(e,a),c=N(s,r,a,1),!o){+O(c.d).slice(i+1,i+15)+1==1e14&&(c=T(c,l+1,0));break}while(de(c.d,i+=10,p));return B=!0,T(c,l,p)};m.minus=m.sub=function(e){var t,n,r,i,o,s,a,c,u,f,l,p,d=this,y=d.constructor;if(e=new y(e),!d.d||!e.d)return!d.s||!e.s?e=new y(NaN):d.d?e.s=-e.s:e=new y(e.d||d.s!==e.s?d:NaN),e;if(d.s!=e.s)return e.s=-e.s,d.plus(e);if(u=d.d,p=e.d,a=y.precision,c=y.rounding,!u[0]||!p[0]){if(p[0])e.s=-e.s;else if(u[0])e=new y(d);else return new y(c===3?-0:0);return B?T(e,a,c):e}if(n=V(e.e/P),f=V(d.e/P),u=u.slice(),o=f-n,o){for(l=o<0,l?(t=u,o=-o,s=p.length):(t=p,n=f,s=u.length),r=Math.max(Math.ceil(a/P),s)+2,o>r&&(o=r,t.length=1),t.reverse(),r=o;r--;)t.push(0);t.reverse()}else{for(r=u.length,s=p.length,l=r<s,l&&(s=r),r=0;r<s;r++)if(u[r]!=p[r]){l=u[r]<p[r];break}o=0}for(l&&(t=u,u=p,p=t,e.s=-e.s),s=u.length,r=p.length-s;r>0;--r)u[s++]=0;for(r=p.length;r>o;){if(u[--r]<p[r]){for(i=r;i&&u[--i]===0;)u[i]=z-1;--u[i],u[r]+=z}u[r]-=p[r]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(e.d=u,e.e=Re(u,n),B?T(e,a,c):e):new y(c===3?-0:0)};m.modulo=m.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?T(new r(n),r.precision,r.rounding):(B=!1,r.modulo==9?(t=N(n,e.abs(),0,3,1),t.s*=e.s):t=N(n,e,0,r.modulo,1),t=t.times(e),B=!0,n.minus(t))};m.naturalExponential=m.exp=function(){return tt(this)};m.naturalLogarithm=m.ln=function(){return ee(this)};m.negated=m.neg=function(){var e=new this.constructor(this);return e.s=-e.s,T(e)};m.plus=m.add=function(e){var t,n,r,i,o,s,a,c,u,f,l=this,p=l.constructor;if(e=new p(e),!l.d||!e.d)return!l.s||!e.s?e=new p(NaN):l.d||(e=new p(e.d||l.s===e.s?l:NaN)),e;if(l.s!=e.s)return e.s=-e.s,l.minus(e);if(u=l.d,f=e.d,a=p.precision,c=p.rounding,!u[0]||!f[0])return f[0]||(e=new p(l)),B?T(e,a,c):e;if(o=V(l.e/P),r=V(e.e/P),u=u.slice(),i=o-r,i){for(i<0?(n=u,i=-i,s=f.length):(n=f,r=o,s=u.length),o=Math.ceil(a/P),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=u.length,i=f.length,s-i<0&&(i=s,n=f,f=u,u=n),t=0;i;)t=(u[--i]=u[i]+f[i]+t)/z|0,u[i]%=z;for(t&&(u.unshift(t),++r),s=u.length;u[--s]==0;)u.pop();return e.d=u,e.e=Re(u,r),B?T(e,a,c):e};m.precision=m.sd=function(e){var t,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(te+e);return n.d?(t=Kt(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t};m.round=function(){var e=this,t=e.constructor;return T(new t(e),e.e+1,t.rounding)};m.sine=m.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+P,r.rounding=1,n=Nn(r,Ut(r,n)),r.precision=e,r.rounding=t,T(X>2?n.neg():n,e,t,!0)):new r(NaN)};m.squareRoot=m.sqrt=function(){var e,t,n,r,i,o,s=this,a=s.d,c=s.e,u=s.s,f=s.constructor;if(u!==1||!a||!a[0])return new f(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);for(B=!1,u=Math.sqrt(+s),u==0||u==1/0?(t=O(a),(t.length+c)%2==0&&(t+="0"),u=Math.sqrt(t),c=V((c+1)/2)-(c<0||c%2),u==1/0?t="5e"+c:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),r=new f(t)):r=new f(u.toString()),n=(c=f.precision)+3;;)if(o=r,r=o.plus(N(s,o,n+2,1)).times(.5),O(o.d).slice(0,n)===(t=O(r.d)).slice(0,n))if(t=t.slice(n-3,n+1),t=="9999"||!i&&t=="4999"){if(!i&&(T(o,c+1,0),o.times(o).eq(s))){r=o;break}n+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(T(r,c+1,1),e=!r.times(r).eq(s));break}return B=!0,T(r,c,f.rounding,e)};m.tangent=m.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,n=n.sin(),n.s=1,n=N(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,T(X==2||X==4?n.neg():n,e,t,!0)):new r(NaN)};m.times=m.mul=function(e){var t,n,r,i,o,s,a,c,u,f=this,l=f.constructor,p=f.d,d=(e=new l(e)).d;if(e.s*=f.s,!p||!p[0]||!d||!d[0])return new l(!e.s||p&&!p[0]&&!d||d&&!d[0]&&!p?NaN:!p||!d?e.s/0:e.s*0);for(n=V(f.e/P)+V(e.e/P),c=p.length,u=d.length,c<u&&(o=p,p=d,d=o,s=c,c=u,u=s),o=[],s=c+u,r=s;r--;)o.push(0);for(r=u;--r>=0;){for(t=0,i=c+r;i>r;)a=o[i]+d[r]*p[i-r-1]+t,o[i--]=a%z|0,t=a/z|0;o[i]=(o[i]+t)%z|0}for(;!o[--s];)o.pop();return t?++n:o.shift(),e.d=o,e.e=Re(o,n),B?T(e,l.precision,l.rounding):e};m.toBinary=function(e,t){return rt(this,2,e,t)};m.toDecimalPlaces=m.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(q(e,0,ne),t===void 0?t=r.rounding:q(t,0,8),T(n,e+n.e+1,t))};m.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=J(r,!0):(q(e,0,ne),t===void 0?t=i.rounding:q(t,0,8),r=T(new i(r),e+1,t),n=J(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n};m.toFixed=function(e,t){var n,r,i=this,o=i.constructor;return e===void 0?n=J(i):(q(e,0,ne),t===void 0?t=o.rounding:q(t,0,8),r=T(new o(i),e+i.e+1,t),n=J(r,!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};m.toFraction=function(e){var t,n,r,i,o,s,a,c,u,f,l,p,d=this,y=d.d,g=d.constructor;if(!y)return new g(d);if(u=n=new g(1),r=c=new g(0),t=new g(r),o=t.e=Kt(y)-d.e-1,s=o%P,t.d[0]=v(10,s<0?P+s:s),e==null)e=o>0?t:u;else{if(a=new g(e),!a.isInt()||a.lt(u))throw Error(te+a);e=a.gt(t)?o>0?t:u:a}for(B=!1,a=new g(O(y)),f=g.precision,g.precision=o=y.length*P*2;l=N(a,t,0,1,1),i=n.plus(l.times(r)),i.cmp(e)!=1;)n=r,r=i,i=u,u=c.plus(l.times(i)),c=i,i=t,t=a.minus(l.times(i)),a=i;return i=N(e.minus(n),r,0,1,1),c=c.plus(i.times(u)),n=n.plus(i.times(r)),c.s=u.s=d.s,p=N(u,r,o,1).minus(d).abs().cmp(N(c,n,o,1).minus(d).abs())<1?[u,r]:[c,n],g.precision=f,B=!0,p};m.toHexadecimal=m.toHex=function(e,t){return rt(this,16,e,t)};m.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),e==null){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:q(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(B=!1,n=N(n,e,0,t,1).times(e),B=!0,T(n)):(e.s=n.s,n=e),n};m.toNumber=function(){return+this};m.toOctal=function(e,t){return rt(this,8,e,t)};m.toPower=m.pow=function(e){var t,n,r,i,o,s,a=this,c=a.constructor,u=+(e=new c(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new c(v(+a,u));if(a=new c(a),a.eq(1))return a;if(r=c.precision,o=c.rounding,e.eq(1))return T(a,r,o);if(t=V(e.e/P),t>=e.d.length-1&&(n=u<0?-u:u)<=Bn)return i=Ft(c,a,n,r),e.s<0?new c(1).div(i):T(i,r,o);if(s=a.s,s<0){if(t<e.d.length-1)return new c(NaN);if((e.d[t]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return n=v(+a,u),t=n==0||!isFinite(n)?V(u*(Math.log("0."+O(a.d))/Math.LN10+a.e+1)):new c(n+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?s/0:0):(B=!1,c.rounding=a.s=1,n=Math.min(12,(t+"").length),i=tt(e.times(ee(a,r+n)),r),i.d&&(i=T(i,r+5,1),de(i.d,r,o)&&(t=r+10,i=T(tt(e.times(ee(a,t+n)),t),t+5,1),+O(i.d).slice(r+1,r+15)+1==1e14&&(i=T(i,r+1,0)))),i.s=s,B=!0,c.rounding=o,T(i,r,o))};m.toPrecision=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=J(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(q(e,1,ne),t===void 0?t=i.rounding:q(t,0,8),r=T(new i(r),e,t),n=J(r,e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n};m.toSignificantDigits=m.toSD=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(q(e,1,ne),t===void 0?t=r.rounding:q(t,0,8)),T(new r(n),e,t)};m.toString=function(){var e=this,t=e.constructor,n=J(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n};m.truncated=m.trunc=function(){return T(new this.constructor(this),this.e+1,1)};m.valueOf=m.toJSON=function(){var e=this,t=e.constructor,n=J(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function O(e){var t,n,r,i=e.length-1,o="",s=e[0];if(i>0){for(o+=s,t=1;t<i;t++)r=e[t]+"",n=P-r.length,n&&(o+=$(n)),o+=r;s=e[t],r=s+"",n=P-r.length,n&&(o+=$(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function q(e,t,n){if(e!==~~e||e<t||e>n)throw Error(te+e)}function de(e,t,n,r){var i,o,s,a;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=P,i=0):(i=Math.ceil((t+1)/P),t%=P),o=v(10,P-t),a=e[i]%o|0,r==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),s=n<4&&a==99999||n>3&&a==49999||a==5e4||a==0):s=(n<4&&a+1==o||n>3&&a+1==o/2)&&(e[i+1]/o/100|0)==v(10,t-2)-1||(a==o/2||a==0)&&(e[i+1]/o/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),s=(r||n<4)&&a==9999||!r&&n>3&&a==4999):s=((r||n<4)&&a+1==o||!r&&n>3&&a+1==o/2)&&(e[i+1]/o/1e3|0)==v(10,t-3)-1,s}function Le(e,t,n){for(var r,i=[0],o,s=0,a=e.length;s<a;){for(o=i.length;o--;)i[o]*=t;for(i[0]+=Qe.indexOf(e.charAt(s++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function kn(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?(n=Math.ceil(r/3),i=(1/Me(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),e.precision+=n,t=le(e,1,t.times(i),new e(1));for(var o=n;o--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=n,t}var N=function(){function e(r,i,o){var s,a=0,c=r.length;for(r=r.slice();c--;)s=r[c]*i+a,r[c]=s%o|0,a=s/o|0;return a&&r.unshift(a),r}function t(r,i,o,s){var a,c;if(o!=s)c=o>s?1:-1;else for(a=c=0;a<o;a++)if(r[a]!=i[a]){c=r[a]>i[a]?1:-1;break}return c}function n(r,i,o,s){for(var a=0;o--;)r[o]-=a,a=r[o]<i[o]?1:0,r[o]=a*s+r[o]-i[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,o,s,a,c){var u,f,l,p,d,y,g,w,h,b,x,A,E,L,M,D,W,Z,U,oe,ue=r.constructor,Je=r.s==i.s?1:-1,K=r.d,C=i.d;if(!K||!K[0]||!C||!C[0])return new ue(!r.s||!i.s||(K?C&&K[0]==C[0]:!C)?NaN:K&&K[0]==0||!C?Je*0:Je/0);for(c?(d=1,f=r.e-i.e):(c=z,d=P,f=V(r.e/d)-V(i.e/d)),U=C.length,W=K.length,h=new ue(Je),b=h.d=[],l=0;C[l]==(K[l]||0);l++);if(C[l]>(K[l]||0)&&f--,o==null?(L=o=ue.precision,s=ue.rounding):a?L=o+(r.e-i.e)+1:L=o,L<0)b.push(1),y=!0;else{if(L=L/d+2|0,l=0,U==1){for(p=0,C=C[0],L++;(l<W||p)&&L--;l++)M=p*c+(K[l]||0),b[l]=M/C|0,p=M%C|0;y=p||l<W}else{for(p=c/(C[0]+1)|0,p>1&&(C=e(C,p,c),K=e(K,p,c),U=C.length,W=K.length),D=U,x=K.slice(0,U),A=x.length;A<U;)x[A++]=0;oe=C.slice(),oe.unshift(0),Z=C[0],C[1]>=c/2&&++Z;do p=0,u=t(C,x,U,A),u<0?(E=x[0],U!=A&&(E=E*c+(x[1]||0)),p=E/Z|0,p>1?(p>=c&&(p=c-1),g=e(C,p,c),w=g.length,A=x.length,u=t(g,x,w,A),u==1&&(p--,n(g,U<w?oe:C,w,c))):(p==0&&(u=p=1),g=C.slice()),w=g.length,w<A&&g.unshift(0),n(x,g,A,c),u==-1&&(A=x.length,u=t(C,x,U,A),u<1&&(p++,n(x,U<A?oe:C,A,c))),A=x.length):u===0&&(p++,x=[0]),b[l++]=p,u&&x[0]?x[A++]=K[D]||0:(x=[K[D]],A=1);while((D++<W||x[0]!==void 0)&&L--);y=x[0]!==void 0}b[0]||b.shift()}if(d==1)h.e=f,Mt=y;else{for(l=1,p=b[0];p>=10;p/=10)l++;h.e=l+f*d-1,T(h,a?o+h.e+1:o,s,y)}return h}}();function T(e,t,n,r){var i,o,s,a,c,u,f,l,p,d=e.constructor;e:if(t!=null){if(l=e.d,!l)return e;for(i=1,a=l[0];a>=10;a/=10)i++;if(o=t-i,o<0)o+=P,s=t,f=l[p=0],c=f/v(10,i-s-1)%10|0;else if(p=Math.ceil((o+1)/P),a=l.length,p>=a)if(r){for(;a++<=p;)l.push(0);f=c=0,i=1,o%=P,s=o-P+1}else break e;else{for(f=a=l[p],i=1;a>=10;a/=10)i++;o%=P,s=o-P+i,c=s<0?0:f/v(10,i-s-1)%10|0}if(r=r||t<0||l[p+1]!==void 0||(s<0?f:f%v(10,i-s-1)),u=n<4?(c||r)&&(n==0||n==(e.s<0?3:2)):c>5||c==5&&(n==4||r||n==6&&(o>0?s>0?f/v(10,i-s):0:l[p-1])%10&1||n==(e.s<0?8:7)),t<1||!l[0])return l.length=0,u?(t-=e.e+1,l[0]=v(10,(P-t%P)%P),e.e=-t||0):l[0]=e.e=0,e;if(o==0?(l.length=p,a=1,p--):(l.length=p+1,a=v(10,P-o),l[p]=s>0?(f/v(10,i-s)%v(10,s)|0)*a:0),u)for(;;)if(p==0){for(o=1,s=l[0];s>=10;s/=10)o++;for(s=l[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(e.e++,l[0]==z&&(l[0]=1));break}else{if(l[p]+=a,l[p]!=z)break;l[p--]=0,a=1}for(o=l.length;l[--o]===0;)l.pop()}return B&&(e.e>d.maxE?(e.d=null,e.e=NaN):e.e<d.minE&&(e.e=0,e.d=[0])),e}function J(e,t,n){if(!e.isFinite())return Wt(e);var r,i=e.e,o=O(e.d),s=o.length;return t?(n&&(r=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+$(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):i<0?(o="0."+$(-i-1)+o,n&&(r=n-s)>0&&(o+=$(r))):i>=s?(o+=$(i+1-s),n&&(r=n-i-1)>0&&(o=o+"."+$(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(o+="."),o+=$(r))),o}function Re(e,t){var n=e[0];for(t*=P;n>=10;n/=10)t++;return t}function Ie(e,t,n){if(t>Sn)throw B=!0,n&&(e.precision=n),Error(Dt);return T(new e(Ne),t,1,!0)}function j(e,t,n){if(t>et)throw Error(Dt);return T(new e(Ce),t,n,!0)}function Kt(e){var t=e.length-1,n=t*P+1;if(t=e[t],t){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function $(e){for(var t="";e--;)t+="0";return t}function Ft(e,t,n,r){var i,o=new e(1),s=Math.ceil(r/P+4);for(B=!1;;){if(n%2&&(o=o.times(t),Et(o.d,s)&&(i=!0)),n=V(n/2),n===0){n=o.d.length-1,i&&o.d[n]===0&&++o.d[n];break}t=t.times(t),Et(t.d,s)}return B=!0,o}function It(e){return e.d[e.d.length-1]&1}function Vt(e,t,n){for(var r,i=new e(t[0]),o=0;++o<t.length;)if(r=new e(t[o]),r.s)i[n](r)&&(i=r);else{i=r;break}return i}function tt(e,t){var n,r,i,o,s,a,c,u=0,f=0,l=0,p=e.constructor,d=p.rounding,y=p.precision;if(!e.d||!e.d[0]||e.e>17)return new p(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(B=!1,c=y):c=t,a=new p(.03125);e.e>-2;)e=e.times(a),l+=5;for(r=Math.log(v(2,l))/Math.LN10*2+5|0,c+=r,n=o=s=new p(1),p.precision=c;;){if(o=T(o.times(e),c,1),n=n.times(++f),a=s.plus(N(o,n,c,1)),O(a.d).slice(0,c)===O(s.d).slice(0,c)){for(i=l;i--;)s=T(s.times(s),c,1);if(t==null)if(u<3&&de(s.d,c-r,d,u))p.precision=c+=10,n=o=a=new p(1),f=0,u++;else return T(s,p.precision=y,d,B=!0);else return p.precision=y,s}s=a}}function ee(e,t){var n,r,i,o,s,a,c,u,f,l,p,d=1,y=10,g=e,w=g.d,h=g.constructor,b=h.rounding,x=h.precision;if(g.s<0||!w||!w[0]||!g.e&&w[0]==1&&w.length==1)return new h(w&&!w[0]?-1/0:g.s!=1?NaN:w?0:g);if(t==null?(B=!1,f=x):f=t,h.precision=f+=y,n=O(w),r=n.charAt(0),Math.abs(o=g.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)g=g.times(e),n=O(g.d),r=n.charAt(0),d++;o=g.e,r>1?(g=new h("0."+n),o++):g=new h(r+"."+n.slice(1))}else return u=Ie(h,f+2,x).times(o+""),g=ee(new h(r+"."+n.slice(1)),f-y).plus(u),h.precision=x,t==null?T(g,x,b,B=!0):g;for(l=g,c=s=g=N(g.minus(1),g.plus(1),f,1),p=T(g.times(g),f,1),i=3;;){if(s=T(s.times(p),f,1),u=c.plus(N(s,new h(i),f,1)),O(u.d).slice(0,f)===O(c.d).slice(0,f))if(c=c.times(2),o!==0&&(c=c.plus(Ie(h,f+2,x).times(o+""))),c=N(c,new h(d),f,1),t==null)if(de(c.d,f-y,b,a))h.precision=f+=y,u=s=g=N(l.minus(1),l.plus(1),f,1),p=T(g.times(g),f,1),i=a=1;else return T(c,h.precision=x,b,B=!0);else return h.precision=x,c;c=u,i+=2}}function Wt(e){return String(e.s*e.s/0)}function nt(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;r++);for(i=t.length;t.charCodeAt(i-1)===48;--i);if(t=t.slice(r,i),t){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%P,n<0&&(r+=P),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=P;r<i;)e.d.push(+t.slice(r,r+=P));t=t.slice(r),r=P-t.length}else r-=i;for(;r--;)t+="0";e.d.push(+t),B&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Ln(e,t){var n,r,i,o,s,a,c,u,f;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),Ot.test(t))return nt(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(Pn.test(t))n=16,t=t.toLowerCase();else if(Tn.test(t))n=2;else if(An.test(t))n=8;else throw Error(te+t);for(o=t.search(/p/i),o>0?(c=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),o=t.indexOf("."),s=o>=0,r=e.constructor,s&&(t=t.replace(".",""),a=t.length,o=a-o,i=Ft(r,new r(n),o,o*2)),u=Le(t,n,z),f=u.length-1,o=f;u[o]===0;--o)u.pop();return o<0?new r(e.s*0):(e.e=Re(u,f),e.d=u,B=!1,s&&(e=N(e,i,a*4)),c&&(e=e.times(Math.abs(c)<54?v(2,c):De.pow(2,c))),B=!0,e)}function Nn(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:le(e,2,t,t);n=1.4*Math.sqrt(r),n=n>16?16:n|0,t=t.times(1/Me(5,n)),t=le(e,2,t,t);for(var i,o=new e(5),s=new e(16),a=new e(20);n--;)i=t.times(t),t=t.times(o.plus(i.times(s.times(i).minus(a))));return t}function le(e,t,n,r,i){var o,s,a,c,u=1,f=e.precision,l=Math.ceil(f/P);for(B=!1,c=n.times(n),a=new e(r);;){if(s=N(a.times(c),new e(t++*t++),f,1),a=i?r.plus(s):r.minus(s),r=N(s.times(c),new e(t++*t++),f,1),s=a.plus(r),s.d[l]!==void 0){for(o=l;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=r,r=s,s=o,u++}return B=!0,s.d.length=l+1,s}function Me(e,t){for(var n=e;--t;)n*=e;return n}function Ut(e,t){var n,r=t.s<0,i=j(e,e.precision,1),o=i.times(.5);if(t=t.abs(),t.lte(o))return X=r?4:1,t;if(n=t.divToInt(i),n.isZero())X=r?3:2;else{if(t=t.minus(n.times(i)),t.lte(o))return X=It(n)?r?2:3:r?4:1,t;X=It(n)?r?1:4:r?3:2}return t.minus(i).abs()}function rt(e,t,n,r){var i,o,s,a,c,u,f,l,p,d=e.constructor,y=n!==void 0;if(y?(q(n,1,ne),r===void 0?r=d.rounding:q(r,0,8)):(n=d.precision,r=d.rounding),!e.isFinite())f=Wt(e);else{for(f=J(e),s=f.indexOf("."),y?(i=2,t==16?n=n*4-3:t==8&&(n=n*3-2)):i=t,s>=0&&(f=f.replace(".",""),p=new d(1),p.e=f.length-s,p.d=Le(J(p),10,i),p.e=p.d.length),l=Le(f,10,i),o=c=l.length;l[--c]==0;)l.pop();if(!l[0])f=y?"0p+0":"0";else{if(s<0?o--:(e=new d(e),e.d=l,e.e=o,e=N(e,p,n,r,0,i),l=e.d,o=e.e,u=Mt),s=l[n],a=i/2,u=u||l[n+1]!==void 0,u=r<4?(s!==void 0||u)&&(r===0||r===(e.s<0?3:2)):s>a||s===a&&(r===4||u||r===6&&l[n-1]&1||r===(e.s<0?8:7)),l.length=n,u)for(;++l[--n]>i-1;)l[n]=0,n||(++o,l.unshift(1));for(c=l.length;!l[c-1];--c);for(s=0,f="";s<c;s++)f+=Qe.charAt(l[s]);if(y){if(c>1)if(t==16||t==8){for(s=t==16?4:3,--c;c%s;c++)f+="0";for(l=Le(f,i,t),c=l.length;!l[c-1];--c);for(s=1,f="1.";s<c;s++)f+=Qe.charAt(l[s])}else f=f.charAt(0)+"."+f.slice(1);f=f+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)f="0"+f;f="0."+f}else if(++o>c)for(o-=c;o--;)f+="0";else o<c&&(f=f.slice(0,o)+"."+f.slice(o))}f=(t==16?"0x":t==2?"0b":t==8?"0o":"")+f}return e.s<0?"-"+f:f}function Et(e,t){if(e.length>t)return e.length=t,!0}function Cn(e){return new this(e).abs()}function In(e){return new this(e).acos()}function En(e){return new this(e).acosh()}function Rn(e,t){return new this(e).plus(t)}function Mn(e){return new this(e).asin()}function Dn(e){return new this(e).asinh()}function _n(e){return new this(e).atan()}function vn(e){return new this(e).atanh()}function On(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,o=r+4;return!e.s||!t.s?n=new this(NaN):!e.d&&!t.d?(n=j(this,o,1).times(t.s>0?.25:.75),n.s=e.s):!t.d||e.isZero()?(n=t.s<0?j(this,r,i):new this(0),n.s=e.s):!e.d||t.isZero()?(n=j(this,o,1).times(.5),n.s=e.s):t.s<0?(this.precision=o,this.rounding=1,n=this.atan(N(e,t,o,1)),t=j(this,o,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(N(e,t,o,1)),n}function Kn(e){return new this(e).cbrt()}function Fn(e){return T(e=new this(e),e.e+1,2)}function Vn(e,t,n){return new this(e).clamp(t,n)}function Wn(e){if(!e||typeof e!="object")throw Error(Ee+"Object expected");var t,n,r,i=e.defaults===!0,o=["precision",1,ne,"rounding",0,8,"toExpNeg",-ce,0,"toExpPos",0,ce,"maxE",0,ce,"minE",-ce,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(n=o[t],i&&(this[n]=$e[n]),(r=e[n])!==void 0)if(V(r)===r&&r>=o[t+1]&&r<=o[t+2])this[n]=r;else throw Error(te+n+": "+r);if(n="crypto",i&&(this[n]=$e[n]),(r=e[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(_t);else this[n]=!1;else throw Error(te+n+": "+r);return this}function Un(e){return new this(e).cos()}function qn(e){return new this(e).cosh()}function qt(e){var t,n,r;function i(o){var s,a,c,u=this;if(!(u instanceof i))return new i(o);if(u.constructor=i,Rt(o)){u.s=o.s,B?!o.d||o.e>i.maxE?(u.e=NaN,u.d=null):o.e<i.minE?(u.e=0,u.d=[0]):(u.e=o.e,u.d=o.d.slice()):(u.e=o.e,u.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){u.s=1/o<0?-1:1,u.e=0,u.d=[0];return}if(o<0?(o=-o,u.s=-1):u.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;B?s>i.maxE?(u.e=NaN,u.d=null):s<i.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[o]):(u.e=s,u.d=[o]);return}else if(o*0!==0){o||(u.s=NaN),u.e=NaN,u.d=null;return}return nt(u,o.toString())}else if(c!=="string")throw Error(te+o);return(a=o.charCodeAt(0))===45?(o=o.slice(1),u.s=-1):(a===43&&(o=o.slice(1)),u.s=1),Ot.test(o)?nt(u,o):Ln(u,o)}if(i.prototype=m,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=Wn,i.clone=qt,i.isDecimal=Rt,i.abs=Cn,i.acos=In,i.acosh=En,i.add=Rn,i.asin=Mn,i.asinh=Dn,i.atan=_n,i.atanh=vn,i.atan2=On,i.cbrt=Kn,i.ceil=Fn,i.clamp=Vn,i.cos=Un,i.cosh=qn,i.div=Gn,i.exp=Hn,i.floor=jn,i.hypot=zn,i.ln=Yn,i.log=Zn,i.log10=Xn,i.log2=Jn,i.max=Qn,i.min=$n,i.mod=er,i.mul=tr,i.pow=nr,i.random=rr,i.round=ir,i.sign=or,i.sin=sr,i.sinh=ar,i.sqrt=ur,i.sub=cr,i.sum=lr,i.tan=fr,i.tanh=pr,i.trunc=mr,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function Gn(e,t){return new this(e).div(t)}function Hn(e){return new this(e).exp()}function jn(e){return T(e=new this(e),e.e+1,3)}function zn(){var e,t,n=new this(0);for(B=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return B=!0,new this(1/0);n=t}return B=!0,n.sqrt()}function Rt(e){return e instanceof De||e&&e.toStringTag===vt||!1}function Yn(e){return new this(e).ln()}function Zn(e,t){return new this(e).log(t)}function Jn(e){return new this(e).log(2)}function Xn(e){return new this(e).log(10)}function Qn(){return Vt(this,arguments,"lt")}function $n(){return Vt(this,arguments,"gt")}function er(e,t){return new this(e).mod(t)}function tr(e,t){return new this(e).mul(t)}function nr(e,t){return new this(e).pow(t)}function rr(e){var t,n,r,i,o=0,s=new this(1),a=[];if(e===void 0?e=this.precision:q(e,1,ne),r=Math.ceil(e/P),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));o<r;)i=t[o],i>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);o<r;)i=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((t[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(t,o):(a.push(i%1e7),o+=4);o=r/4}else throw Error(_t);else for(;o<r;)a[o++]=Math.random()*1e7|0;for(r=a[--o],e%=P,r&&e&&(i=v(10,P-e),a[o]=(r/i|0)*i);a[o]===0;o--)a.pop();if(o<0)n=0,a=[0];else{for(n=-1;a[0]===0;n-=P)a.shift();for(r=1,i=a[0];i>=10;i/=10)r++;r<P&&(n-=P-r)}return s.e=n,s.d=a,s}function ir(e){return T(e=new this(e),e.e+1,this.rounding)}function or(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function sr(e){return new this(e).sin()}function ar(e){return new this(e).sinh()}function ur(e){return new this(e).sqrt()}function cr(e,t){return new this(e).sub(t)}function lr(){var e=0,t=arguments,n=new this(t[e]);for(B=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return B=!0,T(n,this.precision,this.rounding)}function fr(e){return new this(e).tan()}function pr(e){return new this(e).tanh()}function mr(e){return T(e=new this(e),e.e+1,1)}m[Symbol.for("nodejs.util.inspect.custom")]=m.toString;m[Symbol.toStringTag]="Decimal";var De=m.constructor=qt($e);Ne=new De(Ne);Ce=new De(Ce);import{PublicKey as ot}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as dr}from"@solana/spl-token";import{PublicKey as R,SystemProgram as Gt,SYSVAR_RENT_PUBKEY as gr}from"@solana/web3.js";function it({pubkey:e,isSigner:t=!1,isWritable:n=!0}){return{pubkey:e,isWritable:n,isSigner:t}}var ai=[it({pubkey:dr,isWritable:!1}),it({pubkey:Gt.programId,isWritable:!1}),it({pubkey:gr,isWritable:!1})];function Ht({publicKey:e,transformSol:t}){let n=jt(e.toString());if(n instanceof R)return t&&n.equals(ge)?_e:n;if(t&&n.toString()===ge.toBase58())return _e;if(typeof n=="string"){if(n===R.default.toBase58())return R.default;try{return new R(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function jt(e){try{return new R(e)}catch{return e}}var ui=new R("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ci=new R("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),li=new R("SysvarRent111111111111111111111111111111111"),fi=new R("SysvarC1ock11111111111111111111111111111111"),pi=new R("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),mi=new R("Sysvar1nstructions1111111111111111111111111"),di=Gt.programId,gi=new R("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),hi=new R("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),bi=new R("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),yi=new R("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),wi=new R("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),xi=new R("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Ti=new R("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Pi=new R("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Ai=new R("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Bi=new R("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Si=new R("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),_e=new R("So11111111111111111111111111111111111111112"),ge=R.default;import{PublicKey as hr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as zt}from"@solana/spl-token";var Yt={chainId:101,address:hr.default.toBase58(),programId:zt.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},Q={chainId:101,address:"So11111111111111111111111111111111111111112",programId:zt.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var st=class{constructor({mint:t,decimals:n,symbol:r,name:i,skipMint:o=!1,isToken2022:s=!1}){if(t===ge.toBase58()||t instanceof ot&&ge.equals(t)){this.decimals=Q.decimals,this.symbol=Q.symbol,this.name=Q.name,this.mint=new ot(Q.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||t.toString().substring(0,6),this.name=i||t.toString().substring(0,6),this.mint=o?ot.default:Ht({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},fe=st;fe.WSOL=new st({...Q,mint:Q.address});import Oe from"big.js";import wr from"bn.js";import xr from"decimal.js-light";import br from"toformat";var yr=br,he=yr;var ve=F("module/fraction"),at=he(Oe),be=he(xr),Tr={[0]:be.ROUND_DOWN,[1]:be.ROUND_HALF_UP,[2]:be.ROUND_UP},Pr={[0]:Oe.roundDown,[1]:Oe.roundHalfUp,[2]:Oe.roundUp},I=class{constructor(t,n=new wr(1)){this.numerator=H(t),this.denominator=H(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new I(this.denominator,this.numerator)}add(t){let n=t instanceof I?t:new I(H(t));return this.denominator.eq(n.denominator)?new I(this.numerator.add(n.numerator),this.denominator):new I(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(t){let n=t instanceof I?t:new I(H(t));return this.denominator.eq(n.denominator)?new I(this.numerator.sub(n.numerator),this.denominator):new I(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(t){let n=t instanceof I?t:new I(H(t));return new I(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(t){let n=t instanceof I?t:new I(H(t));return new I(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(t,n={groupSeparator:""},r=1){Number.isInteger(t)||ve.logWithError(`${t} is not an integer.`),t<=0&&ve.logWithError(`${t} is not positive.`),be.set({precision:t+1,rounding:Tr[r]});let i=new be(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return i.toFormat(i.decimalPlaces(),n)}toFixed(t,n={groupSeparator:""},r=1){return Number.isInteger(t)||ve.logWithError(`${t} is not an integer.`),t<0&&ve.logWithError(`${t} is negative.`),at.DP=t,at.RM=Pr[r]||1,new at(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,n)}isZero(){return this.numerator.isZero()}};var Xi=F("Raydium_price");var ut=class{constructor({decimals:t,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=t,this.symbol=n,this.name=r}equals(t){return this===t}},Ke=ut;Ke.SOL=new ut(Yt);import Br from"bn.js";var oo=new I(new Br(100));var Fe=new G(0),ko=new G(1),Lo=new G(2),No=new G(3),Co=new G(5),Sr=new G(10),Io=new G(100),Eo=new G(1e3),Ro=new G(1e4),Qt=9007199254740991;function H(e){let t=F("Raydium_parseBigNumberish");if(e instanceof G)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new G(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=Qt||e<=-Qt)&&t.logWithError(`BigNumberish number overflow: ${e}`),new G(String(e))):typeof e=="bigint"?new G(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new G(0))}var jo=F("Raydium_amount"),zo=he(kr);import{PublicKey as xe,sendAndConfirmTransaction as pt,Transaction as Te,TransactionMessage as Pe,VersionedTransaction as Ae}from"@solana/web3.js";import Rr from"axios";var se={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut"};import{PublicKey as ms,ComputeBudgetProgram as $t,Transaction as tn,TransactionMessage as Lr,Keypair as nn,VersionedTransaction as rn}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Nr}from"@solana/spl-token";var en=F("Raydium_txUtil"),on=1644;function Ve(e){let t=[],n=[];return e.microLamports&&(t.push($t.setComputeUnitPrice({microLamports:e.microLamports})),n.push(se.SetComputeUnitPrice)),e.units&&(t.push($t.setComputeUnitLimit({units:e.units})),n.push(se.SetComputeUnitLimit)),{instructions:t,instructionTypes:n}}async function pe(e){var t,n;try{return((n=await((t=e.getLatestBlockhash)==null?void 0:t.call(e)))==null?void 0:n.blockhash)||(await e.getRecentBlockhash()).blockhash}catch{return(await e.getRecentBlockhash()).blockhash}}function Cr(e,t){e.length<1&&en.logWithError(`no instructions provided: ${e.toString()}`),t.length<1&&en.logWithError(`no signers provided:, ${t.toString()}`);let n=new tn;n.recentBlockhash="11111111111111111111111111111111",n.feePayer=t[0],n.add(...e);try{return Buffer.from(n.serialize({verifySignatures:!1})).toString("base64").length<on}catch{return!1}}function ye({instructions:e,payer:t,signers:n}){return Cr(e,[t,...n])}function we({instructions:e,payer:t,lookupTableAddressAccount:n,recentBlockhash:r=nn.generate().publicKey.toString()}){let o=new Lr({payerKey:t,recentBlockhash:r,instructions:e}).compileToV0Message(Object.values(n!=null?n:{}));try{return Buffer.from(new rn(o).serialize()).toString("base64").length<on}catch{return!1}}var Ir=e=>Buffer.isBuffer(e)?e:e instanceof Uint8Array?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e);function ae(e){let t=[];return e.forEach(n=>{n instanceof tn&&(n.recentBlockhash||(n.recentBlockhash=Nr.toBase58()),n.feePayer||(n.feePayer=nn.generate().publicKey));let r=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof rn&&(r=Ir(r));let i=r.toString("base64");t.push(i)}),console.log("simulate tx string:",t),t}import{PublicKey as an,AddressLookupTableAccount as We}from"@solana/web3.js";import{PublicKey as Er}from"@solana/web3.js";import{getTransferFeeConfig as ks,unpackMint as Ls}from"@solana/spl-token";var ct=F("Raydium_accountInfo_util");async function sn(e,t,n){let{batchRequest:r,commitment:i="confirmed"}={batchRequest:!1,...n},o=lt(t,100),s=new Array(o.length).fill([]);if(r){let a=o.map(f=>{let l=e._buildArgs([f.map(p=>p.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:l}}),c=lt(a,10);s=(await(await Promise.all(c.map(async f=>await e._rpcBatchRequest(f)))).flat()).map(f=>(f.error&&ct.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${f.error.message}`),f.result.value.map(l=>{if(l){let{data:p,executable:d,lamports:y,owner:g,rentEpoch:w}=l;return p.length!==2&&p[1]!=="base64"&&ct.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(p[0],"base64"),executable:d,lamports:y,owner:new Er(g),rentEpoch:w}}return null})))}else try{s=await Promise.all(o.map(a=>e.getMultipleAccountsInfo(a,i)))}catch(a){a instanceof Error&&ct.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${a.message}`)}return s.flat()}async function ft({connection:e,address:t}){let n=await sn(e,[...new Set(t.map(i=>i.toString()))].map(i=>new an(i))),r={};for(let i=0;i<t.length;i++){let o=n[i],s=t[i];if(!o)continue;let a=new We({key:s,state:We.deserialize(o.data)});r[s.toString()]=a,Ue[s.toString()]=a}return r}var Ue={"2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17":new We({key:new an("2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17"),state:We.deserialize(Buffer.from("AQAAAP//////////d49+DAAAAAAAAQZMWvw7GUNJdaccNBVnb57OKakxL2BHLYvhRwVILRsgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAABt324ddloZPZy+FGzut5rBy0he1fWzeROoz1hX7/AKkG3fbh7nWP3hhCXbzkbM3athr8TYO5DSf+vfko2KGL/AVKU1D4XciC1hSlVnJ4iilt3x6rq9CmBniISTL07vagBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvDQdRqCgtphMF/imcN7mY5YRx2xE1A3MQ+L4QRaYK9u4GRfZP3LsAd00a+IkCpA22UNQMKdq5BFbJuwuOLqc8zxCTDlqxBG8J0HcxtfogQHDK06ukzfaXiNDKAob1MqBHS9lJxDYCwz8gd5DtFqNSTKG5l1zxIaKpDP/sffi2is1H9aKveyXSu5StXElYRl9SD5As0DHE4N0GLnf84/siiKXVyp4Ez121kLcUui/jLLFZEz/BwZK3Ilf9B9OcsEAeDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu9N9LMnrw/JNO0hqMVB4rk/2ou4AB1loQ7FZoPwut2o4KZB+0p9xnbrQKw038qjpHar+PyDwvxBRcu5hpHw3dguezeWv+IwvgW5icu8EGkhGa9AkFPPJT7VMSFb8xowveU=","base64"))})};var qe=class{constructor(t){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=t.connection,this.feePayer=t.feePayer,this.signAllTransactions=t.signAllTransactions,this.owner=t.owner,this.cluster=t.cluster}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let t=(await Rr.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:n}=(r=t==null?void 0:t[15])!=null?r:{};if(!!n)return{units:6e5,microLamports:Math.min(Math.ceil(n*1e6/6e5),25e3)}}addCustomComputeBudget(t){if(t){let{instructions:n,instructionTypes:r}=Ve(t);return this.instructions.unshift(...n),this.instructionTypes.unshift(...r),!0}return!1}async calComputeBudget({config:t,defaultIns:n}){try{let r=t||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;n&&this.instructions.unshift(...n)}catch{n&&this.instructions.unshift(...n)}}addInstruction({instructions:t=[],endInstructions:n=[],signers:r=[],instructionTypes:i=[],endInstructionTypes:o=[],lookupTableAddress:s=[]}){return this.instructions.push(...t),this.endInstructions.push(...n),this.signers.push(...r),this.instructionTypes.push(...i),this.endInstructionTypes.push(...o),this.lookupTableAddress.push(...s.filter(a=>a!==xe.default.toString())),this}async versionBuild({txVersion:t,extInfo:n}){return t===0?await this.buildV0({...n||{}}):this.build(n)}build(t){let n=new Te;return this.allInstructions.length&&n.add(...this.allInstructions),n.feePayer=this.feePayer,{builder:this,transaction:n,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async r=>{var a;let{recentBlockHash:i,skipPreflight:o=!0}=r||{},s=i!=null?i:await pe(this.connection);if(n.recentBlockhash=s,this.signers.length&&n.sign(...this.signers),ae([n]),(a=this.owner)!=null&&a.isKeyPair)return{txId:await pt(this.connection,n,this.signers.find(c=>c.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:o}),signedTx:n};if(this.signAllTransactions){let c=await this.signAllTransactions([n]);return{txId:await this.connection.sendRawTransaction(c[0].serialize(),{skipPreflight:o}),signedTx:c[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:t||{}}}buildMultiTx(t){let{extraPreBuildData:n=[],extInfo:r}=t,{transaction:i}=this.build(r),o=n.filter(u=>u.transaction.instructions.length>0),s=[i,...o.map(u=>u.transaction)],a=[this.signers,...o.map(u=>u.signers)],c=[...this.instructionTypes,...o.map(u=>u.instructionTypes).flat()];return{builder:this,transactions:s,signers:a,instructionTypes:c,execute:async u=>{var g;let{sequentially:f,onTxUpdate:l,recentBlockHash:p,skipPreflight:d=!0}=u||{},y=p!=null?p:await pe(this.connection);if((g=this.owner)!=null&&g.isKeyPair)return{txIds:await await Promise.all(s.map(async(w,h)=>(w.recentBlockhash=y,await pt(this.connection,w,a[h].find(b=>b.publicKey.equals(this.owner.publicKey))?a[h]:[...a[h],this.owner.signer],{skipPreflight:d})))),signedTxs:s};if(this.signAllTransactions){let w=s.map((b,x)=>(b.recentBlockhash=y,a[x].length&&b.sign(...a[x]),b));ae(w);let h=await this.signAllTransactions(w);if(f){let b=0,x=[],A=async()=>{if(!h[b])return;let E=await this.connection.sendRawTransaction(h[b].serialize(),{skipPreflight:d});x.push({txId:E,status:"sent",signedTx:h[b]}),l==null||l([...x]),b++,this.connection.onSignature(E,L=>{let M=x.findIndex(D=>D.txId===E);M>-1&&(x[M].status=L.err?"error":"success"),l==null||l([...x]),L.err||A()},"processed"),this.connection.getSignatureStatus(E)};return await A(),{txIds:x.map(E=>E.txId),signedTxs:h}}else{let b=[];for(let x=0;x<h.length;x+=1){let A=await this.connection.sendRawTransaction(h[x].serialize(),{skipPreflight:d});b.push(A)}return{txIds:b,signedTxs:h}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:t,txVersion:n,extInfo:r}){return n===0?await this.buildV0MultiTx({extraPreBuildData:t,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:t,extInfo:r})}async buildV0(t){let{lookupTableCache:n={},lookupTableAddress:r=[],forerunCreate:i,...o}=t||{},s={...this.cluster==="devnet"?{}:Ue,...n},a=Array.from(new Set([...r,...this.lookupTableAddress])),c=[];for(let p of a)s[p]===void 0&&c.push(new xe(p));let u=await ft({connection:this.connection,address:c});for(let[p,d]of Object.entries(u))s[p]=d;let f=new Pe({payerKey:this.feePayer,recentBlockhash:i?xe.default.toBase58():await pe(this.connection),instructions:[...this.allInstructions]}).compileToV0Message(Object.values(s)),l=new Ae(f);return l.sign(this.signers),{builder:this,transaction:l,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async p=>{var g;let{recentBlockHash:d,skipPreflight:y=!0}=p||{};if(d&&(l.message.recentBlockhash=d),ae([l]),(g=this.owner)!=null&&g.isKeyPair){this.signers.find(x=>x.publicKey.equals(this.owner.publicKey))||l.sign([this.owner.signer]);let w=await this.connection.sendTransaction(l,{skipPreflight:y}),{lastValidBlockHeight:h,blockhash:b}=await this.connection.getLatestBlockhash();return await this.connection.confirmTransaction({blockhash:b,lastValidBlockHeight:h,signature:w},"confirmed"),{txId:w,signedTx:l}}if(this.signAllTransactions){let w=await this.signAllTransactions([l]);return{txId:await this.connection.sendTransaction(w[0],{skipPreflight:y}),signedTx:w[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:o||{}}}async buildV0MultiTx(t){let{extraPreBuildData:n=[],buildProps:r}=t,{transaction:i}=await this.buildV0(r),o=n.filter(u=>u.builder.instructions.length>0),s=[i,...o.map(u=>u.transaction)],a=[this.signers,...o.map(u=>u.signers)],c=[...this.instructionTypes,...o.map(u=>u.instructionTypes).flat()];return s.forEach(async(u,f)=>{u.sign(a[f])}),{builder:this,transactions:s,signers:a,instructionTypes:c,buildProps:r,execute:async u=>{var y;let{sequentially:f,onTxUpdate:l,recentBlockHash:p,skipPreflight:d=!0}=u||{};if(p&&s.forEach(g=>g.message.recentBlockhash=p),ae(s),(y=this.owner)!=null&&y.isKeyPair){let{lastValidBlockHeight:g,blockhash:w}=await this.connection.getLatestBlockhash();return s.forEach((h,b)=>{a[b].find(x=>x.publicKey.equals(this.owner.publicKey))||h.sign([this.owner.signer])}),{txIds:await Promise.all(s.map(async h=>{let b=await this.connection.sendTransaction(h,{skipPreflight:d});return await this.connection.confirmTransaction({blockhash:w,lastValidBlockHeight:g,signature:b},"confirmed"),b})),signedTxs:s}}if(this.signAllTransactions){let g=await this.signAllTransactions(s);if(f){let w=0,h=[],b=async()=>{if(!g[w])return;let x=await this.connection.sendTransaction(g[w],{skipPreflight:d});h.push({txId:x,status:"sent",signedTx:g[w]}),l==null||l([...h]),w++,this.connection.onSignature(x,A=>{let E=h.findIndex(L=>L.txId===x);E>-1&&(h[E].status=A.err?"error":"success"),l==null||l([...h]),A.err||b()},"processed"),this.connection.getSignatureStatus(x)};return b(),{txIds:[],signedTxs:g}}else{let w=[];for(let h=0;h<g.length;h+=1){let b=await this.connection.sendTransaction(g[h],{skipPreflight:d});w.push(b)}return{txIds:w,signedTxs:g}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(t){let{computeBudgetConfig:n,...r}=t||{},i=n?Ve(n):{instructions:[],instructionTypes:[]},o=this.signers.reduce((u,f)=>({...u,[f.publicKey.toBase58()]:f}),{}),s=[],a=[],c=[];if(this.allInstructions.forEach(u=>{let f=[...c,u],l=n?[...i.instructions,...f]:f,d=[...new Set(f.map(y=>y.keys.filter(g=>g.isSigner).map(g=>g.pubkey.toString())).flat()).values()].map(y=>new xe(y));if(c.length<12&&ye({instructions:l,payer:this.feePayer,signers:d})||ye({instructions:f,payer:this.feePayer,signers:d}))c.push(u);else{if(c.length===0)throw Error("item ins too big");ye({instructions:n?[...i.instructions,...c]:[...c],payer:this.feePayer,signers:d})?s.push(new Te().add(...i.instructions,...c)):s.push(new Te().add(...c)),a.push(Array.from(new Set(c.map(y=>y.keys.filter(g=>g.isSigner).map(g=>g.pubkey.toString())).flat())).map(y=>o[y]).filter(y=>y!==void 0)),c=[u]}}),c.length>0){let f=[...new Set(c.map(l=>l.keys.filter(p=>p.isSigner).map(p=>p.pubkey.toString())).flat()).values()].map(l=>o[l]).filter(l=>l!==void 0);ye({instructions:n?[...i.instructions,...c]:[...c],payer:this.feePayer,signers:f.map(l=>l.publicKey)})?s.push(new Te().add(...i.instructions,...c)):s.push(new Te().add(...c)),a.push(f)}return s.forEach(u=>u.feePayer=this.feePayer),{builder:this,transactions:s,signers:a,instructionTypes:this.instructionTypes,execute:async u=>{var g;let{sequentially:f,onTxUpdate:l,recentBlockHash:p,skipPreflight:d=!0}=u||{},y=p!=null?p:await pe(this.connection);if(s.forEach(async(w,h)=>{w.recentBlockhash=y,a[h].length&&w.sign(...a[h])}),ae(s),(g=this.owner)!=null&&g.isKeyPair)return{txIds:await Promise.all(s.map(async(w,h)=>await pt(this.connection,w,a[h].find(b=>b.publicKey.equals(this.owner.publicKey))?a[h]:[...a[h],this.owner.signer],{skipPreflight:d}))),signedTxs:s};if(this.signAllTransactions){let w=await this.signAllTransactions(s);if(f){let h=0,b=[],x=async()=>{if(!w[h])return;let A=await this.connection.sendRawTransaction(w[h].serialize(),{skipPreflight:d});b.push({txId:A,status:"sent",signedTx:w[h]}),l==null||l([...b]),h++,this.connection.onSignature(A,E=>{let L=b.findIndex(M=>M.txId===A);L>-1&&(b[L].status=E.err?"error":"success"),l==null||l([...b]),E.err||x()},"processed"),this.connection.getSignatureStatus(A)};return await x(),{txIds:b.map(A=>A.txId),signedTxs:w}}else{let h=[];for(let b=0;b<w.length;b+=1){let x=await this.connection.sendRawTransaction(w[b].serialize(),{skipPreflight:d});h.push(x)}return{txIds:h,signedTxs:w}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuildV0(t){let{computeBudgetConfig:n,lookupTableCache:r={},lookupTableAddress:i=[],...o}=t||{},s={...this.cluster==="devnet"?{}:Ue,...r},a=Array.from(new Set([...this.lookupTableAddress,...i])),c=[];for(let w of a)s[w]===void 0&&c.push(new xe(w));let u=await ft({connection:this.connection,address:c});for(let[w,h]of Object.entries(u))s[w]=h;let f=n?Ve(n):{instructions:[],instructionTypes:[]},l=await pe(this.connection),p=this.signers.reduce((w,h)=>({...w,[h.publicKey.toBase58()]:h}),{}),d=[],y=[],g=[];if(this.allInstructions.forEach(w=>{let h=[...g,w],b=n?[...f.instructions,...h]:h;if(g.length<12&&we({instructions:b,payer:this.feePayer,lookupTableAddressAccount:s})||we({instructions:h,payer:this.feePayer,lookupTableAddressAccount:s}))g.push(w);else{if(g.length===0)throw Error("item ins too big");let x={};for(let A of[...new Set(a)])s[A]!==void 0&&(x[A]=s[A]);if(n&&we({instructions:[...f.instructions,...g],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:l})){let A=new Pe({payerKey:this.feePayer,recentBlockhash:l,instructions:[...f.instructions,...g]}).compileToV0Message(Object.values(s));d.push(new Ae(A))}else{let A=new Pe({payerKey:this.feePayer,recentBlockhash:l,instructions:[...g]}).compileToV0Message(Object.values(s));d.push(new Ae(A))}y.push(Array.from(new Set(g.map(A=>A.keys.filter(E=>E.isSigner).map(E=>E.pubkey.toString())).flat())).map(A=>p[A]).filter(A=>A!==void 0)),g=[w]}}),g.length>0){let h=[...new Set(g.map(b=>b.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat()).values()].map(b=>p[b]).filter(b=>b!==void 0);if(n&&we({instructions:[...f.instructions,...g],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:l})){let b=new Pe({payerKey:this.feePayer,recentBlockhash:l,instructions:[...f.instructions,...g]}).compileToV0Message(Object.values(s));d.push(new Ae(b))}else{let b=new Pe({payerKey:this.feePayer,recentBlockhash:l,instructions:[...g]}).compileToV0Message(Object.values(s));d.push(new Ae(b))}y.push(h)}return{builder:this,transactions:d,buildProps:t,signers:y,instructionTypes:this.instructionTypes,execute:async w=>{var E;let{sequentially:h,onTxUpdate:b,recentBlockHash:x,skipPreflight:A=!0}=w||{};if(d.map(async(L,M)=>{y[M].length&&L.sign(y[M]),x&&(L.message.recentBlockhash=x)}),ae(d),(E=this.owner)!=null&&E.isKeyPair){let{lastValidBlockHeight:L,blockhash:M}=await this.connection.getLatestBlockhash();return d.forEach((D,W)=>{y[W].find(Z=>Z.publicKey.equals(this.owner.publicKey))||D.sign([this.owner.signer])}),{txIds:await Promise.all(d.map(async D=>{let W=await this.connection.sendTransaction(D,{skipPreflight:A});return await this.connection.confirmTransaction({blockhash:M,lastValidBlockHeight:L,signature:W},"confirmed"),W})),signedTxs:d}}if(this.signAllTransactions){let L=await this.signAllTransactions(d);if(h){let M=0,D=[],W=async()=>{if(!L[M])return;let Z=await this.connection.sendTransaction(L[M],{skipPreflight:A});D.push({txId:Z,status:"sent",signedTx:L[M]}),b==null||b([...D]),M++,this.connection.onSignature(Z,U=>{let oe=D.findIndex(ue=>ue.txId===Z);oe>-1&&(D[oe].status=U.err?"error":"success"),b==null||b([...D]),U.err||W()},"processed"),this.connection.getSignatureStatus(Z)};return W(),{txIds:[],signedTxs:L}}else{let M=[];for(let D=0;D<L.length;D+=1){let W=await this.connection.sendTransaction(L[D],{skipPreflight:A});M.push(W)}return{txIds:M,signedTxs:L}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:o||{}}}};function lt(e,t=1,n=[]){let r=[...e];if(t<=0)return n;for(;r.length;)n.push(r.splice(0,t));return n}import{PublicKey as _}from"@solana/web3.js";var Js=new _("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Xs=new _("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Qs=new _("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),$s=new _("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),ea=new _("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),ta=new _("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),na=new _("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),ra=new _("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),ia=new _("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),oa=new _("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),sa=new _("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),aa=new _("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),ua=new _("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),ca=new _("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),la=new _("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),fa=new _("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),pa=new _("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),ma=new _("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),da=new _("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),ga=new _("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2");import{PublicKey as wa}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Pa}from"@solana/spl-token";import Sa from"bn.js";var mt=(...e)=>e.map(t=>{try{return typeof t=="object"?JSON.stringify(t):t}catch{return t}}).join(", "),Be=class{constructor({scope:t,moduleName:n}){this.disabled=!1;this.scope=t,this.logger=F(n)}createTxBuilder(t){return this.scope.checkOwner(),new qe({connection:this.scope.connection,feePayer:t||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,signAllTransactions:this.scope.signAllTransactions})}logDebug(...t){this.logger.debug(mt(t))}logInfo(...t){this.logger.info(mt(t))}logAndCreateError(...t){let n=mt(t);throw new Error(n)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};import{createInitializeAccountInstruction as jr,createCloseAccountInstruction as zr,createTransferInstruction as Yr,TOKEN_PROGRAM_ID as me}from"@solana/spl-token";import{PublicKey as Zr,SystemProgram as Jr}from"@solana/web3.js";import Xr from"bn.js";import{PublicKey as Ur,Keypair as qr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Gr}from"@solana/spl-token";import yc from"bn.js";import{PublicKey as Or}from"@solana/web3.js";import cn,{isBN as Yu}from"bn.js";import{bits as Za,BitStructure as Ja,blob as Mr,Blob as Xa,cstr as Qa,f32 as $a,f32be as eu,f64 as tu,f64be as nu,greedy as ru,Layout as Dr,ns64 as iu,ns64be as ou,nu64 as su,nu64be as au,offset as uu,s16 as cu,s16be as lu,s24 as fu,s24be as pu,s32 as mu,s32be as du,s40 as gu,s40be as hu,s48 as bu,s48be as yu,s8 as wu,seq as xu,struct as Tu,Structure as _r,u16 as Pu,u16be as Au,u24 as Bu,u24be as Su,u32 as ku,u32be as Lu,u40 as Nu,u40be as Cu,u48 as Iu,u48be as Eu,u8 as Ru,UInt as vr,union as Mu,Union as Du,unionLayoutDiscriminator as _u,utf8 as vu}from"@solana/buffer-layout";var dt=Dr,un=_r;var gt=vr;var ht=Mr;var bt=class extends dt{constructor(n,r,i){super(n,i);this.blob=ht(n),this.signed=r}decode(n,r=0){let i=new cn(this.blob.decode(n,r),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(n,r,i=0){return typeof n=="number"&&(n=new cn(n)),this.signed&&(n=n.toTwos(this.span*8)),this.blob.encode(n.toArrayLike(Buffer,"le",this.span),r,i)}};function ln(e){return new gt(1,e)}function Ge(e){return new gt(4,e)}function He(e){return new bt(8,!1,e)}var yt=class extends dt{constructor(n,r,i,o){super(n.span,o);this.layout=n,this.decoder=r,this.encoder=i}decode(n,r){return this.decoder(this.layout.decode(n,r))}encode(n,r,i){return this.layout.encode(this.encoder(n),r,i)}getSpan(n,r){return this.layout.getSpan(n,r)}};function Se(e){return new yt(ht(32),t=>new Or(t),t=>t.toBuffer(),e)}var wt=class extends un{decode(t,n){return super.decode(t,n)}};function fn(e,t,n){return new wt(e,t,n)}var je=fn([Se("mint"),Se("owner"),He("amount"),Ge("delegateOption"),Se("delegate"),ln("state"),Ge("isNativeOption"),He("isNative"),He("delegatedAmount"),Ge("closeAuthorityOption"),Se("closeAuthority")]);function Kr(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function xt(e,...t){if(!Kr(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function Tt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function pn(e,t){xt(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var Ye=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Y=(e,t)=>e<<32-t|e>>>t;var nc=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Fr(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Pt(e){return typeof e=="string"&&(e=Fr(e)),xt(e),e}var ze=class{clone(){return this._cloneInto()}},rc={}.toString;function mn(e){let t=r=>e().update(Pt(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Vr(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,u=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+u,a,r)}var dn=(e,t,n)=>e&t^~e&n,gn=(e,t,n)=>e&t^e&n^t&n,Ze=class extends ze{constructor(t,n,r,i){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Ye(this.buffer)}update(t){Tt(this);let{view:n,buffer:r,blockLen:i}=this;t=Pt(t);let o=t.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let c=Ye(t);for(;i<=o-s;s+=i)this.process(c,s);continue}r.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Tt(this),pn(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:i,isLE:o}=this,{pos:s}=this;n[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(r,0),s=0);for(let l=s;l<i;l++)n[l]=0;Vr(r,i-8,BigInt(this.length*8),o),this.process(r,0);let a=Ye(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)a.setUint32(4*l,f[l],o)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:i,finished:o,destroyed:s,pos:a}=this;return t.length=i,t.pos=a,t.finished=o,t.destroyed=s,i%n&&t.buffer.set(r),t}};var Wr=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),re=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ie=new Uint32Array(64),At=class extends Ze{constructor(){super(64,32,8,!1),this.A=re[0]|0,this.B=re[1]|0,this.C=re[2]|0,this.D=re[3]|0,this.E=re[4]|0,this.F=re[5]|0,this.G=re[6]|0,this.H=re[7]|0}get(){let{A:t,B:n,C:r,D:i,E:o,F:s,G:a,H:c}=this;return[t,n,r,i,o,s,a,c]}set(t,n,r,i,o,s,a,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=c|0}process(t,n){for(let l=0;l<16;l++,n+=4)ie[l]=t.getUint32(n,!1);for(let l=16;l<64;l++){let p=ie[l-15],d=ie[l-2],y=Y(p,7)^Y(p,18)^p>>>3,g=Y(d,17)^Y(d,19)^d>>>10;ie[l]=g+ie[l-7]+y+ie[l-16]|0}let{A:r,B:i,C:o,D:s,E:a,F:c,G:u,H:f}=this;for(let l=0;l<64;l++){let p=Y(a,6)^Y(a,11)^Y(a,25),d=f+p+dn(a,c,u)+Wr[l]+ie[l]|0,g=(Y(r,2)^Y(r,13)^Y(r,22))+gn(r,i,o)|0;f=u,u=c,c=a,a=s+d|0,s=o,o=i,i=r,r=d+g|0}r=r+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,f=f+this.H|0,this.set(r,i,o,s,a,c,u,f)}roundClean(){ie.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var hn=mn(()=>new At);var Pc=F("Raydium_Util");function bn({fromPublicKey:e,programId:t=Gr}){let n=qr.generate().publicKey.toBase58().slice(0,32);return{publicKey:Hr(e,n,t),seed:n}}function Hr(e,t,n){let r=Buffer.concat([e.toBuffer(),Buffer.from(t),n.toBuffer()]),i=hn(r);return new Ur(i)}function Qr(e){let{mint:t,tokenAccount:n,owner:r,programId:i=me}=e;return jr(n,t,r,i)}function ke(e){let{tokenAccount:t,payer:n,multiSigners:r=[],owner:i,programId:o=me}=e;return zr(t,n,i,r,o)}async function Bt(e){let{connection:t,amount:n,commitment:r,payer:i,owner:o,skipCloseAccount:s}=e,a=await t.getMinimumBalanceForRentExemption(je.span,r),c=H(n).add(new Xr(a)),u=bn({fromPublicKey:i,programId:me});return{addresses:{newAccount:u.publicKey},signers:[],instructions:[Jr.createAccountWithSeed({fromPubkey:i,basePubkey:i,seed:u.seed,newAccountPubkey:u.publicKey,lamports:c.toNumber(),space:je.span,programId:me}),Qr({mint:new Zr(Q.address),tokenAccount:u.publicKey,owner:o,programId:me})],instructionTypes:[se.CreateAccount,se.InitAccount],endInstructionTypes:s?[]:[se.CloseAccount],endInstructions:s?[]:[ke({tokenAccount:u.publicKey,payer:i,owner:o})]}}function St({source:e,destination:t,owner:n,amount:r,multiSigners:i=[],tokenProgram:o=me}){return Yr(e,t,n,BigInt(String(r)),i,o)}var kt=class extends Be{constructor(t){super(t)}static getAddLiquidityDefaultPool({addLiquidityPools:t,poolInfosCache:n}){if(t.length===0)return;if(t.length===1||(t.sort((i,o)=>o.version-i.version),t[0].version!==t[1].version))return t[0];let r=t.filter(i=>i.version===t[0].version);return r.sort((i,o)=>this.comparePoolSize(i,o,n)),r[0]}static comparePoolSize(t,n,r){let i=r[t.id],o=r[n.id];return i===void 0?1:o===void 0?-1:t.baseMint===n.baseMint?i.baseReserve.sub(o.baseReserve).gte(Fe)?-1:1:i.baseReserve.sub(o.quoteReserve).gte(Fe)?-1:1}async getWSolAccounts(){this.scope.checkOwner(),await this.scope.account.fetchWalletTokenAccounts();let t=this.scope.account.tokenAccounts.filter(n=>n.mint.equals(_e));return t.sort((n,r)=>n.isAssociated?1:r.isAssociated||n.amount.lt(r.amount)?-1:1),t}async unWrapWSol(t){let{amount:n,tokenProgram:r}=t,i=await this.getWSolAccounts(),o=this.createTxBuilder();o.addCustomComputeBudget(t.computeBudgetConfig);let s=await Bt({connection:this.scope.connection,owner:this.scope.ownerPubKey,payer:this.scope.ownerPubKey,amount:0});o.addInstruction(s);let a=H(n);for(let c=0;c<i.length;c++)a.gte(i[c].amount)?(o.addInstruction({instructions:[ke({tokenAccount:i[c].publicKey,payer:this.scope.ownerPubKey,owner:this.scope.ownerPubKey,programId:r})]}),a.sub(i[c].amount)):(o.addInstruction({instructions:[ke({tokenAccount:i[c].publicKey,payer:this.scope.ownerPubKey,owner:this.scope.ownerPubKey,programId:r})]}),St({destination:s.addresses.newAccount,source:i[c].publicKey,amount:a,owner:this.scope.ownerPubKey,tokenProgram:r}));return o.build()}async wrapWSol(t,n){let r=await this.getWSolAccounts(),i=this.createTxBuilder(),o=await Bt({connection:this.scope.connection,owner:this.scope.ownerPubKey,payer:this.scope.ownerPubKey,amount:t,skipCloseAccount:!0});return i.addInstruction(o),r.length&&i.addInstruction({instructions:[St({destination:r[0].publicKey,source:o.addresses.newAccount,amount:t,owner:this.scope.ownerPubKey,tokenProgram:n})],endInstructions:[ke({tokenAccount:o.addresses.newAccount,payer:this.scope.ownerPubKey,owner:this.scope.ownerPubKey,programId:n})]}),i.build()}};export{kt as default};
/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
//# sourceMappingURL=trade.mjs.map