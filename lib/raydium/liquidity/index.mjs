import kt from"bn.js";var oi=new kt(25),si=new kt(1e4),mn={4:3,5:3};import{PublicKey as yn}from"@solana/web3.js";import Tt,{isBN as Bt}from"bn.js";import{bits as ci,BitStructure as li,blob as pn,Blob as mi,cstr as pi,f32 as fi,f32be as di,f64 as gi,f64be as bi,greedy as yi,Layout as fn,ns64 as hi,ns64be as wi,nu64 as Pi,nu64be as xi,offset as ki,s16 as Si,s16be as Ni,s24 as Li,s24be as Ti,s32 as Bi,s32be as Ai,s40 as Ii,s40be as Ei,s48 as _i,s48be as Ci,s8 as Ki,seq as dn,struct as vi,Structure as gn,u16 as Wi,u16be as Di,u24 as Oi,u24be as Ri,u32 as qi,u32be as Mi,u40 as Vi,u40be as Fi,u48 as Ui,u48be as ji,u8 as Yi,UInt as bn,union as Zi,Union as Gi,unionLayoutDiscriminator as Hi,utf8 as Qi}from"@solana/buffer-layout";var Ge=fn,St=gn;var Nt=bn;var Lt=dn;var He=pn;var Ce=class extends Ge{constructor(n,r,o){super(n,o);this.blob=He(n),this.signed=r}decode(n,r=0){let o=new Tt(this.blob.decode(n,r),10,"le");return this.signed?o.fromTwos(this.span*8).clone():o}encode(n,r,o=0){return typeof n=="number"&&(n=new Tt(n)),this.signed&&(n=n.toTwos(this.span*8)),this.blob.encode(n.toArrayLike(Buffer,"le",this.span),r,o)}};function q(e){return new Nt(1,e)}function g(e){return new Ce(8,!1,e)}function z(e){return new Ce(16,!1,e)}var Qe=class extends Ge{constructor(n,r,o,i){super(n.span,i);this.layout=n,this.decoder=r,this.encoder=o}decode(n,r){return this.decoder(this.layout.decode(n,r))}encode(n,r,o){return this.layout.encode(this.encoder(n),r,o)}getSpan(n,r){return this.layout.getSpan(n,r)}};function E(e){return new Qe(He(32),t=>new yn(t),t=>t.toBuffer(),e)}var ze=class extends St{decode(t,n){return super.decode(t,n)}};function D(e,t,n){return new ze(e,t,n)}function ke(e,t,n){let r,o=typeof t=="number"?t:Bt(t)?t.toNumber():new Proxy(t,{get(i,s){if(!r){let u=Reflect.get(i,"count");r=Bt(u)?u.toNumber():u,Reflect.set(i,"count",r)}return Reflect.get(i,s)},set(i,s,u){return s==="count"&&(r=u),Reflect.set(i,s,u)}});return Lt(e,o,n)}var Xe=D([q("instruction"),g("amountIn"),g("minAmountOut")]),$e=D([q("instruction"),g("maxAmountIn"),g("amountOut")]),go=D([q("instruction"),q("nonce")]),Je=D([q("instruction"),q("nonce"),g("startTime")]),hn=D([g("status"),g("nonce"),g("maxOrder"),g("depth"),g("baseDecimal"),g("quoteDecimal"),g("state"),g("resetFlag"),g("minSize"),g("volMaxCutRatio"),g("amountWaveRatio"),g("baseLotSize"),g("quoteLotSize"),g("minPriceMultiplier"),g("maxPriceMultiplier"),g("systemDecimalValue"),g("minSeparateNumerator"),g("minSeparateDenominator"),g("tradeFeeNumerator"),g("tradeFeeDenominator"),g("pnlNumerator"),g("pnlDenominator"),g("swapFeeNumerator"),g("swapFeeDenominator"),g("baseNeedTakePnl"),g("quoteNeedTakePnl"),g("quoteTotalPnl"),g("baseTotalPnl"),g("poolOpenTime"),g("punishPcAmount"),g("punishCoinAmount"),g("orderbookToInitTime"),z("swapBaseInAmount"),z("swapQuoteOutAmount"),g("swapBase2QuoteFee"),z("swapQuoteInAmount"),z("swapBaseOutAmount"),g("swapQuote2BaseFee"),E("baseVault"),E("quoteVault"),E("baseMint"),E("quoteMint"),E("lpMint"),E("openOrders"),E("marketId"),E("marketProgramId"),E("targetOrders"),E("withdrawQueue"),E("lpVault"),E("owner"),g("lpReserve"),ke(g(),3,"padding")]),wn=D([g("accountType"),g("status"),g("nonce"),g("maxOrder"),g("depth"),g("baseDecimal"),g("quoteDecimal"),g("state"),g("resetFlag"),g("minSize"),g("volMaxCutRatio"),g("amountWaveRatio"),g("baseLotSize"),g("quoteLotSize"),g("minPriceMultiplier"),g("maxPriceMultiplier"),g("systemDecimalsValue"),g("abortTradeFactor"),g("priceTickMultiplier"),g("priceTick"),g("minSeparateNumerator"),g("minSeparateDenominator"),g("tradeFeeNumerator"),g("tradeFeeDenominator"),g("pnlNumerator"),g("pnlDenominator"),g("swapFeeNumerator"),g("swapFeeDenominator"),g("baseNeedTakePnl"),g("quoteNeedTakePnl"),g("quoteTotalPnl"),g("baseTotalPnl"),g("poolOpenTime"),g("punishPcAmount"),g("punishCoinAmount"),g("orderbookToInitTime"),z("swapBaseInAmount"),z("swapQuoteOutAmount"),z("swapQuoteInAmount"),z("swapBaseOutAmount"),g("swapQuote2BaseFee"),g("swapBase2QuoteFee"),E("baseVault"),E("quoteVault"),E("baseMint"),E("quoteMint"),E("lpMint"),E("modelDataAccount"),E("openOrders"),E("marketId"),E("marketProgramId"),E("targetOrders"),E("owner"),ke(g(),64,"padding")]),et=D([q("instruction"),g("baseAmountIn"),g("quoteAmountIn"),g("fixedSide")]),tt=D([q("instruction"),g("amountIn")]),bo={4:hn,5:wn},yo=D([g("fee")]);import{PublicKey as ei}from"@solana/web3.js";import{PublicKey as _t,ComputeBudgetProgram as To,Transaction as it,TransactionMessage as Io,Keypair as Eo,VersionedTransaction as Co}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as vo}from"@solana/spl-token";import{get as At,set as Pn}from"lodash";import Et from"dayjs";import xn from"dayjs/plugin/utc";Et.extend(xn);var nt=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Et().utc().format("YYYY/MM/DD HH:mm:ss UTC")}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let n=t.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},It={},kn={};function F(e){let t=At(It,e);if(!t){let n=At(kn,e);t=new nt({name:e,logLevel:n}),Pn(It,e,t)}return t}var rt={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut"};var X=F("Raydium_txUtil"),Sn=1644;function Nn(e,t){e.length<1&&X.logWithError(`no instructions provided: ${e.toString()}`),t.length<1&&X.logWithError(`no signers provided:, ${t.toString()}`);let n=new it;n.recentBlockhash="11111111111111111111111111111111",n.feePayer=t[0],n.add(...e);try{return Buffer.from(n.serialize({verifySignatures:!1})).toString("base64").length<Sn}catch{return!1}}async function Ct(e,t,n,r=!0){let o=new _t("RaydiumSimuLateTransaction11111111111111111"),i=[],s=new it;s.feePayer=o;for(let a of t)Nn([...s.instructions,a],[o])||(i.push(s),s=new it,s.feePayer=o),s.add(a);s.instructions.length>0&&i.push(s);let u=[];try{if(u=await Ln(e,i,r),u.find(a=>a.err!==null))throw Error("rpc simulateTransaction error")}catch(a){a instanceof Error&&X.logWithError("failed to simulate for instructions","RPC_ERROR",{message:a.message})}let c=[];for(let a of u)if(X.debug("simulate result:",a),a.logs){let l=a.logs.filter(m=>m&&m.includes(n));X.debug("filteredLog:",c),l.length||X.logWithError("simulate log not match keyword","keyword",n),c.push(...l)}return c}function Kt(e,t){let n=e.match(/{["\w:,]+}/g);return!n||n.length!==1?X.logWithError(`simulate log fail to match json, keyword: ${t}`):n[0]}function $(e,t){let r=new RegExp(`"${t}":(\\d+)`,"g").exec(e);return!r||r.length!==2?X.logWithError(`simulate log fail to match key", key: ${t}`):r[1]}function Se(e,t){let[n,r]=_t.findProgramAddressSync(e,t);return{publicKey:n,nonce:r}}async function Ln(e,t,n){let r=[];if(n){let o=await e.getLatestBlockhash(),i=[];for(let a of t){a.recentBlockhash=o.blockhash,a.lastValidBlockHeight=o.lastValidBlockHeight;let m=a._compile().serialize(),b=a._serialize(m).toString("base64");i.push(b)}let s=i.map(a=>{let l=e._buildArgs([a],void 0,"base64");return{methodName:"simulateTransaction",args:l}}),u=[],c=20;for(let a=0;a<Math.ceil(s.length/c);a++)u.push(s.slice(a*c,(a+1)*c));r=await(await Promise.all(u.map(async a=>(await e._rpcBatchRequest(a)).map(l=>l.result.value)))).flat()}else try{r=await Promise.all(t.map(async o=>await(await e.simulateTransaction(o)).value))}catch(o){o instanceof Error&&X.logWithError("failed to get info for multiple accounts","RPC_ERROR",{message:o.message})}return r}import{PublicKey as Tn}from"@solana/web3.js";var Bn=F("Raydium_liquidity_serum");function vt({programId:e,marketId:t}){let n=[t.toBuffer()],r=0,o;for(;r<100;){try{let i=n.concat(Buffer.from([r]),Buffer.alloc(7));o=Tn.createProgramAddressSync(i,e)}catch(i){if(i instanceof TypeError)throw i;r++;continue}return{publicKey:o,nonce:r}}throw Bn.logWithError("unable to find a viable program address nonce","params",{programId:e,marketId:t}),new Error("unable to find a viable program address nonce")}import{PublicKey as An}from"@solana/web3.js";var ye=new An("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),le=5e4,In=D([g("x"),g("y"),g("price")]),En=D([g("accountType"),g("status"),g("multiplier"),g("validDataCount"),ke(In,le,"DataElement")]);function _n(e,t){return[0,le-2]}function Cn(e){return[0,le-2]}function Kn(e){return[0,le-2]}function vn(e,t,n){let[r,o]=_n(t,n),i=r,s=o,u=0,c=t*e.multiplier/n;for(;i<=s;){if(u=Math.floor((s+i)/2),u===0||u>=le-2)return[u,u,!1];let a=e.DataElement[u].x*e.multiplier/e.DataElement[u].y,l=e.DataElement[u-1].x*e.multiplier/e.DataElement[u-1].y,m=e.DataElement[u+1].x*e.multiplier/e.DataElement[u+1].y;if(c===a)return[u,u,!0];if(c===l)return[u-1,u-1,!0];if(c===m)return[u+1,u+1,!0];if(c<l)s=u-1;else{if(c>l&&c<a)return[u-1,u,!0];if(c>a&&c<m)return[u,u+1,!0];i=u+1}}return[u,u,!1]}function ot(e,t,n){let[r,o,i]=vn(e,t,n);if(!i)return 0;if(r===o){let s=e.DataElement[r].x;return t*e.multiplier/s}else{let s=e.DataElement[r].x,u=e.DataElement[r].y,c=e.DataElement[o].x,a=e.DataElement[o].y,l=n*(c*u-s*a),m=s*l,p=(c-s)*(t*u-s*n)*a,b=m+p;return t*e.multiplier*l/b}}function ce(e,t,n){return t*e.multiplier/n}function Wt(e,t,n){return t*n/e.multiplier}function Wn(e,t){let[n,r]=Cn(t),o=n,i=r,s=0,u=t;for(;o<i;){if(s=Math.floor((i+o)/2),s<=0||s>le-2)return[s,s,!1];let c=e.DataElement[s].x,a=e.DataElement[s-1].x,l=e.DataElement[s+1].x;if(u===c)return[s,s,!0];if(u===a)return[s-1,s-1,!0];if(u===l)return[s+1,s+1,!0];if(u<a)i=s-1;else{if(u>a&&u<c)return[s-1,s,!0];if(u>c&&u<l)return[s,s+1,!0];o=s+1}}return[s,s,!1]}function Dn(e,t){let[n,r]=Kn(t),o=n,i=r,s=0,u=t;for(;o<=i;){if(s=Math.floor((i+o)/2),s<=0||s>=le-2)return[s,s,!1];let c=e.DataElement[s].y,a=e.DataElement[s-1].y,l=e.DataElement[s+1].y;if(u===c)return[s,s,!0];if(u===a)return[s-1,s-1,!0];if(u===l)return[s+1,s+1,!0];if(u<l)o=s+1;else{if(u<a&&u>c)return[s-1,s,!0];if(u<c&&u>l)return[s,s+1,!0];i=s-1}}return[s,s,!1]}function Dt(e,t,n,r){let o=r?t+n:t-n,[i,s,u]=Wn(e,o);if(!u)return[0,0,!1,u];if(i===s)return[e.DataElement[s].price,e.DataElement[s].y,!1,u];{let c=e.DataElement[i].x,a=e.DataElement[s].x,l=e.DataElement[i].price,m=e.DataElement[s].price,p=e.DataElement[i].y,b=e.DataElement[s].y;if(t>=c&&t<=a)return r?[m,b,!0,u]:[l,p,!0,u];{let P,y;return r?(P=l+(m-l)*(t-c)/(a-c),y=p-(o-c)*e.multiplier/m):(P=l+(m-l)*(t-c)/(a-c),y=b+(a-o)*e.multiplier/l),[P,y,!1,u]}}}function On(e,t,n,r){let o=r?t-n:t+n,[i,s,u]=Dn(e,o);if(!u)return[0,0,!1,u];if(i===s)return[e.DataElement[s].price,e.DataElement[s].x,!1,u];{let c=e.DataElement[i].x,a=e.DataElement[s].x,l=e.DataElement[i].price,m=e.DataElement[s].price,p=e.DataElement[i].y,b=e.DataElement[s].y;if(t>=b&&t<=p)return r?[m,a,!0,u]:[l,c,!0,u];{let P,y;return r?(P=l+(m-l)*(p-t)/(p-b),y=c+m*(p-o)/e.multiplier):(P=l+(m-l)*(p-t)/(p-b),y=a-l*(o-b)/e.multiplier),[P,y,!1,u]}}}function Rn(e,t){let n=Dt(e,t,0,!1);return n[3]?n[0]:0}function Yo(e,t,n,r){let o=ot(e,t,n),i=ce(e,t,o),s=ce(e,n,o),u=ce(e,r,o),c=!0,[a,l,m,p]=Dt(e,i,u,c);if(!p)return 0;if(m)return r*e.multiplier/a;{let b=s-l;return Wt(e,b,o)}}function Zo(e,t,n,r){let o=ot(e,t,n),i=ce(e,t,o),s=ce(e,n,o),u=ce(e,r,o),c=!1,[a,l,m,p]=On(e,s,u,c);if(!p)return 0;if(m)return r*a/e.multiplier;{let b=i-l;return Wt(e,b,o)}}function qn(e){let t=En.decode(e);return{accountType:t.accountType.toNumber(),status:t.status.toNumber(),multiplier:t.multiplier.toNumber(),validDataCount:t.validDataCount.toNumber(),DataElement:t.DataElement.map(n=>({x:n.x.toNumber(),y:n.y.toNumber(),price:n.price.toNumber()}))}}function Go(e,t,n,r){let o=Rn(e,ce(e,t,ot(e,t,n)))/e.multiplier;return r?o:1/o}var Ke=class{constructor({connection:t}){this._layoutData={accountType:0,status:0,multiplier:0,validDataCount:0,DataElement:[]};this.connection=t}get stableModelData(){return this._layoutData}async initStableModelLayout(){if(this._layoutData.validDataCount===0&&this.connection){let t=await this.connection.getAccountInfo(ye);t&&(this._layoutData=qn(t==null?void 0:t.data))}}};import{TOKEN_PROGRAM_ID as Ae,ASSOCIATED_TOKEN_PROGRAM_ID as zr}from"@solana/spl-token";import{PublicKey as N,TransactionInstruction as ne,SystemProgram as Pt,SYSVAR_RENT_PUBKEY as Xr}from"@solana/web3.js";import j from"bn.js";var he=9e15,se=1e9,st="0123456789abcdef",We="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",De="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",ut={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-he,maxE:he,crypto:!1},Mt,J,x=!0,Re="[DecimalError] ",oe=Re+"Invalid argument: ",Vt=Re+"Precision limit exceeded",Ft=Re+"crypto unavailable",Ut="[object Decimal]",M=Math.floor,v=Math.pow,Mn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Vn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Fn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,jt=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,H=1e7,w=7,Un=9007199254740991,jn=We.length-1,at=De.length-1,d={toStringTag:Ut};d.absoluteValue=d.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),h(e)};d.ceil=function(){return h(new this.constructor(this),this.e+1,2)};d.clampedTo=d.clamp=function(e,t){var n,r=this,o=r.constructor;if(e=new o(e),t=new o(t),!e.s||!t.s)return new o(NaN);if(e.gt(t))throw Error(oe+t);return n=r.cmp(e),n<0?e:r.cmp(t)>0?t:new o(r)};d.comparedTo=d.cmp=function(e){var t,n,r,o,i=this,s=i.d,u=(e=new i.constructor(e)).d,c=i.s,a=e.s;if(!s||!u)return!c||!a?NaN:c!==a?c:s===u?0:!s^c<0?1:-1;if(!s[0]||!u[0])return s[0]?c:u[0]?-a:0;if(c!==a)return c;if(i.e!==e.e)return i.e>e.e^c<0?1:-1;for(r=s.length,o=u.length,t=0,n=r<o?r:o;t<n;++t)if(s[t]!==u[t])return s[t]>u[t]^c<0?1:-1;return r===o?0:r>o^c<0?1:-1};d.cosine=d.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+w,r.rounding=1,n=Yn(r,Qt(r,n)),r.precision=e,r.rounding=t,h(J==2||J==3?n.neg():n,e,t,!0)):new r(1):new r(NaN)};d.cubeRoot=d.cbrt=function(){var e,t,n,r,o,i,s,u,c,a,l=this,m=l.constructor;if(!l.isFinite()||l.isZero())return new m(l);for(x=!1,i=l.s*v(l.s*l,1/3),!i||Math.abs(i)==1/0?(n=O(l.d),e=l.e,(i=(e-n.length+1)%3)&&(n+=i==1||i==-2?"0":"00"),i=v(n,1/3),e=M((e+1)/3)-(e%3==(e<0?-1:2)),i==1/0?n="5e"+e:(n=i.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),r=new m(n),r.s=l.s):r=new m(i.toString()),s=(e=m.precision)+3;;)if(u=r,c=u.times(u).times(u),a=c.plus(l),r=T(a.plus(l).times(u),a.plus(c),s+2,1),O(u.d).slice(0,s)===(n=O(r.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!o&&n=="4999"){if(!o&&(h(u,e+1,0),u.times(u).times(u).eq(l))){r=u;break}s+=4,o=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(h(r,e+1,1),t=!r.times(r).times(r).eq(l));break}return x=!0,h(r,e,m.rounding,t)};d.decimalPlaces=d.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-M(this.e/w))*w,e=t[e],e)for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n};d.dividedBy=d.div=function(e){return T(this,new this.constructor(e))};d.dividedToIntegerBy=d.divToInt=function(e){var t=this,n=t.constructor;return h(T(t,new n(e),0,1,1),n.precision,n.rounding)};d.equals=d.eq=function(e){return this.cmp(e)===0};d.floor=function(){return h(new this.constructor(this),this.e+1,3)};d.greaterThan=d.gt=function(e){return this.cmp(e)>0};d.greaterThanOrEqualTo=d.gte=function(e){var t=this.cmp(e);return t==1||t===0};d.hyperbolicCosine=d.cosh=function(){var e,t,n,r,o,i=this,s=i.constructor,u=new s(1);if(!i.isFinite())return new s(i.s?1/0:NaN);if(i.isZero())return u;n=s.precision,r=s.rounding,s.precision=n+Math.max(i.e,i.sd())+4,s.rounding=1,o=i.d.length,o<32?(e=Math.ceil(o/3),t=(1/Me(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),i=we(s,1,i.times(t),new s(1),!0);for(var c,a=e,l=new s(8);a--;)c=i.times(i),i=u.minus(c.times(l.minus(c.times(l))));return h(i,s.precision=n,s.rounding=r,!0)};d.hyperbolicSine=d.sinh=function(){var e,t,n,r,o=this,i=o.constructor;if(!o.isFinite()||o.isZero())return new i(o);if(t=i.precision,n=i.rounding,i.precision=t+Math.max(o.e,o.sd())+4,i.rounding=1,r=o.d.length,r<3)o=we(i,2,o,o,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,o=o.times(1/Me(5,e)),o=we(i,2,o,o,!0);for(var s,u=new i(5),c=new i(16),a=new i(20);e--;)s=o.times(o),o=o.times(u.plus(s.times(c.times(s).plus(a))))}return i.precision=t,i.rounding=n,h(o,t,n,!0)};d.hyperbolicTangent=d.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,T(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)};d.inverseCosine=d.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),o=n.precision,i=n.rounding;return r!==-1?r===0?t.isNeg()?G(n,o,i):new n(0):new n(NaN):t.isZero()?G(n,o+4,i).times(.5):(n.precision=o+6,n.rounding=1,t=t.asin(),e=G(n,o+4,i).times(.5),n.precision=o,n.rounding=i,e.minus(t))};d.inverseHyperbolicCosine=d.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,x=!1,n=n.times(n).minus(1).sqrt().plus(n),x=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)};d.inverseHyperbolicSine=d.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,x=!1,n=n.times(n).plus(1).sqrt().plus(n),x=!0,r.precision=e,r.rounding=t,n.ln())};d.inverseHyperbolicTangent=d.atanh=function(){var e,t,n,r,o=this,i=o.constructor;return o.isFinite()?o.e>=0?new i(o.abs().eq(1)?o.s/0:o.isZero()?o:NaN):(e=i.precision,t=i.rounding,r=o.sd(),Math.max(r,e)<2*-o.e-1?h(new i(o),e,t,!0):(i.precision=n=r-o.e,o=T(o.plus(1),new i(1).minus(o),n+e,1),i.precision=e+4,i.rounding=1,o=o.ln(),i.precision=e,i.rounding=t,o.times(.5))):new i(NaN)};d.inverseSine=d.asin=function(){var e,t,n,r,o=this,i=o.constructor;return o.isZero()?new i(o):(t=o.abs().cmp(1),n=i.precision,r=i.rounding,t!==-1?t===0?(e=G(i,n+4,r).times(.5),e.s=o.s,e):new i(NaN):(i.precision=n+6,i.rounding=1,o=o.div(new i(1).minus(o.times(o)).sqrt().plus(1)).atan(),i.precision=n,i.rounding=r,o.times(2)))};d.inverseTangent=d.atan=function(){var e,t,n,r,o,i,s,u,c,a=this,l=a.constructor,m=l.precision,p=l.rounding;if(a.isFinite()){if(a.isZero())return new l(a);if(a.abs().eq(1)&&m+4<=at)return s=G(l,m+4,p).times(.25),s.s=a.s,s}else{if(!a.s)return new l(NaN);if(m+4<=at)return s=G(l,m+4,p).times(.5),s.s=a.s,s}for(l.precision=u=m+10,l.rounding=1,n=Math.min(28,u/w+2|0),e=n;e;--e)a=a.div(a.times(a).plus(1).sqrt().plus(1));for(x=!1,t=Math.ceil(u/w),r=1,c=a.times(a),s=new l(a),o=a;e!==-1;)if(o=o.times(c),i=s.minus(o.div(r+=2)),o=o.times(c),s=i.plus(o.div(r+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===i.d[e]&&e--;);return n&&(s=s.times(2<<n-1)),x=!0,h(s,l.precision=m,l.rounding=p,!0)};d.isFinite=function(){return!!this.d};d.isInteger=d.isInt=function(){return!!this.d&&M(this.e/w)>this.d.length-2};d.isNaN=function(){return!this.s};d.isNegative=d.isNeg=function(){return this.s<0};d.isPositive=d.isPos=function(){return this.s>0};d.isZero=function(){return!!this.d&&this.d[0]===0};d.lessThan=d.lt=function(e){return this.cmp(e)<0};d.lessThanOrEqualTo=d.lte=function(e){return this.cmp(e)<1};d.logarithm=d.log=function(e){var t,n,r,o,i,s,u,c,a=this,l=a.constructor,m=l.precision,p=l.rounding,b=5;if(e==null)e=new l(10),t=!0;else{if(e=new l(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(n=a.d,a.s<0||!n||!n[0]||a.eq(1))return new l(n&&!n[0]?-1/0:a.s!=1?NaN:n?0:1/0);if(t)if(n.length>1)i=!0;else{for(o=n[0];o%10===0;)o/=10;i=o!==1}if(x=!1,u=m+b,s=ie(a,u),r=t?Oe(l,u+10):ie(e,u),c=T(s,r,u,1),Ne(c.d,o=m,p))do if(u+=10,s=ie(a,u),r=t?Oe(l,u+10):ie(e,u),c=T(s,r,u,1),!i){+O(c.d).slice(o+1,o+15)+1==1e14&&(c=h(c,m+1,0));break}while(Ne(c.d,o+=10,p));return x=!0,h(c,m,p)};d.minus=d.sub=function(e){var t,n,r,o,i,s,u,c,a,l,m,p,b=this,P=b.constructor;if(e=new P(e),!b.d||!e.d)return!b.s||!e.s?e=new P(NaN):b.d?e.s=-e.s:e=new P(e.d||b.s!==e.s?b:NaN),e;if(b.s!=e.s)return e.s=-e.s,b.plus(e);if(a=b.d,p=e.d,u=P.precision,c=P.rounding,!a[0]||!p[0]){if(p[0])e.s=-e.s;else if(a[0])e=new P(b);else return new P(c===3?-0:0);return x?h(e,u,c):e}if(n=M(e.e/w),l=M(b.e/w),a=a.slice(),i=l-n,i){for(m=i<0,m?(t=a,i=-i,s=p.length):(t=p,n=l,s=a.length),r=Math.max(Math.ceil(u/w),s)+2,i>r&&(i=r,t.length=1),t.reverse(),r=i;r--;)t.push(0);t.reverse()}else{for(r=a.length,s=p.length,m=r<s,m&&(s=r),r=0;r<s;r++)if(a[r]!=p[r]){m=a[r]<p[r];break}i=0}for(m&&(t=a,a=p,p=t,e.s=-e.s),s=a.length,r=p.length-s;r>0;--r)a[s++]=0;for(r=p.length;r>i;){if(a[--r]<p[r]){for(o=r;o&&a[--o]===0;)a[o]=H-1;--a[o],a[r]+=H}a[r]-=p[r]}for(;a[--s]===0;)a.pop();for(;a[0]===0;a.shift())--n;return a[0]?(e.d=a,e.e=qe(a,n),x?h(e,u,c):e):new P(c===3?-0:0)};d.modulo=d.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?h(new r(n),r.precision,r.rounding):(x=!1,r.modulo==9?(t=T(n,e.abs(),0,3,1),t.s*=e.s):t=T(n,e,0,r.modulo,1),t=t.times(e),x=!0,n.minus(t))};d.naturalExponential=d.exp=function(){return ct(this)};d.naturalLogarithm=d.ln=function(){return ie(this)};d.negated=d.neg=function(){var e=new this.constructor(this);return e.s=-e.s,h(e)};d.plus=d.add=function(e){var t,n,r,o,i,s,u,c,a,l,m=this,p=m.constructor;if(e=new p(e),!m.d||!e.d)return!m.s||!e.s?e=new p(NaN):m.d||(e=new p(e.d||m.s===e.s?m:NaN)),e;if(m.s!=e.s)return e.s=-e.s,m.minus(e);if(a=m.d,l=e.d,u=p.precision,c=p.rounding,!a[0]||!l[0])return l[0]||(e=new p(m)),x?h(e,u,c):e;if(i=M(m.e/w),r=M(e.e/w),a=a.slice(),o=i-r,o){for(o<0?(n=a,o=-o,s=l.length):(n=l,r=i,s=a.length),i=Math.ceil(u/w),s=i>s?i+1:s+1,o>s&&(o=s,n.length=1),n.reverse();o--;)n.push(0);n.reverse()}for(s=a.length,o=l.length,s-o<0&&(o=s,n=l,l=a,a=n),t=0;o;)t=(a[--o]=a[o]+l[o]+t)/H|0,a[o]%=H;for(t&&(a.unshift(t),++r),s=a.length;a[--s]==0;)a.pop();return e.d=a,e.e=qe(a,r),x?h(e,u,c):e};d.precision=d.sd=function(e){var t,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(oe+e);return n.d?(t=Yt(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t};d.round=function(){var e=this,t=e.constructor;return h(new t(e),e.e+1,t.rounding)};d.sine=d.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+w,r.rounding=1,n=Gn(r,Qt(r,n)),r.precision=e,r.rounding=t,h(J>2?n.neg():n,e,t,!0)):new r(NaN)};d.squareRoot=d.sqrt=function(){var e,t,n,r,o,i,s=this,u=s.d,c=s.e,a=s.s,l=s.constructor;if(a!==1||!u||!u[0])return new l(!a||a<0&&(!u||u[0])?NaN:u?s:1/0);for(x=!1,a=Math.sqrt(+s),a==0||a==1/0?(t=O(u),(t.length+c)%2==0&&(t+="0"),a=Math.sqrt(t),c=M((c+1)/2)-(c<0||c%2),a==1/0?t="5e"+c:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),r=new l(t)):r=new l(a.toString()),n=(c=l.precision)+3;;)if(i=r,r=i.plus(T(s,i,n+2,1)).times(.5),O(i.d).slice(0,n)===(t=O(r.d)).slice(0,n))if(t=t.slice(n-3,n+1),t=="9999"||!o&&t=="4999"){if(!o&&(h(i,c+1,0),i.times(i).eq(s))){r=i;break}n+=4,o=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(h(r,c+1,1),e=!r.times(r).eq(s));break}return x=!0,h(r,c,l.rounding,e)};d.tangent=d.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,n=n.sin(),n.s=1,n=T(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,h(J==2||J==4?n.neg():n,e,t,!0)):new r(NaN)};d.times=d.mul=function(e){var t,n,r,o,i,s,u,c,a,l=this,m=l.constructor,p=l.d,b=(e=new m(e)).d;if(e.s*=l.s,!p||!p[0]||!b||!b[0])return new m(!e.s||p&&!p[0]&&!b||b&&!b[0]&&!p?NaN:!p||!b?e.s/0:e.s*0);for(n=M(l.e/w)+M(e.e/w),c=p.length,a=b.length,c<a&&(i=p,p=b,b=i,s=c,c=a,a=s),i=[],s=c+a,r=s;r--;)i.push(0);for(r=a;--r>=0;){for(t=0,o=c+r;o>r;)u=i[o]+b[r]*p[o-r-1]+t,i[o--]=u%H|0,t=u/H|0;i[o]=(i[o]+t)%H|0}for(;!i[--s];)i.pop();return t?++n:i.shift(),e.d=i,e.e=qe(i,n),x?h(e,m.precision,m.rounding):e};d.toBinary=function(e,t){return mt(this,2,e,t)};d.toDecimalPlaces=d.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(U(e,0,se),t===void 0?t=r.rounding:U(t,0,8),h(n,e+n.e+1,t))};d.toExponential=function(e,t){var n,r=this,o=r.constructor;return e===void 0?n=Q(r,!0):(U(e,0,se),t===void 0?t=o.rounding:U(t,0,8),r=h(new o(r),e+1,t),n=Q(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n};d.toFixed=function(e,t){var n,r,o=this,i=o.constructor;return e===void 0?n=Q(o):(U(e,0,se),t===void 0?t=i.rounding:U(t,0,8),r=h(new i(o),e+o.e+1,t),n=Q(r,!1,e+r.e+1)),o.isNeg()&&!o.isZero()?"-"+n:n};d.toFraction=function(e){var t,n,r,o,i,s,u,c,a,l,m,p,b=this,P=b.d,y=b.constructor;if(!P)return new y(b);if(a=n=new y(1),r=c=new y(0),t=new y(r),i=t.e=Yt(P)-b.e-1,s=i%w,t.d[0]=v(10,s<0?w+s:s),e==null)e=i>0?t:a;else{if(u=new y(e),!u.isInt()||u.lt(a))throw Error(oe+u);e=u.gt(t)?i>0?t:a:u}for(x=!1,u=new y(O(P)),l=y.precision,y.precision=i=P.length*w*2;m=T(u,t,0,1,1),o=n.plus(m.times(r)),o.cmp(e)!=1;)n=r,r=o,o=a,a=c.plus(m.times(o)),c=o,o=t,t=u.minus(m.times(o)),u=o;return o=T(e.minus(n),r,0,1,1),c=c.plus(o.times(a)),n=n.plus(o.times(r)),c.s=a.s=b.s,p=T(a,r,i,1).minus(b).abs().cmp(T(c,n,i,1).minus(b).abs())<1?[a,r]:[c,n],y.precision=l,x=!0,p};d.toHexadecimal=d.toHex=function(e,t){return mt(this,16,e,t)};d.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),e==null){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:U(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(x=!1,n=T(n,e,0,t,1).times(e),x=!0,h(n)):(e.s=n.s,n=e),n};d.toNumber=function(){return+this};d.toOctal=function(e,t){return mt(this,8,e,t)};d.toPower=d.pow=function(e){var t,n,r,o,i,s,u=this,c=u.constructor,a=+(e=new c(e));if(!u.d||!e.d||!u.d[0]||!e.d[0])return new c(v(+u,a));if(u=new c(u),u.eq(1))return u;if(r=c.precision,i=c.rounding,e.eq(1))return h(u,r,i);if(t=M(e.e/w),t>=e.d.length-1&&(n=a<0?-a:a)<=Un)return o=Zt(c,u,n,r),e.s<0?new c(1).div(o):h(o,r,i);if(s=u.s,s<0){if(t<e.d.length-1)return new c(NaN);if((e.d[t]&1)==0&&(s=1),u.e==0&&u.d[0]==1&&u.d.length==1)return u.s=s,u}return n=v(+u,a),t=n==0||!isFinite(n)?M(a*(Math.log("0."+O(u.d))/Math.LN10+u.e+1)):new c(n+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?s/0:0):(x=!1,c.rounding=u.s=1,n=Math.min(12,(t+"").length),o=ct(e.times(ie(u,r+n)),r),o.d&&(o=h(o,r+5,1),Ne(o.d,r,i)&&(t=r+10,o=h(ct(e.times(ie(u,t+n)),t),t+5,1),+O(o.d).slice(r+1,r+15)+1==1e14&&(o=h(o,r+1,0)))),o.s=s,x=!0,c.rounding=i,h(o,r,i))};d.toPrecision=function(e,t){var n,r=this,o=r.constructor;return e===void 0?n=Q(r,r.e<=o.toExpNeg||r.e>=o.toExpPos):(U(e,1,se),t===void 0?t=o.rounding:U(t,0,8),r=h(new o(r),e,t),n=Q(r,e<=r.e||r.e<=o.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n};d.toSignificantDigits=d.toSD=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(U(e,1,se),t===void 0?t=r.rounding:U(t,0,8)),h(new r(n),e,t)};d.toString=function(){var e=this,t=e.constructor,n=Q(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n};d.truncated=d.trunc=function(){return h(new this.constructor(this),this.e+1,1)};d.valueOf=d.toJSON=function(){var e=this,t=e.constructor,n=Q(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function O(e){var t,n,r,o=e.length-1,i="",s=e[0];if(o>0){for(i+=s,t=1;t<o;t++)r=e[t]+"",n=w-r.length,n&&(i+=re(n)),i+=r;s=e[t],r=s+"",n=w-r.length,n&&(i+=re(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}function U(e,t,n){if(e!==~~e||e<t||e>n)throw Error(oe+e)}function Ne(e,t,n,r){var o,i,s,u;for(i=e[0];i>=10;i/=10)--t;return--t<0?(t+=w,o=0):(o=Math.ceil((t+1)/w),t%=w),i=v(10,w-t),u=e[o]%i|0,r==null?t<3?(t==0?u=u/100|0:t==1&&(u=u/10|0),s=n<4&&u==99999||n>3&&u==49999||u==5e4||u==0):s=(n<4&&u+1==i||n>3&&u+1==i/2)&&(e[o+1]/i/100|0)==v(10,t-2)-1||(u==i/2||u==0)&&(e[o+1]/i/100|0)==0:t<4?(t==0?u=u/1e3|0:t==1?u=u/100|0:t==2&&(u=u/10|0),s=(r||n<4)&&u==9999||!r&&n>3&&u==4999):s=((r||n<4)&&u+1==i||!r&&n>3&&u+1==i/2)&&(e[o+1]/i/1e3|0)==v(10,t-3)-1,s}function ve(e,t,n){for(var r,o=[0],i,s=0,u=e.length;s<u;){for(i=o.length;i--;)o[i]*=t;for(o[0]+=st.indexOf(e.charAt(s++)),r=0;r<o.length;r++)o[r]>n-1&&(o[r+1]===void 0&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}function Yn(e,t){var n,r,o;if(t.isZero())return t;r=t.d.length,r<32?(n=Math.ceil(r/3),o=(1/Me(4,n)).toString()):(n=16,o="2.3283064365386962890625e-10"),e.precision+=n,t=we(e,1,t.times(o),new e(1));for(var i=n;i--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=n,t}var T=function(){function e(r,o,i){var s,u=0,c=r.length;for(r=r.slice();c--;)s=r[c]*o+u,r[c]=s%i|0,u=s/i|0;return u&&r.unshift(u),r}function t(r,o,i,s){var u,c;if(i!=s)c=i>s?1:-1;else for(u=c=0;u<i;u++)if(r[u]!=o[u]){c=r[u]>o[u]?1:-1;break}return c}function n(r,o,i,s){for(var u=0;i--;)r[i]-=u,u=r[i]<o[i]?1:0,r[i]=u*s+r[i]-o[i];for(;!r[0]&&r.length>1;)r.shift()}return function(r,o,i,s,u,c){var a,l,m,p,b,P,y,K,L,V,k,W,ge,Y,xe,ue,ae,be,Z,Ee,_e=r.constructor,Ze=r.s==o.s?1:-1,R=r.d,B=o.d;if(!R||!R[0]||!B||!B[0])return new _e(!r.s||!o.s||(R?B&&R[0]==B[0]:!B)?NaN:R&&R[0]==0||!B?Ze*0:Ze/0);for(c?(b=1,l=r.e-o.e):(c=H,b=w,l=M(r.e/b)-M(o.e/b)),Z=B.length,ae=R.length,L=new _e(Ze),V=L.d=[],m=0;B[m]==(R[m]||0);m++);if(B[m]>(R[m]||0)&&l--,i==null?(Y=i=_e.precision,s=_e.rounding):u?Y=i+(r.e-o.e)+1:Y=i,Y<0)V.push(1),P=!0;else{if(Y=Y/b+2|0,m=0,Z==1){for(p=0,B=B[0],Y++;(m<ae||p)&&Y--;m++)xe=p*c+(R[m]||0),V[m]=xe/B|0,p=xe%B|0;P=p||m<ae}else{for(p=c/(B[0]+1)|0,p>1&&(B=e(B,p,c),R=e(R,p,c),Z=B.length,ae=R.length),ue=Z,k=R.slice(0,Z),W=k.length;W<Z;)k[W++]=0;Ee=B.slice(),Ee.unshift(0),be=B[0],B[1]>=c/2&&++be;do p=0,a=t(B,k,Z,W),a<0?(ge=k[0],Z!=W&&(ge=ge*c+(k[1]||0)),p=ge/be|0,p>1?(p>=c&&(p=c-1),y=e(B,p,c),K=y.length,W=k.length,a=t(y,k,K,W),a==1&&(p--,n(y,Z<K?Ee:B,K,c))):(p==0&&(a=p=1),y=B.slice()),K=y.length,K<W&&y.unshift(0),n(k,y,W,c),a==-1&&(W=k.length,a=t(B,k,Z,W),a<1&&(p++,n(k,Z<W?Ee:B,W,c))),W=k.length):a===0&&(p++,k=[0]),V[m++]=p,a&&k[0]?k[W++]=R[ue]||0:(k=[R[ue]],W=1);while((ue++<ae||k[0]!==void 0)&&Y--);P=k[0]!==void 0}V[0]||V.shift()}if(b==1)L.e=l,Mt=P;else{for(m=1,p=V[0];p>=10;p/=10)m++;L.e=m+l*b-1,h(L,u?i+L.e+1:i,s,P)}return L}}();function h(e,t,n,r){var o,i,s,u,c,a,l,m,p,b=e.constructor;e:if(t!=null){if(m=e.d,!m)return e;for(o=1,u=m[0];u>=10;u/=10)o++;if(i=t-o,i<0)i+=w,s=t,l=m[p=0],c=l/v(10,o-s-1)%10|0;else if(p=Math.ceil((i+1)/w),u=m.length,p>=u)if(r){for(;u++<=p;)m.push(0);l=c=0,o=1,i%=w,s=i-w+1}else break e;else{for(l=u=m[p],o=1;u>=10;u/=10)o++;i%=w,s=i-w+o,c=s<0?0:l/v(10,o-s-1)%10|0}if(r=r||t<0||m[p+1]!==void 0||(s<0?l:l%v(10,o-s-1)),a=n<4?(c||r)&&(n==0||n==(e.s<0?3:2)):c>5||c==5&&(n==4||r||n==6&&(i>0?s>0?l/v(10,o-s):0:m[p-1])%10&1||n==(e.s<0?8:7)),t<1||!m[0])return m.length=0,a?(t-=e.e+1,m[0]=v(10,(w-t%w)%w),e.e=-t||0):m[0]=e.e=0,e;if(i==0?(m.length=p,u=1,p--):(m.length=p+1,u=v(10,w-i),m[p]=s>0?(l/v(10,o-s)%v(10,s)|0)*u:0),a)for(;;)if(p==0){for(i=1,s=m[0];s>=10;s/=10)i++;for(s=m[0]+=u,u=1;s>=10;s/=10)u++;i!=u&&(e.e++,m[0]==H&&(m[0]=1));break}else{if(m[p]+=u,m[p]!=H)break;m[p--]=0,u=1}for(i=m.length;m[--i]===0;)m.pop()}return x&&(e.e>b.maxE?(e.d=null,e.e=NaN):e.e<b.minE&&(e.e=0,e.d=[0])),e}function Q(e,t,n){if(!e.isFinite())return Ht(e);var r,o=e.e,i=O(e.d),s=i.length;return t?(n&&(r=n-s)>0?i=i.charAt(0)+"."+i.slice(1)+re(r):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(e.e<0?"e":"e+")+e.e):o<0?(i="0."+re(-o-1)+i,n&&(r=n-s)>0&&(i+=re(r))):o>=s?(i+=re(o+1-s),n&&(r=n-o-1)>0&&(i=i+"."+re(r))):((r=o+1)<s&&(i=i.slice(0,r)+"."+i.slice(r)),n&&(r=n-s)>0&&(o+1===s&&(i+="."),i+=re(r))),i}function qe(e,t){var n=e[0];for(t*=w;n>=10;n/=10)t++;return t}function Oe(e,t,n){if(t>jn)throw x=!0,n&&(e.precision=n),Error(Vt);return h(new e(We),t,1,!0)}function G(e,t,n){if(t>at)throw Error(Vt);return h(new e(De),t,n,!0)}function Yt(e){var t=e.length-1,n=t*w+1;if(t=e[t],t){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function re(e){for(var t="";e--;)t+="0";return t}function Zt(e,t,n,r){var o,i=new e(1),s=Math.ceil(r/w+4);for(x=!1;;){if(n%2&&(i=i.times(t),Rt(i.d,s)&&(o=!0)),n=M(n/2),n===0){n=i.d.length-1,o&&i.d[n]===0&&++i.d[n];break}t=t.times(t),Rt(t.d,s)}return x=!0,i}function Ot(e){return e.d[e.d.length-1]&1}function Gt(e,t,n){for(var r,o=new e(t[0]),i=0;++i<t.length;)if(r=new e(t[i]),r.s)o[n](r)&&(o=r);else{o=r;break}return o}function ct(e,t){var n,r,o,i,s,u,c,a=0,l=0,m=0,p=e.constructor,b=p.rounding,P=p.precision;if(!e.d||!e.d[0]||e.e>17)return new p(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(x=!1,c=P):c=t,u=new p(.03125);e.e>-2;)e=e.times(u),m+=5;for(r=Math.log(v(2,m))/Math.LN10*2+5|0,c+=r,n=i=s=new p(1),p.precision=c;;){if(i=h(i.times(e),c,1),n=n.times(++l),u=s.plus(T(i,n,c,1)),O(u.d).slice(0,c)===O(s.d).slice(0,c)){for(o=m;o--;)s=h(s.times(s),c,1);if(t==null)if(a<3&&Ne(s.d,c-r,b,a))p.precision=c+=10,n=i=u=new p(1),l=0,a++;else return h(s,p.precision=P,b,x=!0);else return p.precision=P,s}s=u}}function ie(e,t){var n,r,o,i,s,u,c,a,l,m,p,b=1,P=10,y=e,K=y.d,L=y.constructor,V=L.rounding,k=L.precision;if(y.s<0||!K||!K[0]||!y.e&&K[0]==1&&K.length==1)return new L(K&&!K[0]?-1/0:y.s!=1?NaN:K?0:y);if(t==null?(x=!1,l=k):l=t,L.precision=l+=P,n=O(K),r=n.charAt(0),Math.abs(i=y.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)y=y.times(e),n=O(y.d),r=n.charAt(0),b++;i=y.e,r>1?(y=new L("0."+n),i++):y=new L(r+"."+n.slice(1))}else return a=Oe(L,l+2,k).times(i+""),y=ie(new L(r+"."+n.slice(1)),l-P).plus(a),L.precision=k,t==null?h(y,k,V,x=!0):y;for(m=y,c=s=y=T(y.minus(1),y.plus(1),l,1),p=h(y.times(y),l,1),o=3;;){if(s=h(s.times(p),l,1),a=c.plus(T(s,new L(o),l,1)),O(a.d).slice(0,l)===O(c.d).slice(0,l))if(c=c.times(2),i!==0&&(c=c.plus(Oe(L,l+2,k).times(i+""))),c=T(c,new L(b),l,1),t==null)if(Ne(c.d,l-P,V,u))L.precision=l+=P,a=s=y=T(m.minus(1),m.plus(1),l,1),p=h(y.times(y),l,1),o=u=1;else return h(c,L.precision=k,V,x=!0);else return L.precision=k,c;c=a,o+=2}}function Ht(e){return String(e.s*e.s/0)}function lt(e,t){var n,r,o;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;r++);for(o=t.length;t.charCodeAt(o-1)===48;--o);if(t=t.slice(r,o),t){if(o-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%w,n<0&&(r+=w),r<o){for(r&&e.d.push(+t.slice(0,r)),o-=w;r<o;)e.d.push(+t.slice(r,r+=w));t=t.slice(r),r=w-t.length}else r-=o;for(;r--;)t+="0";e.d.push(+t),x&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Zn(e,t){var n,r,o,i,s,u,c,a,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),jt.test(t))return lt(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(Vn.test(t))n=16,t=t.toLowerCase();else if(Mn.test(t))n=2;else if(Fn.test(t))n=8;else throw Error(oe+t);for(i=t.search(/p/i),i>0?(c=+t.slice(i+1),t=t.substring(2,i)):t=t.slice(2),i=t.indexOf("."),s=i>=0,r=e.constructor,s&&(t=t.replace(".",""),u=t.length,i=u-i,o=Zt(r,new r(n),i,i*2)),a=ve(t,n,H),l=a.length-1,i=l;a[i]===0;--i)a.pop();return i<0?new r(e.s*0):(e.e=qe(a,l),e.d=a,x=!1,s&&(e=T(e,o,u*4)),c&&(e=e.times(Math.abs(c)<54?v(2,c):Ve.pow(2,c))),x=!0,e)}function Gn(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:we(e,2,t,t);n=1.4*Math.sqrt(r),n=n>16?16:n|0,t=t.times(1/Me(5,n)),t=we(e,2,t,t);for(var o,i=new e(5),s=new e(16),u=new e(20);n--;)o=t.times(t),t=t.times(i.plus(o.times(s.times(o).minus(u))));return t}function we(e,t,n,r,o){var i,s,u,c,a=1,l=e.precision,m=Math.ceil(l/w);for(x=!1,c=n.times(n),u=new e(r);;){if(s=T(u.times(c),new e(t++*t++),l,1),u=o?r.plus(s):r.minus(s),r=T(s.times(c),new e(t++*t++),l,1),s=u.plus(r),s.d[m]!==void 0){for(i=m;s.d[i]===u.d[i]&&i--;);if(i==-1)break}i=u,u=r,r=s,s=i,a++}return x=!0,s.d.length=m+1,s}function Me(e,t){for(var n=e;--t;)n*=e;return n}function Qt(e,t){var n,r=t.s<0,o=G(e,e.precision,1),i=o.times(.5);if(t=t.abs(),t.lte(i))return J=r?4:1,t;if(n=t.divToInt(o),n.isZero())J=r?3:2;else{if(t=t.minus(n.times(o)),t.lte(i))return J=Ot(n)?r?2:3:r?4:1,t;J=Ot(n)?r?1:4:r?3:2}return t.minus(o).abs()}function mt(e,t,n,r){var o,i,s,u,c,a,l,m,p,b=e.constructor,P=n!==void 0;if(P?(U(n,1,se),r===void 0?r=b.rounding:U(r,0,8)):(n=b.precision,r=b.rounding),!e.isFinite())l=Ht(e);else{for(l=Q(e),s=l.indexOf("."),P?(o=2,t==16?n=n*4-3:t==8&&(n=n*3-2)):o=t,s>=0&&(l=l.replace(".",""),p=new b(1),p.e=l.length-s,p.d=ve(Q(p),10,o),p.e=p.d.length),m=ve(l,10,o),i=c=m.length;m[--c]==0;)m.pop();if(!m[0])l=P?"0p+0":"0";else{if(s<0?i--:(e=new b(e),e.d=m,e.e=i,e=T(e,p,n,r,0,o),m=e.d,i=e.e,a=Mt),s=m[n],u=o/2,a=a||m[n+1]!==void 0,a=r<4?(s!==void 0||a)&&(r===0||r===(e.s<0?3:2)):s>u||s===u&&(r===4||a||r===6&&m[n-1]&1||r===(e.s<0?8:7)),m.length=n,a)for(;++m[--n]>o-1;)m[n]=0,n||(++i,m.unshift(1));for(c=m.length;!m[c-1];--c);for(s=0,l="";s<c;s++)l+=st.charAt(m[s]);if(P){if(c>1)if(t==16||t==8){for(s=t==16?4:3,--c;c%s;c++)l+="0";for(m=ve(l,o,t),c=m.length;!m[c-1];--c);for(s=1,l="1.";s<c;s++)l+=st.charAt(m[s])}else l=l.charAt(0)+"."+l.slice(1);l=l+(i<0?"p":"p+")+i}else if(i<0){for(;++i;)l="0"+l;l="0."+l}else if(++i>c)for(i-=c;i--;)l+="0";else i<c&&(l=l.slice(0,i)+"."+l.slice(i))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return e.s<0?"-"+l:l}function Rt(e,t){if(e.length>t)return e.length=t,!0}function Hn(e){return new this(e).abs()}function Qn(e){return new this(e).acos()}function zn(e){return new this(e).acosh()}function Xn(e,t){return new this(e).plus(t)}function $n(e){return new this(e).asin()}function Jn(e){return new this(e).asinh()}function er(e){return new this(e).atan()}function tr(e){return new this(e).atanh()}function nr(e,t){e=new this(e),t=new this(t);var n,r=this.precision,o=this.rounding,i=r+4;return!e.s||!t.s?n=new this(NaN):!e.d&&!t.d?(n=G(this,i,1).times(t.s>0?.25:.75),n.s=e.s):!t.d||e.isZero()?(n=t.s<0?G(this,r,o):new this(0),n.s=e.s):!e.d||t.isZero()?(n=G(this,i,1).times(.5),n.s=e.s):t.s<0?(this.precision=i,this.rounding=1,n=this.atan(T(e,t,i,1)),t=G(this,i,1),this.precision=r,this.rounding=o,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(T(e,t,i,1)),n}function rr(e){return new this(e).cbrt()}function ir(e){return h(e=new this(e),e.e+1,2)}function or(e,t,n){return new this(e).clamp(t,n)}function sr(e){if(!e||typeof e!="object")throw Error(Re+"Object expected");var t,n,r,o=e.defaults===!0,i=["precision",1,se,"rounding",0,8,"toExpNeg",-he,0,"toExpPos",0,he,"maxE",0,he,"minE",-he,0,"modulo",0,9];for(t=0;t<i.length;t+=3)if(n=i[t],o&&(this[n]=ut[n]),(r=e[n])!==void 0)if(M(r)===r&&r>=i[t+1]&&r<=i[t+2])this[n]=r;else throw Error(oe+n+": "+r);if(n="crypto",o&&(this[n]=ut[n]),(r=e[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(Ft);else this[n]=!1;else throw Error(oe+n+": "+r);return this}function ur(e){return new this(e).cos()}function ar(e){return new this(e).cosh()}function zt(e){var t,n,r;function o(i){var s,u,c,a=this;if(!(a instanceof o))return new o(i);if(a.constructor=o,qt(i)){a.s=i.s,x?!i.d||i.e>o.maxE?(a.e=NaN,a.d=null):i.e<o.minE?(a.e=0,a.d=[0]):(a.e=i.e,a.d=i.d.slice()):(a.e=i.e,a.d=i.d?i.d.slice():i.d);return}if(c=typeof i,c==="number"){if(i===0){a.s=1/i<0?-1:1,a.e=0,a.d=[0];return}if(i<0?(i=-i,a.s=-1):a.s=1,i===~~i&&i<1e7){for(s=0,u=i;u>=10;u/=10)s++;x?s>o.maxE?(a.e=NaN,a.d=null):s<o.minE?(a.e=0,a.d=[0]):(a.e=s,a.d=[i]):(a.e=s,a.d=[i]);return}else if(i*0!==0){i||(a.s=NaN),a.e=NaN,a.d=null;return}return lt(a,i.toString())}else if(c!=="string")throw Error(oe+i);return(u=i.charCodeAt(0))===45?(i=i.slice(1),a.s=-1):(u===43&&(i=i.slice(1)),a.s=1),jt.test(i)?lt(a,i):Zn(a,i)}if(o.prototype=d,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.EUCLID=9,o.config=o.set=sr,o.clone=zt,o.isDecimal=qt,o.abs=Hn,o.acos=Qn,o.acosh=zn,o.add=Xn,o.asin=$n,o.asinh=Jn,o.atan=er,o.atanh=tr,o.atan2=nr,o.cbrt=rr,o.ceil=ir,o.clamp=or,o.cos=ur,o.cosh=ar,o.div=cr,o.exp=lr,o.floor=mr,o.hypot=pr,o.ln=fr,o.log=dr,o.log10=br,o.log2=gr,o.max=yr,o.min=hr,o.mod=wr,o.mul=Pr,o.pow=xr,o.random=kr,o.round=Sr,o.sign=Nr,o.sin=Lr,o.sinh=Tr,o.sqrt=Br,o.sub=Ar,o.sum=Ir,o.tan=Er,o.tanh=_r,o.trunc=Cr,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return o.config(e),o}function cr(e,t){return new this(e).div(t)}function lr(e){return new this(e).exp()}function mr(e){return h(e=new this(e),e.e+1,3)}function pr(){var e,t,n=new this(0);for(x=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return x=!0,new this(1/0);n=t}return x=!0,n.sqrt()}function qt(e){return e instanceof Ve||e&&e.toStringTag===Ut||!1}function fr(e){return new this(e).ln()}function dr(e,t){return new this(e).log(t)}function gr(e){return new this(e).log(2)}function br(e){return new this(e).log(10)}function yr(){return Gt(this,arguments,"lt")}function hr(){return Gt(this,arguments,"gt")}function wr(e,t){return new this(e).mod(t)}function Pr(e,t){return new this(e).mul(t)}function xr(e,t){return new this(e).pow(t)}function kr(e){var t,n,r,o,i=0,s=new this(1),u=[];if(e===void 0?e=this.precision:U(e,1,se),r=Math.ceil(e/w),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));i<r;)o=t[i],o>=429e7?t[i]=crypto.getRandomValues(new Uint32Array(1))[0]:u[i++]=o%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);i<r;)o=t[i]+(t[i+1]<<8)+(t[i+2]<<16)+((t[i+3]&127)<<24),o>=214e7?crypto.randomBytes(4).copy(t,i):(u.push(o%1e7),i+=4);i=r/4}else throw Error(Ft);else for(;i<r;)u[i++]=Math.random()*1e7|0;for(r=u[--i],e%=w,r&&e&&(o=v(10,w-e),u[i]=(r/o|0)*o);u[i]===0;i--)u.pop();if(i<0)n=0,u=[0];else{for(n=-1;u[0]===0;n-=w)u.shift();for(r=1,o=u[0];o>=10;o/=10)r++;r<w&&(n-=w-r)}return s.e=n,s.d=u,s}function Sr(e){return h(e=new this(e),e.e+1,this.rounding)}function Nr(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function Lr(e){return new this(e).sin()}function Tr(e){return new this(e).sinh()}function Br(e){return new this(e).sqrt()}function Ar(e,t){return new this(e).sub(t)}function Ir(){var e=0,t=arguments,n=new this(t[e]);for(x=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return x=!0,h(n,this.precision,this.rounding)}function Er(e){return new this(e).tan()}function _r(e){return new this(e).tanh()}function Cr(e){return h(e=new this(e),e.e+1,1)}d[Symbol.for("nodejs.util.inspect.custom")]=d.toString;d[Symbol.toStringTag]="Decimal";var Ve=d.constructor=zt(ut);We=new Ve(We);De=new Ve(De);import{PublicKey as ft}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Kr}from"@solana/spl-token";import{PublicKey as _,SystemProgram as $t,SYSVAR_RENT_PUBKEY as vr}from"@solana/web3.js";function f({pubkey:e,isSigner:t=!1,isWritable:n=!0}){return{pubkey:e,isWritable:n,isSigner:t}}var Jo=[f({pubkey:Kr,isWritable:!1}),f({pubkey:$t.programId,isWritable:!1}),f({pubkey:vr,isWritable:!1})];function Jt({publicKey:e,transformSol:t}){let n=pt(e.toString());if(n instanceof _)return t&&n.equals(Le)?Xt:n;if(t&&n.toString()===Le.toBase58())return Xt;if(typeof n=="string"){if(n===_.default.toBase58())return _.default;try{return new _(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function pt(e){try{return new _(e)}catch{return e}}var es=new _("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ts=new _("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),en=new _("SysvarRent111111111111111111111111111111111"),ns=new _("SysvarC1ock11111111111111111111111111111111"),rs=new _("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),is=new _("Sysvar1nstructions1111111111111111111111111"),os=$t.programId,ss=new _("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),us=new _("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),as=new _("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),cs=new _("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),ls=new _("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),ms=new _("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),ps=new _("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),fs=new _("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),ds=new _("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),gs=new _("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),bs=new _("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Xt=new _("So11111111111111111111111111111111111111112"),Le=_.default;import{PublicKey as Wr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as tn}from"@solana/spl-token";var nn={chainId:101,address:Wr.default.toBase58(),programId:tn.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},me={chainId:101,address:"So11111111111111111111111111111111111111112",programId:tn.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var dt=class{constructor({mint:t,decimals:n,symbol:r,name:o,skipMint:i=!1,isToken2022:s=!1}){if(t===Le.toBase58()||t instanceof ft&&Le.equals(t)){this.decimals=me.decimals,this.symbol=me.symbol,this.name=me.name,this.mint=new ft(me.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||t.toString().substring(0,6),this.name=o||t.toString().substring(0,6),this.mint=i?ft.default:Jt({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},pe=dt;pe.WSOL=new dt({...me,mint:me.address});import Ue from"big.js";import Rr from"bn.js";import qr from"decimal.js-light";import Dr from"toformat";var Or=Dr,Te=Or;var Fe=F("module/fraction"),gt=Te(Ue),Be=Te(qr),Mr={[0]:Be.ROUND_DOWN,[1]:Be.ROUND_HALF_UP,[2]:Be.ROUND_UP},Vr={[0]:Ue.roundDown,[1]:Ue.roundHalfUp,[2]:Ue.roundUp},S=class{constructor(t,n=new Rr(1)){this.numerator=C(t),this.denominator=C(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new S(this.denominator,this.numerator)}add(t){let n=t instanceof S?t:new S(C(t));return this.denominator.eq(n.denominator)?new S(this.numerator.add(n.numerator),this.denominator):new S(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(t){let n=t instanceof S?t:new S(C(t));return this.denominator.eq(n.denominator)?new S(this.numerator.sub(n.numerator),this.denominator):new S(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(t){let n=t instanceof S?t:new S(C(t));return new S(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(t){let n=t instanceof S?t:new S(C(t));return new S(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(t,n={groupSeparator:""},r=1){Number.isInteger(t)||Fe.logWithError(`${t} is not an integer.`),t<=0&&Fe.logWithError(`${t} is not positive.`),Be.set({precision:t+1,rounding:Mr[r]});let o=new Be(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return o.toFormat(o.decimalPlaces(),n)}toFixed(t,n={groupSeparator:""},r=1){return Number.isInteger(t)||Fe.logWithError(`${t} is not an integer.`),t<0&&Fe.logWithError(`${t} is negative.`),gt.DP=t,gt.RM=Vr[r]||1,new gt(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,n)}isZero(){return this.numerator.isZero()}};var Ur=F("Raydium_price"),ee=class extends S{constructor(n){let{baseToken:r,quoteToken:o,numerator:i,denominator:s}=n;super(i,s);this.baseToken=r,this.quoteToken=o,this.scalar=new S(bt(r.decimals),bt(o.decimals))}get raw(){return new S(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new ee({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(n){this.quoteToken!==n.baseToken&&Ur.logWithError("mul token not equals");let r=super.mul(n);return new ee({baseToken:this.baseToken,quoteToken:n.quoteToken,denominator:r.denominator,numerator:r.numerator})}toSignificant(n=this.quoteToken.decimals,r,o){return this.adjusted.toSignificant(n,r,o)}toFixed(n=this.quoteToken.decimals,r,o){return this.adjusted.toFixed(n,r,o)}};var yt=class{constructor({decimals:t,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=t,this.symbol=n,this.name=r}equals(t){return this===t}},je=yt;je.SOL=new yt(nn);import jr from"big.js";import Ye from"bn.js";var Yr=F("Raydium_amount"),rn=Te(jr);function Zr(e,t){let n="0",r="0";if(e.includes(".")){let o=e.split(".");o.length===2?([n,r]=o,r=r.padEnd(t,"0")):Yr.logWithError(`invalid number string, num: ${e}`)}else n=e;return[n,r.slice(0,t)||r]}var te=class extends S{constructor(n,r,o=!0,i){let s=new Ye(0),u=ht.pow(new Ye(n.decimals));if(o)s=C(r);else{let c=new Ye(0),a=new Ye(0);if(typeof r=="string"||typeof r=="number"||typeof r=="bigint"){let[l,m]=Zr(r.toString(),n.decimals);c=C(l),a=C(m)}c=c.mul(u),s=c.add(a)}super(s,u);this.logger=F(i||"TokenAmount"),this.token=n}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(n){return this.token.equals(n.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(n.raw)}lt(n){return this.token.equals(n.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(n.raw)}add(n){return this.token.equals(n.token)||this.logger.logWithError("add token not equals"),new te(this.token,this.raw.add(n.raw))}subtract(n){return this.token.equals(n.token)||this.logger.logWithError("sub token not equals"),new te(this.token,this.raw.sub(n.raw))}toSignificant(n=this.token.decimals,r,o=0){return super.toSignificant(n,r,o)}toFixed(n=this.token.decimals,r,o=0){return n>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(n,r,o)}toExact(n={groupSeparator:""}){return rn.DP=this.token.decimals,new rn(this.numerator.toString()).div(this.denominator.toString()).toFormat(n)}};import Gr from"bn.js";var on=new S(new Gr(100)),Pe=class extends S{toSignificant(t=5,n,r){return this.mul(on).toSignificant(t,n,r)}toFixed(t=2,n,r){return this.mul(on).toFixed(t,n,r)}};import{PublicKey as Hr}from"@solana/web3.js";import Qr from"bn.js";function sn(e){return typeof e=="object"&&e!==null&&![pe,te,Hr,S,Qr,ee,Pe].some(t=>typeof t=="object"&&e instanceof t)}function fe(e){return typeof e=="string"?pt(e):Array.isArray(e)?e.map(t=>fe(t)):sn(e)?Object.fromEntries(Object.entries(e).map(([t,n])=>[t,fe(n)])):e}var wt=new j(0),an=new j(1),Ou=new j(2),Ru=new j(3),qu=new j(5),ht=new j(10),Mu=new j(100),Vu=new j(1e3),Fu=new j(1e4),un=9007199254740991;function C(e){let t=F("Raydium_parseBigNumberish");if(e instanceof j)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new j(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=un||e<=-un)&&t.logWithError(`BigNumberish number overflow: ${e}`),new j(String(e))):typeof e=="bigint"?new j(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new j(0))}function bt(e){return ht.pow(C(e))}var cn=F("Raydium_liquidity_instruction");function ea(e){let{poolInfo:t,poolKeys:n,userKeys:r,baseAmountIn:o,quoteAmountIn:i,fixedSide:s}=e,u=Buffer.alloc(et.span);et.encode({instruction:3,baseAmountIn:C(o),quoteAmountIn:C(i),fixedSide:s==="base"?wt:an},u);let c=[f({pubkey:Ae,isWritable:!1}),f({pubkey:new N(t.id)}),f({pubkey:new N(n.authority),isWritable:!1}),f({pubkey:new N(n.openOrders),isWritable:!1}),f({pubkey:new N(n.targetOrders)}),f({pubkey:new N(t.lpMint.address)}),f({pubkey:new N(n.vault.A)}),f({pubkey:new N(n.vault.B)})];return t.pooltype.includes("StablePool")&&c.push(f({pubkey:ye})),c.push(f({pubkey:new N(t.marketId),isWritable:!1}),f({pubkey:r.baseTokenAccount}),f({pubkey:r.quoteTokenAccount}),f({pubkey:r.lpTokenAccount}),f({pubkey:r.owner,isWritable:!1,isSigner:!0}),f({pubkey:new N(n.marketEventQueue),isWritable:!1})),new ne({programId:new N(t.programId),keys:c,data:u})}function ta(e){let{poolInfo:t,poolKeys:n,userKeys:r,amountIn:o}=e,i=fe(n),s=4;if(t.pooltype.includes("StablePool")&&(s=5),s===4||s===5){let u=Buffer.alloc(tt.span);tt.encode({instruction:4,amountIn:C(o)},u);let c=[f({pubkey:Ae,isWritable:!1}),f({pubkey:i.id}),f({pubkey:i.authority,isWritable:!1}),f({pubkey:i.openOrders}),f({pubkey:i.targetOrders}),f({pubkey:i.mintLp.address}),f({pubkey:i.vault.A}),f({pubkey:i.vault.B})];return s===5?c.push(f({pubkey:ye})):(c.push(f({pubkey:i.id})),c.push(f({pubkey:i.id}))),c.push(f({pubkey:i.marketProgramId,isWritable:!1}),f({pubkey:i.marketId}),f({pubkey:i.marketBaseVault}),f({pubkey:i.marketQuoteVault}),f({pubkey:i.marketAuthority,isWritable:!1}),f({pubkey:r.lpTokenAccount}),f({pubkey:r.baseTokenAccount}),f({pubkey:r.quoteTokenAccount}),f({pubkey:r.owner,isWritable:!1,isSigner:!0}),f({pubkey:i.marketEventQueue}),f({pubkey:i.marketBids}),f({pubkey:i.marketAsks})),new ne({programId:i.programId,keys:c,data:u})}return new ne({programId:i.programId,keys:[]})}function na({programId:e,ammId:t,ammAuthority:n,ammOpenOrders:r,lpMint:o,coinMint:i,pcMint:s,coinVault:u,pcVault:c,withdrawQueue:a,ammTargetOrders:l,poolTempLp:m,marketProgramId:p,marketId:b,userWallet:P,userCoinVault:y,userPcVault:K,userLpVault:L,nonce:V,openTime:k,coinAmount:W,pcAmount:ge,ammConfigId:Y,feeDestinationId:xe}){let ue=D([q("instruction"),q("nonce"),g("openTime"),g("pcAmount"),g("coinAmount")]),ae=[{pubkey:Ae,isSigner:!1,isWritable:!1},{pubkey:zr,isSigner:!1,isWritable:!1},{pubkey:Pt.programId,isSigner:!1,isWritable:!1},{pubkey:en,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:Y,isSigner:!1,isWritable:!1},{pubkey:xe,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:P,isSigner:!0,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:K,isSigner:!1,isWritable:!0},{pubkey:L,isSigner:!1,isWritable:!0}],be=Buffer.alloc(ue.span);return ue.encode({instruction:1,nonce:V,openTime:k,coinAmount:W,pcAmount:ge},be),{instruction:new ne({keys:ae,programId:e,data:be}),instructionType:rt.AmmV4CreatePool}}function ra(e){let t=D([q("instruction"),q("simulateType")]),n=Buffer.alloc(t.span);t.encode({instruction:12,simulateType:0},n);let r=[f({pubkey:new N(e.id),isWritable:!1}),f({pubkey:new N(e.authority),isWritable:!1}),f({pubkey:new N(e.openOrders),isWritable:!1}),f({pubkey:new N(e.vault.A),isWritable:!1}),f({pubkey:new N(e.vault.B),isWritable:!1}),f({pubkey:new N(e.mintLp.address),isWritable:!1}),f({pubkey:new N(e.marketId),isWritable:!1}),f({pubkey:new N(e.marketEventQueue),isWritable:!1})];return new ne({programId:new N(e.programId),keys:r,data:n})}function $r({poolKeys:e,userKeys:t,amountIn:n,minAmountOut:r},o){let i=fe(e),s=Buffer.alloc(Xe.span);Xe.encode({instruction:9,amountIn:C(n),minAmountOut:C(r)},s);let u=[f({pubkey:Ae,isWritable:!1}),f({pubkey:i.id}),f({pubkey:i.authority,isWritable:!1}),f({pubkey:i.openOrders})];return o===4&&u.push(f({pubkey:i.targetOrders})),u.push(f({pubkey:i.vault.A}),f({pubkey:i.vault.B})),o===5&&u.push(f({pubkey:ye})),u.push(f({pubkey:i.marketProgramId,isWritable:!1}),f({pubkey:i.marketId}),f({pubkey:i.marketBids}),f({pubkey:i.marketAsks}),f({pubkey:i.marketEventQueue}),f({pubkey:i.marketBaseVault}),f({pubkey:i.marketQuoteVault}),f({pubkey:i.marketAuthority,isWritable:!1}),f({pubkey:t.tokenAccountIn}),f({pubkey:t.tokenAccountOut}),f({pubkey:t.owner,isWritable:!1})),new ne({programId:i.programId,keys:u,data:s})}function Jr({poolKeys:e,userKeys:t,maxAmountIn:n,amountOut:r},o){let i=fe(e),s=Buffer.alloc($e.span);$e.encode({instruction:11,maxAmountIn:C(n),amountOut:C(r)},s);let u=[f({pubkey:Pt.programId,isWritable:!1}),f({pubkey:i.id}),f({pubkey:i.authority,isWritable:!1}),f({pubkey:i.openOrders}),f({pubkey:i.targetOrders}),f({pubkey:i.vault.A}),f({pubkey:i.vault.B})];return o===5&&u.push(f({pubkey:ye})),u.push(f({pubkey:i.marketProgramId,isWritable:!1}),f({pubkey:i.marketId}),f({pubkey:i.marketBids}),f({pubkey:i.marketAsks}),f({pubkey:i.marketEventQueue}),f({pubkey:i.marketBaseVault}),f({pubkey:i.marketQuoteVault}),f({pubkey:i.marketAuthority,isWritable:!1}),f({pubkey:t.tokenAccountIn}),f({pubkey:t.tokenAccountOut}),f({pubkey:t.owner,isWritable:!1,isSigner:!0})),new ne({programId:i.programId,keys:u,data:s})}function ia(e){let{poolKeys:t,version:n,userKeys:r,amountIn:o,amountOut:i,fixedSide:s}=e;if(n===4||n===5){let u={poolKeys:t,userKeys:r};if(s==="in")return $r({...u,amountIn:o,minAmountOut:i},n);if(s==="out")return Jr({...u,maxAmountIn:o,amountOut:i},n);cn.logWithError("invalid params","params",e)}throw cn.logWithError("invalid version","poolKeys.version",n),new Error("invalid version")}function oa({poolKeys:e,userKeys:t,startTime:n}){let r=Buffer.alloc(Je.span);Je.encode({instruction:0,nonce:5,startTime:C(n)},r);let o=fe(e),i=[f({pubkey:Ae,isWritable:!1}),f({pubkey:Pt.programId,isWritable:!1}),f({pubkey:Xr,isWritable:!1}),f({pubkey:o.id}),f({pubkey:o.authority,isWritable:!1}),f({pubkey:o.openOrders}),f({pubkey:o.mintLp.address}),f({pubkey:o.mintA.address,isWritable:!1}),f({pubkey:o.mintB.address,isWritable:!1}),f({pubkey:o.vault.A,isWritable:!1}),f({pubkey:o.vault.B,isWritable:!1}),f({pubkey:o.id}),f({pubkey:o.targetOrders}),f({pubkey:t.lpTokenAccount}),f({pubkey:o.id,isWritable:!1}),f({pubkey:o.marketProgramId,isWritable:!1}),f({pubkey:o.marketId,isWritable:!1}),f({pubkey:t.payer,isSigner:!0})];return new ne({programId:o.programId,keys:i,data:r})}function ln({poolKeys:e}){let t=D([q("instruction"),q("simulateType")]),n=Buffer.alloc(t.span);t.encode({instruction:12,simulateType:0},n);let r=[f({pubkey:new N(e.id),isWritable:!1}),f({pubkey:new N(e.authority),isWritable:!1}),f({pubkey:new N(e.openOrders),isWritable:!1}),f({pubkey:new N(e.vault.A),isWritable:!1}),f({pubkey:new N(e.vault.B),isWritable:!1}),f({pubkey:new N(e.mintLp.address),isWritable:!1}),f({pubkey:new N(e.marketId),isWritable:!1}),f({pubkey:new N(e.marketEventQueue),isWritable:!1})];return{instruction:new ne({programId:new N(e.programId),keys:r,data:n})}}import Ie from"bn.js";function ti({programId:e}){let{publicKey:t}=Se([Buffer.from("amm_config_account_seed","utf-8")],e);return t}function de({name:e,programId:t,marketId:n}){let{publicKey:r}=Se([t.toBuffer(),n.toBuffer(),Buffer.from(e,"utf-8")],t);return r}function ni({programId:e,marketId:t}){let{publicKey:n}=Se([e.toBuffer(),t.toBuffer(),Buffer.from("open_order_associated_seed","utf-8")],e);return n}function ri({programId:e}){return Se([Buffer.from([97,109,109,32,97,117,116,104,111,114,105,116,121])],e)}function da({version:e,marketVersion:t,marketId:n,baseMint:r,quoteMint:o,baseDecimals:i,quoteDecimals:s,programId:u,marketProgramId:c}){let a=de({name:"amm_associated_seed",programId:u,marketId:n}),l=de({name:"lp_mint_associated_seed",programId:u,marketId:n}),{publicKey:m,nonce:p}=ri({programId:u}),b=de({name:"coin_vault_associated_seed",programId:u,marketId:n}),P=de({name:"pc_vault_associated_seed",programId:u,marketId:n}),y=de({name:"temp_lp_token_associated_seed",programId:u,marketId:n}),K=ni({programId:u,marketId:n}),L=de({name:"target_associated_seed",programId:u,marketId:n}),V=de({name:"withdraw_associated_seed",programId:u,marketId:n}),{publicKey:k}=vt({programId:c,marketId:n});return{id:a,baseMint:r,quoteMint:o,lpMint:l,baseDecimals:i,quoteDecimals:s,lpDecimals:i,version:e,programId:u,authority:m,nonce:p,baseVault:b,quoteVault:P,lpVault:y,openOrders:K,targetOrders:L,withdrawQueue:V,marketVersion:t,marketProgramId:c,marketId:n,marketAuthority:k,lookupTableAccount:ei.default,configId:ti({programId:u})}}var xt;async function ga({connection:e,poolKeysList:t,config:n}){xt||(xt=new Ke({connection:e}),await xt.initStableModelLayout());let r=t.map(s=>ln({poolKeys:s}));return(await Ct(e,r.map(s=>s.instruction),"GetPoolData")).map(s=>{let u=Kt(s,"GetPoolData"),c=new Ie($(u,"status")),a=Number($(u,"coin_decimals")),l=Number($(u,"pc_decimals")),m=Number($(u,"lp_decimals")),p=new Ie($(u,"pool_coin_amount")),b=new Ie($(u,"pool_pc_amount")),P=new Ie($(u,"pool_lp_supply")),y="0";try{y=$(u,"pool_open_time")}catch{}return{status:c,baseDecimals:a,quoteDecimals:l,lpDecimals:m,baseReserve:p,quoteReserve:b,lpSupply:P,startTime:new Ie(y)}})}export{In as DataElement,si as LIQUIDITY_FEES_DENOMINATOR,oi as LIQUIDITY_FEES_NUMERATOR,mn as LIQUIDITY_VERSION_TO_SERUM_VERSION,bo as LIQUIDITY_VERSION_TO_STATE_LAYOUT,ye as MODEL_DATA_PUBKEY,Ke as StableLayout,et as addLiquidityLayout,yo as createPoolFeeLayout,na as createPoolV4InstructionV2,go as createPoolV4Layout,ga as fetchMultipleInfo,Xe as fixedSwapInLayout,$e as fixedSwapOutLayout,qn as formatLayout,ti as getAssociatedConfigId,ni as getAssociatedOpenOrders,da as getAssociatedPoolKeys,Zo as getDxByDyBaseIn,Yo as getDyByDxBaseIn,ri as getLiquidityAssociatedAuthority,de as getLiquidityAssociatedId,Go as getStablePrice,Je as initPoolLayout,hn as liquidityStateV4Layout,wn as liquidityStateV5Layout,ia as makeAMMSwapInstruction,ea as makeAddLiquidityInstruction,oa as makeInitPoolInstructionV4,ln as makeSimulatePoolInfoInstruction,$r as makeSwapFixedInInstruction,Jr as makeSwapFixedOutInstruction,En as modelDataInfoLayout,ta as removeLiquidityInstruction,tt as removeLiquidityLayout,ra as simulatePoolInfoInstruction};
/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */
//# sourceMappingURL=index.mjs.map