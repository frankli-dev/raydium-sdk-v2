import{PublicKey as Be}from"@solana/web3.js";import{get as xt,set as an}from"lodash";import kt from"dayjs";import un from"dayjs/plugin/utc";kt.extend(un);var ze=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return kt().utc().format("YYYY/MM/DD HH:mm:ss UTC")}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let n=t.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},At={},cn={};function W(e){let t=xt(At,e);if(!t){let n=xt(cn,e);t=new ze({name:e,logLevel:n}),an(At,e,t)}return t}import{PublicKey as Te,sendAndConfirmTransaction as dt,Transaction as Pe,TransactionMessage as xe,VersionedTransaction as Ae}from"@solana/web3.js";import Nr from"axios";var Ye={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut"};import{PublicKey as Gr,ComputeBudgetProgram as St,Transaction as It,TransactionMessage as ln,Keypair as Ct,VersionedTransaction as Lt}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as fn}from"@solana/spl-token";var Bt=W("Raydium_txUtil"),Nt=1644;function Ie(e){let t=[],n=[];return e.microLamports&&(t.push(St.setComputeUnitPrice({microLamports:e.microLamports})),n.push(Ye.SetComputeUnitPrice)),e.units&&(t.push(St.setComputeUnitLimit({units:e.units})),n.push(Ye.SetComputeUnitLimit)),{instructions:t,instructionTypes:n}}async function ue(e){var t,n;try{return((n=await((t=e.getLatestBlockhash)==null?void 0:t.call(e)))==null?void 0:n.blockhash)||(await e.getRecentBlockhash()).blockhash}catch{return(await e.getRecentBlockhash()).blockhash}}function pn(e,t){e.length<1&&Bt.logWithError(`no instructions provided: ${e.toString()}`),t.length<1&&Bt.logWithError(`no signers provided:, ${t.toString()}`);let n=new It;n.recentBlockhash="11111111111111111111111111111111",n.feePayer=t[0],n.add(...e);try{return Buffer.from(n.serialize({verifySignatures:!1})).toString("base64").length<Nt}catch{return!1}}function pe({instructions:e,payer:t,signers:n}){return pn(e,[t,...n])}function de({instructions:e,payer:t,lookupTableAddressAccount:n,recentBlockhash:r=Ct.generate().publicKey.toString()}){let o=new ln({payerKey:t,recentBlockhash:r,instructions:e}).compileToV0Message(Object.values(n!=null?n:{}));try{return Buffer.from(new Lt(o).serialize()).toString("base64").length<Nt}catch{return!1}}var dn=e=>Buffer.isBuffer(e)?e:e instanceof Uint8Array?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e);function ie(e){let t=[];return e.forEach(n=>{n instanceof It&&(n.recentBlockhash||(n.recentBlockhash=fn.toBase58()),n.feePayer||(n.feePayer=Ct.generate().publicKey));let r=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof Lt&&(r=dn(r));let i=r.toString("base64");t.push(i)}),console.log("simulate tx string:",t),t}import{PublicKey as tn,AddressLookupTableAccount as We}from"@solana/web3.js";import{PublicKey as Lr}from"@solana/web3.js";import{getTransferFeeConfig as zs,unpackMint as Ys}from"@solana/spl-token";import{PublicKey as Ar}from"@solana/web3.js";import kr from"bn.js";import Tr from"big.js";import Fe from"bn.js";import G from"bn.js";var ce=9e15,ne=1e9,Ze="0123456789abcdef",Le="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Ne="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Qe={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-ce,maxE:ce,crypto:!1},Rt,Q,k=!0,Ee="[DecimalError] ",te=Ee+"Invalid argument: ",_t=Ee+"Precision limit exceeded",Ot=Ee+"crypto unavailable",vt="[object Decimal]",F=Math.floor,O=Math.pow,mn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,gn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,hn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Kt=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,z=1e7,x=7,bn=9007199254740991,yn=Le.length-1,Xe=Ne.length-1,d={toStringTag:vt};d.absoluteValue=d.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),P(e)};d.ceil=function(){return P(new this.constructor(this),this.e+1,2)};d.clampedTo=d.clamp=function(e,t){var n,r=this,i=r.constructor;if(e=new i(e),t=new i(t),!e.s||!t.s)return new i(NaN);if(e.gt(t))throw Error(te+t);return n=r.cmp(e),n<0?e:r.cmp(t)>0?t:new i(r)};d.comparedTo=d.cmp=function(e){var t,n,r,i,o=this,s=o.d,a=(e=new o.constructor(e)).d,c=o.s,u=e.s;if(!s||!a)return!c||!u?NaN:c!==u?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-u:0;if(c!==u)return c;if(o.e!==e.e)return o.e>e.e^c<0?1:-1;for(r=s.length,i=a.length,t=0,n=r<i?r:i;t<n;++t)if(s[t]!==a[t])return s[t]>a[t]^c<0?1:-1;return r===i?0:r>i^c<0?1:-1};d.cosine=d.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+x,r.rounding=1,n=wn(r,Ut(r,n)),r.precision=e,r.rounding=t,P(Q==2||Q==3?n.neg():n,e,t,!0)):new r(1):new r(NaN)};d.cubeRoot=d.cbrt=function(){var e,t,n,r,i,o,s,a,c,u,l=this,f=l.constructor;if(!l.isFinite()||l.isZero())return new f(l);for(k=!1,o=l.s*O(l.s*l,1/3),!o||Math.abs(o)==1/0?(n=v(l.d),e=l.e,(o=(e-n.length+1)%3)&&(n+=o==1||o==-2?"0":"00"),o=O(n,1/3),e=F((e+1)/3)-(e%3==(e<0?-1:2)),o==1/0?n="5e"+e:(n=o.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),r=new f(n),r.s=l.s):r=new f(o.toString()),s=(e=f.precision)+3;;)if(a=r,c=a.times(a).times(a),u=c.plus(l),r=L(u.plus(l).times(a),u.plus(c),s+2,1),v(a.d).slice(0,s)===(n=v(r.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!i&&n=="4999"){if(!i&&(P(a,e+1,0),a.times(a).times(a).eq(l))){r=a;break}s+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(P(r,e+1,1),t=!r.times(r).times(r).eq(l));break}return k=!0,P(r,e,f.rounding,t)};d.decimalPlaces=d.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-F(this.e/x))*x,e=t[e],e)for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n};d.dividedBy=d.div=function(e){return L(this,new this.constructor(e))};d.dividedToIntegerBy=d.divToInt=function(e){var t=this,n=t.constructor;return P(L(t,new n(e),0,1,1),n.precision,n.rounding)};d.equals=d.eq=function(e){return this.cmp(e)===0};d.floor=function(){return P(new this.constructor(this),this.e+1,3)};d.greaterThan=d.gt=function(e){return this.cmp(e)>0};d.greaterThanOrEqualTo=d.gte=function(e){var t=this.cmp(e);return t==1||t===0};d.hyperbolicCosine=d.cosh=function(){var e,t,n,r,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(e=Math.ceil(i/3),t=(1/Re(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),o=le(s,1,o.times(t),new s(1),!0);for(var c,u=e,l=new s(8);u--;)c=o.times(o),o=a.minus(c.times(l.minus(c.times(l))));return P(o,s.precision=n,s.rounding=r,!0)};d.hyperbolicSine=d.sinh=function(){var e,t,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(t=o.precision,n=o.rounding,o.precision=t+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=le(o,2,i,i,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,i=i.times(1/Re(5,e)),i=le(o,2,i,i,!0);for(var s,a=new o(5),c=new o(16),u=new o(20);e--;)s=i.times(i),i=i.times(a.plus(s.times(c.times(s).plus(u))))}return o.precision=t,o.rounding=n,P(i,t,n,!0)};d.hyperbolicTangent=d.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,L(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)};d.inverseCosine=d.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),i=n.precision,o=n.rounding;return r!==-1?r===0?t.isNeg()?j(n,i,o):new n(0):new n(NaN):t.isZero()?j(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,t=t.asin(),e=j(n,i+4,o).times(.5),n.precision=i,n.rounding=o,e.minus(t))};d.inverseHyperbolicCosine=d.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,k=!1,n=n.times(n).minus(1).sqrt().plus(n),k=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)};d.inverseHyperbolicSine=d.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,k=!1,n=n.times(n).plus(1).sqrt().plus(n),k=!0,r.precision=e,r.rounding=t,n.ln())};d.inverseHyperbolicTangent=d.atanh=function(){var e,t,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=o.precision,t=o.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?P(new o(i),e,t,!0):(o.precision=n=r-i.e,i=L(i.plus(1),new o(1).minus(i),n+e,1),o.precision=e+4,o.rounding=1,i=i.ln(),o.precision=e,o.rounding=t,i.times(.5))):new o(NaN)};d.inverseSine=d.asin=function(){var e,t,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(t=i.abs().cmp(1),n=o.precision,r=o.rounding,t!==-1?t===0?(e=j(o,n+4,r).times(.5),e.s=i.s,e):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))};d.inverseTangent=d.atan=function(){var e,t,n,r,i,o,s,a,c,u=this,l=u.constructor,f=l.precision,p=l.rounding;if(u.isFinite()){if(u.isZero())return new l(u);if(u.abs().eq(1)&&f+4<=Xe)return s=j(l,f+4,p).times(.25),s.s=u.s,s}else{if(!u.s)return new l(NaN);if(f+4<=Xe)return s=j(l,f+4,p).times(.5),s.s=u.s,s}for(l.precision=a=f+10,l.rounding=1,n=Math.min(28,a/x+2|0),e=n;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(k=!1,t=Math.ceil(a/x),r=1,c=u.times(u),s=new l(u),i=u;e!==-1;)if(i=i.times(c),o=s.minus(i.div(r+=2)),i=i.times(c),s=o.plus(i.div(r+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===o.d[e]&&e--;);return n&&(s=s.times(2<<n-1)),k=!0,P(s,l.precision=f,l.rounding=p,!0)};d.isFinite=function(){return!!this.d};d.isInteger=d.isInt=function(){return!!this.d&&F(this.e/x)>this.d.length-2};d.isNaN=function(){return!this.s};d.isNegative=d.isNeg=function(){return this.s<0};d.isPositive=d.isPos=function(){return this.s>0};d.isZero=function(){return!!this.d&&this.d[0]===0};d.lessThan=d.lt=function(e){return this.cmp(e)<0};d.lessThanOrEqualTo=d.lte=function(e){return this.cmp(e)<1};d.logarithm=d.log=function(e){var t,n,r,i,o,s,a,c,u=this,l=u.constructor,f=l.precision,p=l.rounding,g=5;if(e==null)e=new l(10),t=!0;else{if(e=new l(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(n=u.d,u.s<0||!n||!n[0]||u.eq(1))return new l(n&&!n[0]?-1/0:u.s!=1?NaN:n?0:1/0);if(t)if(n.length>1)o=!0;else{for(i=n[0];i%10===0;)i/=10;o=i!==1}if(k=!1,a=f+g,s=ee(u,a),r=t?De(l,a+10):ee(e,a),c=L(s,r,a,1),me(c.d,i=f,p))do if(a+=10,s=ee(u,a),r=t?De(l,a+10):ee(e,a),c=L(s,r,a,1),!o){+v(c.d).slice(i+1,i+15)+1==1e14&&(c=P(c,f+1,0));break}while(me(c.d,i+=10,p));return k=!0,P(c,f,p)};d.minus=d.sub=function(e){var t,n,r,i,o,s,a,c,u,l,f,p,g=this,w=g.constructor;if(e=new w(e),!g.d||!e.d)return!g.s||!e.s?e=new w(NaN):g.d?e.s=-e.s:e=new w(e.d||g.s!==e.s?g:NaN),e;if(g.s!=e.s)return e.s=-e.s,g.plus(e);if(u=g.d,p=e.d,a=w.precision,c=w.rounding,!u[0]||!p[0]){if(p[0])e.s=-e.s;else if(u[0])e=new w(g);else return new w(c===3?-0:0);return k?P(e,a,c):e}if(n=F(e.e/x),l=F(g.e/x),u=u.slice(),o=l-n,o){for(f=o<0,f?(t=u,o=-o,s=p.length):(t=p,n=l,s=u.length),r=Math.max(Math.ceil(a/x),s)+2,o>r&&(o=r,t.length=1),t.reverse(),r=o;r--;)t.push(0);t.reverse()}else{for(r=u.length,s=p.length,f=r<s,f&&(s=r),r=0;r<s;r++)if(u[r]!=p[r]){f=u[r]<p[r];break}o=0}for(f&&(t=u,u=p,p=t,e.s=-e.s),s=u.length,r=p.length-s;r>0;--r)u[s++]=0;for(r=p.length;r>o;){if(u[--r]<p[r]){for(i=r;i&&u[--i]===0;)u[i]=z-1;--u[i],u[r]+=z}u[r]-=p[r]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(e.d=u,e.e=Me(u,n),k?P(e,a,c):e):new w(c===3?-0:0)};d.modulo=d.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?P(new r(n),r.precision,r.rounding):(k=!1,r.modulo==9?(t=L(n,e.abs(),0,3,1),t.s*=e.s):t=L(n,e,0,r.modulo,1),t=t.times(e),k=!0,n.minus(t))};d.naturalExponential=d.exp=function(){return Je(this)};d.naturalLogarithm=d.ln=function(){return ee(this)};d.negated=d.neg=function(){var e=new this.constructor(this);return e.s=-e.s,P(e)};d.plus=d.add=function(e){var t,n,r,i,o,s,a,c,u,l,f=this,p=f.constructor;if(e=new p(e),!f.d||!e.d)return!f.s||!e.s?e=new p(NaN):f.d||(e=new p(e.d||f.s===e.s?f:NaN)),e;if(f.s!=e.s)return e.s=-e.s,f.minus(e);if(u=f.d,l=e.d,a=p.precision,c=p.rounding,!u[0]||!l[0])return l[0]||(e=new p(f)),k?P(e,a,c):e;if(o=F(f.e/x),r=F(e.e/x),u=u.slice(),i=o-r,i){for(i<0?(n=u,i=-i,s=l.length):(n=l,r=o,s=u.length),o=Math.ceil(a/x),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=u.length,i=l.length,s-i<0&&(i=s,n=l,l=u,u=n),t=0;i;)t=(u[--i]=u[i]+l[i]+t)/z|0,u[i]%=z;for(t&&(u.unshift(t),++r),s=u.length;u[--s]==0;)u.pop();return e.d=u,e.e=Me(u,r),k?P(e,a,c):e};d.precision=d.sd=function(e){var t,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(te+e);return n.d?(t=Ft(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t};d.round=function(){var e=this,t=e.constructor;return P(new t(e),e.e+1,t.rounding)};d.sine=d.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+x,r.rounding=1,n=Pn(r,Ut(r,n)),r.precision=e,r.rounding=t,P(Q>2?n.neg():n,e,t,!0)):new r(NaN)};d.squareRoot=d.sqrt=function(){var e,t,n,r,i,o,s=this,a=s.d,c=s.e,u=s.s,l=s.constructor;if(u!==1||!a||!a[0])return new l(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);for(k=!1,u=Math.sqrt(+s),u==0||u==1/0?(t=v(a),(t.length+c)%2==0&&(t+="0"),u=Math.sqrt(t),c=F((c+1)/2)-(c<0||c%2),u==1/0?t="5e"+c:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),r=new l(t)):r=new l(u.toString()),n=(c=l.precision)+3;;)if(o=r,r=o.plus(L(s,o,n+2,1)).times(.5),v(o.d).slice(0,n)===(t=v(r.d)).slice(0,n))if(t=t.slice(n-3,n+1),t=="9999"||!i&&t=="4999"){if(!i&&(P(o,c+1,0),o.times(o).eq(s))){r=o;break}n+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(P(r,c+1,1),e=!r.times(r).eq(s));break}return k=!0,P(r,c,l.rounding,e)};d.tangent=d.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,n=n.sin(),n.s=1,n=L(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,P(Q==2||Q==4?n.neg():n,e,t,!0)):new r(NaN)};d.times=d.mul=function(e){var t,n,r,i,o,s,a,c,u,l=this,f=l.constructor,p=l.d,g=(e=new f(e)).d;if(e.s*=l.s,!p||!p[0]||!g||!g[0])return new f(!e.s||p&&!p[0]&&!g||g&&!g[0]&&!p?NaN:!p||!g?e.s/0:e.s*0);for(n=F(l.e/x)+F(e.e/x),c=p.length,u=g.length,c<u&&(o=p,p=g,g=o,s=c,c=u,u=s),o=[],s=c+u,r=s;r--;)o.push(0);for(r=u;--r>=0;){for(t=0,i=c+r;i>r;)a=o[i]+g[r]*p[i-r-1]+t,o[i--]=a%z|0,t=a/z|0;o[i]=(o[i]+t)%z|0}for(;!o[--s];)o.pop();return t?++n:o.shift(),e.d=o,e.e=Me(o,n),k?P(e,f.precision,f.rounding):e};d.toBinary=function(e,t){return et(this,2,e,t)};d.toDecimalPlaces=d.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(U(e,0,ne),t===void 0?t=r.rounding:U(t,0,8),P(n,e+n.e+1,t))};d.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=Z(r,!0):(U(e,0,ne),t===void 0?t=i.rounding:U(t,0,8),r=P(new i(r),e+1,t),n=Z(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n};d.toFixed=function(e,t){var n,r,i=this,o=i.constructor;return e===void 0?n=Z(i):(U(e,0,ne),t===void 0?t=o.rounding:U(t,0,8),r=P(new o(i),e+i.e+1,t),n=Z(r,!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};d.toFraction=function(e){var t,n,r,i,o,s,a,c,u,l,f,p,g=this,w=g.d,m=g.constructor;if(!w)return new m(g);if(u=n=new m(1),r=c=new m(0),t=new m(r),o=t.e=Ft(w)-g.e-1,s=o%x,t.d[0]=O(10,s<0?x+s:s),e==null)e=o>0?t:u;else{if(a=new m(e),!a.isInt()||a.lt(u))throw Error(te+a);e=a.gt(t)?o>0?t:u:a}for(k=!1,a=new m(v(w)),l=m.precision,m.precision=o=w.length*x*2;f=L(a,t,0,1,1),i=n.plus(f.times(r)),i.cmp(e)!=1;)n=r,r=i,i=u,u=c.plus(f.times(i)),c=i,i=t,t=a.minus(f.times(i)),a=i;return i=L(e.minus(n),r,0,1,1),c=c.plus(i.times(u)),n=n.plus(i.times(r)),c.s=u.s=g.s,p=L(u,r,o,1).minus(g).abs().cmp(L(c,n,o,1).minus(g).abs())<1?[u,r]:[c,n],m.precision=l,k=!0,p};d.toHexadecimal=d.toHex=function(e,t){return et(this,16,e,t)};d.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),e==null){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:U(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(k=!1,n=L(n,e,0,t,1).times(e),k=!0,P(n)):(e.s=n.s,n=e),n};d.toNumber=function(){return+this};d.toOctal=function(e,t){return et(this,8,e,t)};d.toPower=d.pow=function(e){var t,n,r,i,o,s,a=this,c=a.constructor,u=+(e=new c(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new c(O(+a,u));if(a=new c(a),a.eq(1))return a;if(r=c.precision,o=c.rounding,e.eq(1))return P(a,r,o);if(t=F(e.e/x),t>=e.d.length-1&&(n=u<0?-u:u)<=bn)return i=Vt(c,a,n,r),e.s<0?new c(1).div(i):P(i,r,o);if(s=a.s,s<0){if(t<e.d.length-1)return new c(NaN);if((e.d[t]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return n=O(+a,u),t=n==0||!isFinite(n)?F(u*(Math.log("0."+v(a.d))/Math.LN10+a.e+1)):new c(n+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?s/0:0):(k=!1,c.rounding=a.s=1,n=Math.min(12,(t+"").length),i=Je(e.times(ee(a,r+n)),r),i.d&&(i=P(i,r+5,1),me(i.d,r,o)&&(t=r+10,i=P(Je(e.times(ee(a,t+n)),t),t+5,1),+v(i.d).slice(r+1,r+15)+1==1e14&&(i=P(i,r+1,0)))),i.s=s,k=!0,c.rounding=o,P(i,r,o))};d.toPrecision=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=Z(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(U(e,1,ne),t===void 0?t=i.rounding:U(t,0,8),r=P(new i(r),e,t),n=Z(r,e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n};d.toSignificantDigits=d.toSD=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(U(e,1,ne),t===void 0?t=r.rounding:U(t,0,8)),P(new r(n),e,t)};d.toString=function(){var e=this,t=e.constructor,n=Z(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n};d.truncated=d.trunc=function(){return P(new this.constructor(this),this.e+1,1)};d.valueOf=d.toJSON=function(){var e=this,t=e.constructor,n=Z(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function v(e){var t,n,r,i=e.length-1,o="",s=e[0];if(i>0){for(o+=s,t=1;t<i;t++)r=e[t]+"",n=x-r.length,n&&(o+=$(n)),o+=r;s=e[t],r=s+"",n=x-r.length,n&&(o+=$(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function U(e,t,n){if(e!==~~e||e<t||e>n)throw Error(te+e)}function me(e,t,n,r){var i,o,s,a;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=x,i=0):(i=Math.ceil((t+1)/x),t%=x),o=O(10,x-t),a=e[i]%o|0,r==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),s=n<4&&a==99999||n>3&&a==49999||a==5e4||a==0):s=(n<4&&a+1==o||n>3&&a+1==o/2)&&(e[i+1]/o/100|0)==O(10,t-2)-1||(a==o/2||a==0)&&(e[i+1]/o/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),s=(r||n<4)&&a==9999||!r&&n>3&&a==4999):s=((r||n<4)&&a+1==o||!r&&n>3&&a+1==o/2)&&(e[i+1]/o/1e3|0)==O(10,t-3)-1,s}function Ce(e,t,n){for(var r,i=[0],o,s=0,a=e.length;s<a;){for(o=i.length;o--;)i[o]*=t;for(i[0]+=Ze.indexOf(e.charAt(s++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function wn(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?(n=Math.ceil(r/3),i=(1/Re(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),e.precision+=n,t=le(e,1,t.times(i),new e(1));for(var o=n;o--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=n,t}var L=function(){function e(r,i,o){var s,a=0,c=r.length;for(r=r.slice();c--;)s=r[c]*i+a,r[c]=s%o|0,a=s/o|0;return a&&r.unshift(a),r}function t(r,i,o,s){var a,c;if(o!=s)c=o>s?1:-1;else for(a=c=0;a<o;a++)if(r[a]!=i[a]){c=r[a]>i[a]?1:-1;break}return c}function n(r,i,o,s){for(var a=0;o--;)r[o]-=a,a=r[o]<i[o]?1:0,r[o]=a*s+r[o]-i[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,o,s,a,c){var u,l,f,p,g,w,m,b,h,y,T,A,D,C,M,R,V,Y,q,re,ae=r.constructor,je=r.s==i.s?1:-1,K=r.d,N=i.d;if(!K||!K[0]||!N||!N[0])return new ae(!r.s||!i.s||(K?N&&K[0]==N[0]:!N)?NaN:K&&K[0]==0||!N?je*0:je/0);for(c?(g=1,l=r.e-i.e):(c=z,g=x,l=F(r.e/g)-F(i.e/g)),q=N.length,V=K.length,h=new ae(je),y=h.d=[],f=0;N[f]==(K[f]||0);f++);if(N[f]>(K[f]||0)&&l--,o==null?(C=o=ae.precision,s=ae.rounding):a?C=o+(r.e-i.e)+1:C=o,C<0)y.push(1),w=!0;else{if(C=C/g+2|0,f=0,q==1){for(p=0,N=N[0],C++;(f<V||p)&&C--;f++)M=p*c+(K[f]||0),y[f]=M/N|0,p=M%N|0;w=p||f<V}else{for(p=c/(N[0]+1)|0,p>1&&(N=e(N,p,c),K=e(K,p,c),q=N.length,V=K.length),R=q,T=K.slice(0,q),A=T.length;A<q;)T[A++]=0;re=N.slice(),re.unshift(0),Y=N[0],N[1]>=c/2&&++Y;do p=0,u=t(N,T,q,A),u<0?(D=T[0],q!=A&&(D=D*c+(T[1]||0)),p=D/Y|0,p>1?(p>=c&&(p=c-1),m=e(N,p,c),b=m.length,A=T.length,u=t(m,T,b,A),u==1&&(p--,n(m,q<b?re:N,b,c))):(p==0&&(u=p=1),m=N.slice()),b=m.length,b<A&&m.unshift(0),n(T,m,A,c),u==-1&&(A=T.length,u=t(N,T,q,A),u<1&&(p++,n(T,q<A?re:N,A,c))),A=T.length):u===0&&(p++,T=[0]),y[f++]=p,u&&T[0]?T[A++]=K[R]||0:(T=[K[R]],A=1);while((R++<V||T[0]!==void 0)&&C--);w=T[0]!==void 0}y[0]||y.shift()}if(g==1)h.e=l,Rt=w;else{for(f=1,p=y[0];p>=10;p/=10)f++;h.e=f+l*g-1,P(h,a?o+h.e+1:o,s,w)}return h}}();function P(e,t,n,r){var i,o,s,a,c,u,l,f,p,g=e.constructor;e:if(t!=null){if(f=e.d,!f)return e;for(i=1,a=f[0];a>=10;a/=10)i++;if(o=t-i,o<0)o+=x,s=t,l=f[p=0],c=l/O(10,i-s-1)%10|0;else if(p=Math.ceil((o+1)/x),a=f.length,p>=a)if(r){for(;a++<=p;)f.push(0);l=c=0,i=1,o%=x,s=o-x+1}else break e;else{for(l=a=f[p],i=1;a>=10;a/=10)i++;o%=x,s=o-x+i,c=s<0?0:l/O(10,i-s-1)%10|0}if(r=r||t<0||f[p+1]!==void 0||(s<0?l:l%O(10,i-s-1)),u=n<4?(c||r)&&(n==0||n==(e.s<0?3:2)):c>5||c==5&&(n==4||r||n==6&&(o>0?s>0?l/O(10,i-s):0:f[p-1])%10&1||n==(e.s<0?8:7)),t<1||!f[0])return f.length=0,u?(t-=e.e+1,f[0]=O(10,(x-t%x)%x),e.e=-t||0):f[0]=e.e=0,e;if(o==0?(f.length=p,a=1,p--):(f.length=p+1,a=O(10,x-o),f[p]=s>0?(l/O(10,i-s)%O(10,s)|0)*a:0),u)for(;;)if(p==0){for(o=1,s=f[0];s>=10;s/=10)o++;for(s=f[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(e.e++,f[0]==z&&(f[0]=1));break}else{if(f[p]+=a,f[p]!=z)break;f[p--]=0,a=1}for(o=f.length;f[--o]===0;)f.pop()}return k&&(e.e>g.maxE?(e.d=null,e.e=NaN):e.e<g.minE&&(e.e=0,e.d=[0])),e}function Z(e,t,n){if(!e.isFinite())return qt(e);var r,i=e.e,o=v(e.d),s=o.length;return t?(n&&(r=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+$(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):i<0?(o="0."+$(-i-1)+o,n&&(r=n-s)>0&&(o+=$(r))):i>=s?(o+=$(i+1-s),n&&(r=n-i-1)>0&&(o=o+"."+$(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(o+="."),o+=$(r))),o}function Me(e,t){var n=e[0];for(t*=x;n>=10;n/=10)t++;return t}function De(e,t,n){if(t>yn)throw k=!0,n&&(e.precision=n),Error(_t);return P(new e(Le),t,1,!0)}function j(e,t,n){if(t>Xe)throw Error(_t);return P(new e(Ne),t,n,!0)}function Ft(e){var t=e.length-1,n=t*x+1;if(t=e[t],t){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function $(e){for(var t="";e--;)t+="0";return t}function Vt(e,t,n,r){var i,o=new e(1),s=Math.ceil(r/x+4);for(k=!1;;){if(n%2&&(o=o.times(t),Et(o.d,s)&&(i=!0)),n=F(n/2),n===0){n=o.d.length-1,i&&o.d[n]===0&&++o.d[n];break}t=t.times(t),Et(t.d,s)}return k=!0,o}function Dt(e){return e.d[e.d.length-1]&1}function Wt(e,t,n){for(var r,i=new e(t[0]),o=0;++o<t.length;)if(r=new e(t[o]),r.s)i[n](r)&&(i=r);else{i=r;break}return i}function Je(e,t){var n,r,i,o,s,a,c,u=0,l=0,f=0,p=e.constructor,g=p.rounding,w=p.precision;if(!e.d||!e.d[0]||e.e>17)return new p(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(k=!1,c=w):c=t,a=new p(.03125);e.e>-2;)e=e.times(a),f+=5;for(r=Math.log(O(2,f))/Math.LN10*2+5|0,c+=r,n=o=s=new p(1),p.precision=c;;){if(o=P(o.times(e),c,1),n=n.times(++l),a=s.plus(L(o,n,c,1)),v(a.d).slice(0,c)===v(s.d).slice(0,c)){for(i=f;i--;)s=P(s.times(s),c,1);if(t==null)if(u<3&&me(s.d,c-r,g,u))p.precision=c+=10,n=o=a=new p(1),l=0,u++;else return P(s,p.precision=w,g,k=!0);else return p.precision=w,s}s=a}}function ee(e,t){var n,r,i,o,s,a,c,u,l,f,p,g=1,w=10,m=e,b=m.d,h=m.constructor,y=h.rounding,T=h.precision;if(m.s<0||!b||!b[0]||!m.e&&b[0]==1&&b.length==1)return new h(b&&!b[0]?-1/0:m.s!=1?NaN:b?0:m);if(t==null?(k=!1,l=T):l=t,h.precision=l+=w,n=v(b),r=n.charAt(0),Math.abs(o=m.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)m=m.times(e),n=v(m.d),r=n.charAt(0),g++;o=m.e,r>1?(m=new h("0."+n),o++):m=new h(r+"."+n.slice(1))}else return u=De(h,l+2,T).times(o+""),m=ee(new h(r+"."+n.slice(1)),l-w).plus(u),h.precision=T,t==null?P(m,T,y,k=!0):m;for(f=m,c=s=m=L(m.minus(1),m.plus(1),l,1),p=P(m.times(m),l,1),i=3;;){if(s=P(s.times(p),l,1),u=c.plus(L(s,new h(i),l,1)),v(u.d).slice(0,l)===v(c.d).slice(0,l))if(c=c.times(2),o!==0&&(c=c.plus(De(h,l+2,T).times(o+""))),c=L(c,new h(g),l,1),t==null)if(me(c.d,l-w,y,a))h.precision=l+=w,u=s=m=L(f.minus(1),f.plus(1),l,1),p=P(m.times(m),l,1),i=a=1;else return P(c,h.precision=T,y,k=!0);else return h.precision=T,c;c=u,i+=2}}function qt(e){return String(e.s*e.s/0)}function $e(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;r++);for(i=t.length;t.charCodeAt(i-1)===48;--i);if(t=t.slice(r,i),t){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%x,n<0&&(r+=x),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=x;r<i;)e.d.push(+t.slice(r,r+=x));t=t.slice(r),r=x-t.length}else r-=i;for(;r--;)t+="0";e.d.push(+t),k&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Tn(e,t){var n,r,i,o,s,a,c,u,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),Kt.test(t))return $e(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(gn.test(t))n=16,t=t.toLowerCase();else if(mn.test(t))n=2;else if(hn.test(t))n=8;else throw Error(te+t);for(o=t.search(/p/i),o>0?(c=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),o=t.indexOf("."),s=o>=0,r=e.constructor,s&&(t=t.replace(".",""),a=t.length,o=a-o,i=Vt(r,new r(n),o,o*2)),u=Ce(t,n,z),l=u.length-1,o=l;u[o]===0;--o)u.pop();return o<0?new r(e.s*0):(e.e=Me(u,l),e.d=u,k=!1,s&&(e=L(e,i,a*4)),c&&(e=e.times(Math.abs(c)<54?O(2,c):_e.pow(2,c))),k=!0,e)}function Pn(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:le(e,2,t,t);n=1.4*Math.sqrt(r),n=n>16?16:n|0,t=t.times(1/Re(5,n)),t=le(e,2,t,t);for(var i,o=new e(5),s=new e(16),a=new e(20);n--;)i=t.times(t),t=t.times(o.plus(i.times(s.times(i).minus(a))));return t}function le(e,t,n,r,i){var o,s,a,c,u=1,l=e.precision,f=Math.ceil(l/x);for(k=!1,c=n.times(n),a=new e(r);;){if(s=L(a.times(c),new e(t++*t++),l,1),a=i?r.plus(s):r.minus(s),r=L(s.times(c),new e(t++*t++),l,1),s=a.plus(r),s.d[f]!==void 0){for(o=f;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=r,r=s,s=o,u++}return k=!0,s.d.length=f+1,s}function Re(e,t){for(var n=e;--t;)n*=e;return n}function Ut(e,t){var n,r=t.s<0,i=j(e,e.precision,1),o=i.times(.5);if(t=t.abs(),t.lte(o))return Q=r?4:1,t;if(n=t.divToInt(i),n.isZero())Q=r?3:2;else{if(t=t.minus(n.times(i)),t.lte(o))return Q=Dt(n)?r?2:3:r?4:1,t;Q=Dt(n)?r?1:4:r?3:2}return t.minus(i).abs()}function et(e,t,n,r){var i,o,s,a,c,u,l,f,p,g=e.constructor,w=n!==void 0;if(w?(U(n,1,ne),r===void 0?r=g.rounding:U(r,0,8)):(n=g.precision,r=g.rounding),!e.isFinite())l=qt(e);else{for(l=Z(e),s=l.indexOf("."),w?(i=2,t==16?n=n*4-3:t==8&&(n=n*3-2)):i=t,s>=0&&(l=l.replace(".",""),p=new g(1),p.e=l.length-s,p.d=Ce(Z(p),10,i),p.e=p.d.length),f=Ce(l,10,i),o=c=f.length;f[--c]==0;)f.pop();if(!f[0])l=w?"0p+0":"0";else{if(s<0?o--:(e=new g(e),e.d=f,e.e=o,e=L(e,p,n,r,0,i),f=e.d,o=e.e,u=Rt),s=f[n],a=i/2,u=u||f[n+1]!==void 0,u=r<4?(s!==void 0||u)&&(r===0||r===(e.s<0?3:2)):s>a||s===a&&(r===4||u||r===6&&f[n-1]&1||r===(e.s<0?8:7)),f.length=n,u)for(;++f[--n]>i-1;)f[n]=0,n||(++o,f.unshift(1));for(c=f.length;!f[c-1];--c);for(s=0,l="";s<c;s++)l+=Ze.charAt(f[s]);if(w){if(c>1)if(t==16||t==8){for(s=t==16?4:3,--c;c%s;c++)l+="0";for(f=Ce(l,i,t),c=f.length;!f[c-1];--c);for(s=1,l="1.";s<c;s++)l+=Ze.charAt(f[s])}else l=l.charAt(0)+"."+l.slice(1);l=l+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)l="0"+l;l="0."+l}else if(++o>c)for(o-=c;o--;)l+="0";else o<c&&(l=l.slice(0,o)+"."+l.slice(o))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return e.s<0?"-"+l:l}function Et(e,t){if(e.length>t)return e.length=t,!0}function xn(e){return new this(e).abs()}function An(e){return new this(e).acos()}function kn(e){return new this(e).acosh()}function Sn(e,t){return new this(e).plus(t)}function Bn(e){return new this(e).asin()}function In(e){return new this(e).asinh()}function Cn(e){return new this(e).atan()}function Ln(e){return new this(e).atanh()}function Nn(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,o=r+4;return!e.s||!t.s?n=new this(NaN):!e.d&&!t.d?(n=j(this,o,1).times(t.s>0?.25:.75),n.s=e.s):!t.d||e.isZero()?(n=t.s<0?j(this,r,i):new this(0),n.s=e.s):!e.d||t.isZero()?(n=j(this,o,1).times(.5),n.s=e.s):t.s<0?(this.precision=o,this.rounding=1,n=this.atan(L(e,t,o,1)),t=j(this,o,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(L(e,t,o,1)),n}function Dn(e){return new this(e).cbrt()}function En(e){return P(e=new this(e),e.e+1,2)}function Mn(e,t,n){return new this(e).clamp(t,n)}function Rn(e){if(!e||typeof e!="object")throw Error(Ee+"Object expected");var t,n,r,i=e.defaults===!0,o=["precision",1,ne,"rounding",0,8,"toExpNeg",-ce,0,"toExpPos",0,ce,"maxE",0,ce,"minE",-ce,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(n=o[t],i&&(this[n]=Qe[n]),(r=e[n])!==void 0)if(F(r)===r&&r>=o[t+1]&&r<=o[t+2])this[n]=r;else throw Error(te+n+": "+r);if(n="crypto",i&&(this[n]=Qe[n]),(r=e[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(Ot);else this[n]=!1;else throw Error(te+n+": "+r);return this}function _n(e){return new this(e).cos()}function On(e){return new this(e).cosh()}function Gt(e){var t,n,r;function i(o){var s,a,c,u=this;if(!(u instanceof i))return new i(o);if(u.constructor=i,Mt(o)){u.s=o.s,k?!o.d||o.e>i.maxE?(u.e=NaN,u.d=null):o.e<i.minE?(u.e=0,u.d=[0]):(u.e=o.e,u.d=o.d.slice()):(u.e=o.e,u.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){u.s=1/o<0?-1:1,u.e=0,u.d=[0];return}if(o<0?(o=-o,u.s=-1):u.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;k?s>i.maxE?(u.e=NaN,u.d=null):s<i.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[o]):(u.e=s,u.d=[o]);return}else if(o*0!==0){o||(u.s=NaN),u.e=NaN,u.d=null;return}return $e(u,o.toString())}else if(c!=="string")throw Error(te+o);return(a=o.charCodeAt(0))===45?(o=o.slice(1),u.s=-1):(a===43&&(o=o.slice(1)),u.s=1),Kt.test(o)?$e(u,o):Tn(u,o)}if(i.prototype=d,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=Rn,i.clone=Gt,i.isDecimal=Mt,i.abs=xn,i.acos=An,i.acosh=kn,i.add=Sn,i.asin=Bn,i.asinh=In,i.atan=Cn,i.atanh=Ln,i.atan2=Nn,i.cbrt=Dn,i.ceil=En,i.clamp=Mn,i.cos=_n,i.cosh=On,i.div=vn,i.exp=Kn,i.floor=Fn,i.hypot=Vn,i.ln=Wn,i.log=qn,i.log10=Gn,i.log2=Un,i.max=Hn,i.min=jn,i.mod=zn,i.mul=Yn,i.pow=Zn,i.random=Qn,i.round=Xn,i.sign=Jn,i.sin=$n,i.sinh=er,i.sqrt=tr,i.sub=nr,i.sum=rr,i.tan=ir,i.tanh=or,i.trunc=sr,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function vn(e,t){return new this(e).div(t)}function Kn(e){return new this(e).exp()}function Fn(e){return P(e=new this(e),e.e+1,3)}function Vn(){var e,t,n=new this(0);for(k=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return k=!0,new this(1/0);n=t}return k=!0,n.sqrt()}function Mt(e){return e instanceof _e||e&&e.toStringTag===vt||!1}function Wn(e){return new this(e).ln()}function qn(e,t){return new this(e).log(t)}function Un(e){return new this(e).log(2)}function Gn(e){return new this(e).log(10)}function Hn(){return Wt(this,arguments,"lt")}function jn(){return Wt(this,arguments,"gt")}function zn(e,t){return new this(e).mod(t)}function Yn(e,t){return new this(e).mul(t)}function Zn(e,t){return new this(e).pow(t)}function Qn(e){var t,n,r,i,o=0,s=new this(1),a=[];if(e===void 0?e=this.precision:U(e,1,ne),r=Math.ceil(e/x),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));o<r;)i=t[o],i>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);o<r;)i=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((t[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(t,o):(a.push(i%1e7),o+=4);o=r/4}else throw Error(Ot);else for(;o<r;)a[o++]=Math.random()*1e7|0;for(r=a[--o],e%=x,r&&e&&(i=O(10,x-e),a[o]=(r/i|0)*i);a[o]===0;o--)a.pop();if(o<0)n=0,a=[0];else{for(n=-1;a[0]===0;n-=x)a.shift();for(r=1,i=a[0];i>=10;i/=10)r++;r<x&&(n-=x-r)}return s.e=n,s.d=a,s}function Xn(e){return P(e=new this(e),e.e+1,this.rounding)}function Jn(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function $n(e){return new this(e).sin()}function er(e){return new this(e).sinh()}function tr(e){return new this(e).sqrt()}function nr(e,t){return new this(e).sub(t)}function rr(){var e=0,t=arguments,n=new this(t[e]);for(k=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return k=!0,P(n,this.precision,this.rounding)}function ir(e){return new this(e).tan()}function or(e){return new this(e).tanh()}function sr(e){return P(e=new this(e),e.e+1,1)}d[Symbol.for("nodejs.util.inspect.custom")]=d.toString;d[Symbol.toStringTag]="Decimal";var _e=d.constructor=Gt(Qe);Le=new _e(Le);Ne=new _e(Ne);import{PublicKey as it}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as ar}from"@solana/spl-token";import{PublicKey as E,SystemProgram as Ht,SYSVAR_RENT_PUBKEY as ur}from"@solana/web3.js";function tt({pubkey:e,isSigner:t=!1,isWritable:n=!0}){return{pubkey:e,isWritable:n,isSigner:t}}var ni=[tt({pubkey:ar,isWritable:!1}),tt({pubkey:Ht.programId,isWritable:!1}),tt({pubkey:ur,isWritable:!1})];function jt({publicKey:e,transformSol:t}){let n=nt(e.toString());if(n instanceof E)return t&&n.equals(he)?ge:n;if(t&&n.toString()===he.toBase58())return ge;if(typeof n=="string"){if(n===E.default.toBase58())return E.default;try{return new E(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function nt(e){try{return new E(e)}catch{return e}}var ri=new E("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ii=new E("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),zt=new E("SysvarRent111111111111111111111111111111111"),rt=new E("SysvarC1ock11111111111111111111111111111111"),oi=new E("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),si=new E("Sysvar1nstructions1111111111111111111111111"),ai=Ht.programId,ui=new E("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),ci=new E("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),li=new E("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),fi=new E("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),pi=new E("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),di=new E("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),mi=new E("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),gi=new E("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),hi=new E("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),bi=new E("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),yi=new E("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),ge=new E("So11111111111111111111111111111111111111112"),he=E.default;import{PublicKey as cr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Yt}from"@solana/spl-token";var Zt={chainId:101,address:cr.default.toBase58(),programId:Yt.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},oe={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Yt.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var ot=class{constructor({mint:t,decimals:n,symbol:r,name:i,skipMint:o=!1,isToken2022:s=!1}){if(t===he.toBase58()||t instanceof it&&he.equals(t)){this.decimals=oe.decimals,this.symbol=oe.symbol,this.name=oe.name,this.mint=new it(oe.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||t.toString().substring(0,6),this.name=i||t.toString().substring(0,6),this.mint=o?it.default:jt({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},se=ot;se.WSOL=new ot({...oe,mint:oe.address});import ve from"big.js";import pr from"bn.js";import dr from"decimal.js-light";import lr from"toformat";var fr=lr,be=fr;var Oe=W("module/fraction"),st=be(ve),ye=be(dr),mr={[0]:ye.ROUND_DOWN,[1]:ye.ROUND_HALF_UP,[2]:ye.ROUND_UP},gr={[0]:ve.roundDown,[1]:ve.roundHalfUp,[2]:ve.roundUp},I=class{constructor(t,n=new pr(1)){this.numerator=H(t),this.denominator=H(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new I(this.denominator,this.numerator)}add(t){let n=t instanceof I?t:new I(H(t));return this.denominator.eq(n.denominator)?new I(this.numerator.add(n.numerator),this.denominator):new I(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(t){let n=t instanceof I?t:new I(H(t));return this.denominator.eq(n.denominator)?new I(this.numerator.sub(n.numerator),this.denominator):new I(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(t){let n=t instanceof I?t:new I(H(t));return new I(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(t){let n=t instanceof I?t:new I(H(t));return new I(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(t,n={groupSeparator:""},r=1){Number.isInteger(t)||Oe.logWithError(`${t} is not an integer.`),t<=0&&Oe.logWithError(`${t} is not positive.`),ye.set({precision:t+1,rounding:mr[r]});let i=new ye(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return i.toFormat(i.decimalPlaces(),n)}toFixed(t,n={groupSeparator:""},r=1){return Number.isInteger(t)||Oe.logWithError(`${t} is not an integer.`),t<0&&Oe.logWithError(`${t} is negative.`),st.DP=t,st.RM=gr[r]||1,new st(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,n)}isZero(){return this.numerator.isZero()}};var br=W("Raydium_price"),X=class extends I{constructor(n){let{baseToken:r,quoteToken:i,numerator:o,denominator:s}=n;super(o,s);this.baseToken=r,this.quoteToken=i,this.scalar=new I(at(r.decimals),at(i.decimals))}get raw(){return new I(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new X({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(n){this.quoteToken!==n.baseToken&&br.logWithError("mul token not equals");let r=super.mul(n);return new X({baseToken:this.baseToken,quoteToken:n.quoteToken,denominator:r.denominator,numerator:r.numerator})}toSignificant(n=this.quoteToken.decimals,r,i){return this.adjusted.toSignificant(n,r,i)}toFixed(n=this.quoteToken.decimals,r,i){return this.adjusted.toFixed(n,r,i)}};var ut=class{constructor({decimals:t,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=t,this.symbol=n,this.name=r}equals(t){return this===t}},Ke=ut;Ke.SOL=new ut(Zt);import yr from"bn.js";var Qt=new I(new yr(100)),fe=class extends I{toSignificant(t=5,n,r){return this.mul(Qt).toSignificant(t,n,r)}toFixed(t=2,n,r){return this.mul(Qt).toFixed(t,n,r)}};var wr=new G(0),ho=new G(1),bo=new G(2),yo=new G(3),wo=new G(5),ct=new G(10),To=new G(100),Po=new G(1e3),xo=new G(1e4),Xt=9007199254740991;function H(e){let t=W("Raydium_parseBigNumberish");if(e instanceof G)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new G(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=Xt||e<=-Xt)&&t.logWithError(`BigNumberish number overflow: ${e}`),new G(String(e))):typeof e=="bigint"?new G(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new G(0))}function at(e){return ct.pow(H(e))}var Pr=W("Raydium_amount"),$t=be(Tr);function xr(e,t){let n="0",r="0";if(e.includes(".")){let i=e.split(".");i.length===2?([n,r]=i,r=r.padEnd(t,"0")):Pr.logWithError(`invalid number string, num: ${e}`)}else n=e;return[n,r.slice(0,t)||r]}var J=class extends I{constructor(n,r,i=!0,o){let s=new Fe(0),a=ct.pow(new Fe(n.decimals));if(i)s=H(r);else{let c=new Fe(0),u=new Fe(0);if(typeof r=="string"||typeof r=="number"||typeof r=="bigint"){let[l,f]=xr(r.toString(),n.decimals);c=H(l),u=H(f)}c=c.mul(a),s=c.add(u)}super(s,a);this.logger=W(o||"TokenAmount"),this.token=n}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(n){return this.token.equals(n.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(n.raw)}lt(n){return this.token.equals(n.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(n.raw)}add(n){return this.token.equals(n.token)||this.logger.logWithError("add token not equals"),new J(this.token,this.raw.add(n.raw))}subtract(n){return this.token.equals(n.token)||this.logger.logWithError("sub token not equals"),new J(this.token,this.raw.sub(n.raw))}toSignificant(n=this.token.decimals,r,i=0){return super.toSignificant(n,r,i)}toFixed(n=this.token.decimals,r,i=0){return n>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(n,r,i)}toExact(n={groupSeparator:""}){return $t.DP=this.token.decimals,new $t(this.numerator.toString()).div(this.denominator.toString()).toFormat(n)}};function Jt(e){return typeof e=="object"&&e!==null&&![se,J,Ar,I,kr,X,fe].some(t=>typeof t=="object"&&e instanceof t)}function Ve(e){return typeof e=="string"?nt(e):Array.isArray(e)?e.map(t=>Ve(t)):Jt(e)?Object.fromEntries(Object.entries(e).map(([t,n])=>[t,Ve(n)])):e}function lt(e,t=1,n=[]){let r=[...e];if(t<=0)return n;for(;r.length;)n.push(r.splice(0,t));return n}import{PublicKey as _}from"@solana/web3.js";var Jo=new _("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),$o=new _("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),es=new _("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),ts=new _("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),ns=new _("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),rs=new _("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),is=new _("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),os=new _("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),ss=new _("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),as=new _("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Sr=new _("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Br=new _("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Ir=new _("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Cr=new _("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),us=new _("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),cs=new _("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),ls=new _("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),fs=new _("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),ps=new _("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),ds=new _("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2"),we={IDO_PROGRAM_ID_V1:Sr,IDO_PROGRAM_ID_V2:Br,IDO_PROGRAM_ID_V3:Ir,IDO_PROGRAM_ID_V4:Cr};import{PublicKey as bs}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Ts}from"@solana/spl-token";import As from"bn.js";var ft=W("Raydium_accountInfo_util");async function en(e,t,n){let{batchRequest:r,commitment:i="confirmed"}={batchRequest:!1,...n},o=lt(t,100),s=new Array(o.length).fill([]);if(r){let a=o.map(l=>{let f=e._buildArgs([l.map(p=>p.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:f}}),c=lt(a,10);s=(await(await Promise.all(c.map(async l=>await e._rpcBatchRequest(l)))).flat()).map(l=>(l.error&&ft.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${l.error.message}`),l.result.value.map(f=>{if(f){let{data:p,executable:g,lamports:w,owner:m,rentEpoch:b}=f;return p.length!==2&&p[1]!=="base64"&&ft.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(p[0],"base64"),executable:g,lamports:w,owner:new Lr(m),rentEpoch:b}}return null})))}else try{s=await Promise.all(o.map(a=>e.getMultipleAccountsInfo(a,i)))}catch(a){a instanceof Error&&ft.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${a.message}`)}return s.flat()}async function pt({connection:e,address:t}){let n=await en(e,[...new Set(t.map(i=>i.toString()))].map(i=>new tn(i))),r={};for(let i=0;i<t.length;i++){let o=n[i],s=t[i];if(!o)continue;let a=new We({key:s,state:We.deserialize(o.data)});r[s.toString()]=a,qe[s.toString()]=a}return r}var qe={"2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17":new We({key:new tn("2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17"),state:We.deserialize(Buffer.from("AQAAAP//////////d49+DAAAAAAAAQZMWvw7GUNJdaccNBVnb57OKakxL2BHLYvhRwVILRsgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAABt324ddloZPZy+FGzut5rBy0he1fWzeROoz1hX7/AKkG3fbh7nWP3hhCXbzkbM3athr8TYO5DSf+vfko2KGL/AVKU1D4XciC1hSlVnJ4iilt3x6rq9CmBniISTL07vagBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvDQdRqCgtphMF/imcN7mY5YRx2xE1A3MQ+L4QRaYK9u4GRfZP3LsAd00a+IkCpA22UNQMKdq5BFbJuwuOLqc8zxCTDlqxBG8J0HcxtfogQHDK06ukzfaXiNDKAob1MqBHS9lJxDYCwz8gd5DtFqNSTKG5l1zxIaKpDP/sffi2is1H9aKveyXSu5StXElYRl9SD5As0DHE4N0GLnf84/siiKXVyp4Ez121kLcUui/jLLFZEz/BwZK3Ilf9B9OcsEAeDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu9N9LMnrw/JNO0hqMVB4rk/2ou4AB1loQ7FZoPwut2o4KZB+0p9xnbrQKw038qjpHar+PyDwvxBRcu5hpHw3dguezeWv+IwvgW5icu8EGkhGa9AkFPPJT7VMSFb8xowveU=","base64"))})};var Ue=class{constructor(t){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=t.connection,this.feePayer=t.feePayer,this.signAllTransactions=t.signAllTransactions,this.owner=t.owner,this.cluster=t.cluster}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let t=(await Nr.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:n}=(r=t==null?void 0:t[15])!=null?r:{};if(!!n)return{units:6e5,microLamports:Math.min(Math.ceil(n*1e6/6e5),25e3)}}addCustomComputeBudget(t){if(t){let{instructions:n,instructionTypes:r}=Ie(t);return this.instructions.unshift(...n),this.instructionTypes.unshift(...r),!0}return!1}async calComputeBudget({config:t,defaultIns:n}){try{let r=t||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;n&&this.instructions.unshift(...n)}catch{n&&this.instructions.unshift(...n)}}addInstruction({instructions:t=[],endInstructions:n=[],signers:r=[],instructionTypes:i=[],endInstructionTypes:o=[],lookupTableAddress:s=[]}){return this.instructions.push(...t),this.endInstructions.push(...n),this.signers.push(...r),this.instructionTypes.push(...i),this.endInstructionTypes.push(...o),this.lookupTableAddress.push(...s.filter(a=>a!==Te.default.toString())),this}async versionBuild({txVersion:t,extInfo:n}){return t===0?await this.buildV0({...n||{}}):this.build(n)}build(t){let n=new Pe;return this.allInstructions.length&&n.add(...this.allInstructions),n.feePayer=this.feePayer,{builder:this,transaction:n,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async r=>{var a;let{recentBlockHash:i,skipPreflight:o=!0}=r||{},s=i!=null?i:await ue(this.connection);if(n.recentBlockhash=s,this.signers.length&&n.sign(...this.signers),ie([n]),(a=this.owner)!=null&&a.isKeyPair)return{txId:await dt(this.connection,n,this.signers.find(c=>c.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:o}),signedTx:n};if(this.signAllTransactions){let c=await this.signAllTransactions([n]);return{txId:await this.connection.sendRawTransaction(c[0].serialize(),{skipPreflight:o}),signedTx:c[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:t||{}}}buildMultiTx(t){let{extraPreBuildData:n=[],extInfo:r}=t,{transaction:i}=this.build(r),o=n.filter(u=>u.transaction.instructions.length>0),s=[i,...o.map(u=>u.transaction)],a=[this.signers,...o.map(u=>u.signers)],c=[...this.instructionTypes,...o.map(u=>u.instructionTypes).flat()];return{builder:this,transactions:s,signers:a,instructionTypes:c,execute:async u=>{var m;let{sequentially:l,onTxUpdate:f,recentBlockHash:p,skipPreflight:g=!0}=u||{},w=p!=null?p:await ue(this.connection);if((m=this.owner)!=null&&m.isKeyPair)return{txIds:await await Promise.all(s.map(async(b,h)=>(b.recentBlockhash=w,await dt(this.connection,b,a[h].find(y=>y.publicKey.equals(this.owner.publicKey))?a[h]:[...a[h],this.owner.signer],{skipPreflight:g})))),signedTxs:s};if(this.signAllTransactions){let b=s.map((y,T)=>(y.recentBlockhash=w,a[T].length&&y.sign(...a[T]),y));ie(b);let h=await this.signAllTransactions(b);if(l){let y=0,T=[],A=async()=>{if(!h[y])return;let D=await this.connection.sendRawTransaction(h[y].serialize(),{skipPreflight:g});T.push({txId:D,status:"sent",signedTx:h[y]}),f==null||f([...T]),y++,this.connection.onSignature(D,C=>{let M=T.findIndex(R=>R.txId===D);M>-1&&(T[M].status=C.err?"error":"success"),f==null||f([...T]),C.err||A()},"processed"),this.connection.getSignatureStatus(D)};return await A(),{txIds:T.map(D=>D.txId),signedTxs:h}}else{let y=[];for(let T=0;T<h.length;T+=1){let A=await this.connection.sendRawTransaction(h[T].serialize(),{skipPreflight:g});y.push(A)}return{txIds:y,signedTxs:h}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:t,txVersion:n,extInfo:r}){return n===0?await this.buildV0MultiTx({extraPreBuildData:t,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:t,extInfo:r})}async buildV0(t){let{lookupTableCache:n={},lookupTableAddress:r=[],forerunCreate:i,...o}=t||{},s={...this.cluster==="devnet"?{}:qe,...n},a=Array.from(new Set([...r,...this.lookupTableAddress])),c=[];for(let p of a)s[p]===void 0&&c.push(new Te(p));let u=await pt({connection:this.connection,address:c});for(let[p,g]of Object.entries(u))s[p]=g;let l=new xe({payerKey:this.feePayer,recentBlockhash:i?Te.default.toBase58():await ue(this.connection),instructions:[...this.allInstructions]}).compileToV0Message(Object.values(s)),f=new Ae(l);return f.sign(this.signers),{builder:this,transaction:f,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async p=>{var m;let{recentBlockHash:g,skipPreflight:w=!0}=p||{};if(g&&(f.message.recentBlockhash=g),ie([f]),(m=this.owner)!=null&&m.isKeyPair){this.signers.find(T=>T.publicKey.equals(this.owner.publicKey))||f.sign([this.owner.signer]);let b=await this.connection.sendTransaction(f,{skipPreflight:w}),{lastValidBlockHeight:h,blockhash:y}=await this.connection.getLatestBlockhash();return await this.connection.confirmTransaction({blockhash:y,lastValidBlockHeight:h,signature:b},"confirmed"),{txId:b,signedTx:f}}if(this.signAllTransactions){let b=await this.signAllTransactions([f]);return{txId:await this.connection.sendTransaction(b[0],{skipPreflight:w}),signedTx:b[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:o||{}}}async buildV0MultiTx(t){let{extraPreBuildData:n=[],buildProps:r}=t,{transaction:i}=await this.buildV0(r),o=n.filter(u=>u.builder.instructions.length>0),s=[i,...o.map(u=>u.transaction)],a=[this.signers,...o.map(u=>u.signers)],c=[...this.instructionTypes,...o.map(u=>u.instructionTypes).flat()];return s.forEach(async(u,l)=>{u.sign(a[l])}),{builder:this,transactions:s,signers:a,instructionTypes:c,buildProps:r,execute:async u=>{var w;let{sequentially:l,onTxUpdate:f,recentBlockHash:p,skipPreflight:g=!0}=u||{};if(p&&s.forEach(m=>m.message.recentBlockhash=p),ie(s),(w=this.owner)!=null&&w.isKeyPair){let{lastValidBlockHeight:m,blockhash:b}=await this.connection.getLatestBlockhash();return s.forEach((h,y)=>{a[y].find(T=>T.publicKey.equals(this.owner.publicKey))||h.sign([this.owner.signer])}),{txIds:await Promise.all(s.map(async h=>{let y=await this.connection.sendTransaction(h,{skipPreflight:g});return await this.connection.confirmTransaction({blockhash:b,lastValidBlockHeight:m,signature:y},"confirmed"),y})),signedTxs:s}}if(this.signAllTransactions){let m=await this.signAllTransactions(s);if(l){let b=0,h=[],y=async()=>{if(!m[b])return;let T=await this.connection.sendTransaction(m[b],{skipPreflight:g});h.push({txId:T,status:"sent",signedTx:m[b]}),f==null||f([...h]),b++,this.connection.onSignature(T,A=>{let D=h.findIndex(C=>C.txId===T);D>-1&&(h[D].status=A.err?"error":"success"),f==null||f([...h]),A.err||y()},"processed"),this.connection.getSignatureStatus(T)};return y(),{txIds:[],signedTxs:m}}else{let b=[];for(let h=0;h<m.length;h+=1){let y=await this.connection.sendTransaction(m[h],{skipPreflight:g});b.push(y)}return{txIds:b,signedTxs:m}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(t){let{computeBudgetConfig:n,...r}=t||{},i=n?Ie(n):{instructions:[],instructionTypes:[]},o=this.signers.reduce((u,l)=>({...u,[l.publicKey.toBase58()]:l}),{}),s=[],a=[],c=[];if(this.allInstructions.forEach(u=>{let l=[...c,u],f=n?[...i.instructions,...l]:l,g=[...new Set(l.map(w=>w.keys.filter(m=>m.isSigner).map(m=>m.pubkey.toString())).flat()).values()].map(w=>new Te(w));if(c.length<12&&pe({instructions:f,payer:this.feePayer,signers:g})||pe({instructions:l,payer:this.feePayer,signers:g}))c.push(u);else{if(c.length===0)throw Error("item ins too big");pe({instructions:n?[...i.instructions,...c]:[...c],payer:this.feePayer,signers:g})?s.push(new Pe().add(...i.instructions,...c)):s.push(new Pe().add(...c)),a.push(Array.from(new Set(c.map(w=>w.keys.filter(m=>m.isSigner).map(m=>m.pubkey.toString())).flat())).map(w=>o[w]).filter(w=>w!==void 0)),c=[u]}}),c.length>0){let l=[...new Set(c.map(f=>f.keys.filter(p=>p.isSigner).map(p=>p.pubkey.toString())).flat()).values()].map(f=>o[f]).filter(f=>f!==void 0);pe({instructions:n?[...i.instructions,...c]:[...c],payer:this.feePayer,signers:l.map(f=>f.publicKey)})?s.push(new Pe().add(...i.instructions,...c)):s.push(new Pe().add(...c)),a.push(l)}return s.forEach(u=>u.feePayer=this.feePayer),{builder:this,transactions:s,signers:a,instructionTypes:this.instructionTypes,execute:async u=>{var m;let{sequentially:l,onTxUpdate:f,recentBlockHash:p,skipPreflight:g=!0}=u||{},w=p!=null?p:await ue(this.connection);if(s.forEach(async(b,h)=>{b.recentBlockhash=w,a[h].length&&b.sign(...a[h])}),ie(s),(m=this.owner)!=null&&m.isKeyPair)return{txIds:await Promise.all(s.map(async(b,h)=>await dt(this.connection,b,a[h].find(y=>y.publicKey.equals(this.owner.publicKey))?a[h]:[...a[h],this.owner.signer],{skipPreflight:g}))),signedTxs:s};if(this.signAllTransactions){let b=await this.signAllTransactions(s);if(l){let h=0,y=[],T=async()=>{if(!b[h])return;let A=await this.connection.sendRawTransaction(b[h].serialize(),{skipPreflight:g});y.push({txId:A,status:"sent",signedTx:b[h]}),f==null||f([...y]),h++,this.connection.onSignature(A,D=>{let C=y.findIndex(M=>M.txId===A);C>-1&&(y[C].status=D.err?"error":"success"),f==null||f([...y]),D.err||T()},"processed"),this.connection.getSignatureStatus(A)};return await T(),{txIds:y.map(A=>A.txId),signedTxs:b}}else{let h=[];for(let y=0;y<b.length;y+=1){let T=await this.connection.sendRawTransaction(b[y].serialize(),{skipPreflight:g});h.push(T)}return{txIds:h,signedTxs:b}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuildV0(t){let{computeBudgetConfig:n,lookupTableCache:r={},lookupTableAddress:i=[],...o}=t||{},s={...this.cluster==="devnet"?{}:qe,...r},a=Array.from(new Set([...this.lookupTableAddress,...i])),c=[];for(let b of a)s[b]===void 0&&c.push(new Te(b));let u=await pt({connection:this.connection,address:c});for(let[b,h]of Object.entries(u))s[b]=h;let l=n?Ie(n):{instructions:[],instructionTypes:[]},f=await ue(this.connection),p=this.signers.reduce((b,h)=>({...b,[h.publicKey.toBase58()]:h}),{}),g=[],w=[],m=[];if(this.allInstructions.forEach(b=>{let h=[...m,b],y=n?[...l.instructions,...h]:h;if(m.length<12&&de({instructions:y,payer:this.feePayer,lookupTableAddressAccount:s})||de({instructions:h,payer:this.feePayer,lookupTableAddressAccount:s}))m.push(b);else{if(m.length===0)throw Error("item ins too big");let T={};for(let A of[...new Set(a)])s[A]!==void 0&&(T[A]=s[A]);if(n&&de({instructions:[...l.instructions,...m],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:f})){let A=new xe({payerKey:this.feePayer,recentBlockhash:f,instructions:[...l.instructions,...m]}).compileToV0Message(Object.values(s));g.push(new Ae(A))}else{let A=new xe({payerKey:this.feePayer,recentBlockhash:f,instructions:[...m]}).compileToV0Message(Object.values(s));g.push(new Ae(A))}w.push(Array.from(new Set(m.map(A=>A.keys.filter(D=>D.isSigner).map(D=>D.pubkey.toString())).flat())).map(A=>p[A]).filter(A=>A!==void 0)),m=[b]}}),m.length>0){let h=[...new Set(m.map(y=>y.keys.filter(T=>T.isSigner).map(T=>T.pubkey.toString())).flat()).values()].map(y=>p[y]).filter(y=>y!==void 0);if(n&&de({instructions:[...l.instructions,...m],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:f})){let y=new xe({payerKey:this.feePayer,recentBlockhash:f,instructions:[...l.instructions,...m]}).compileToV0Message(Object.values(s));g.push(new Ae(y))}else{let y=new xe({payerKey:this.feePayer,recentBlockhash:f,instructions:[...m]}).compileToV0Message(Object.values(s));g.push(new Ae(y))}w.push(h)}return{builder:this,transactions:g,buildProps:t,signers:w,instructionTypes:this.instructionTypes,execute:async b=>{var D;let{sequentially:h,onTxUpdate:y,recentBlockHash:T,skipPreflight:A=!0}=b||{};if(g.map(async(C,M)=>{w[M].length&&C.sign(w[M]),T&&(C.message.recentBlockhash=T)}),ie(g),(D=this.owner)!=null&&D.isKeyPair){let{lastValidBlockHeight:C,blockhash:M}=await this.connection.getLatestBlockhash();return g.forEach((R,V)=>{w[V].find(Y=>Y.publicKey.equals(this.owner.publicKey))||R.sign([this.owner.signer])}),{txIds:await Promise.all(g.map(async R=>{let V=await this.connection.sendTransaction(R,{skipPreflight:A});return await this.connection.confirmTransaction({blockhash:M,lastValidBlockHeight:C,signature:V},"confirmed"),V})),signedTxs:g}}if(this.signAllTransactions){let C=await this.signAllTransactions(g);if(h){let M=0,R=[],V=async()=>{if(!C[M])return;let Y=await this.connection.sendTransaction(C[M],{skipPreflight:A});R.push({txId:Y,status:"sent",signedTx:C[M]}),y==null||y([...R]),M++,this.connection.onSignature(Y,q=>{let re=R.findIndex(ae=>ae.txId===Y);re>-1&&(R[re].status=q.err?"error":"success"),y==null||y([...R]),q.err||V()},"processed"),this.connection.getSignatureStatus(Y)};return V(),{txIds:[],signedTxs:C}}else{let M=[];for(let R=0;R<C.length;R+=1){let V=await this.connection.sendTransaction(C[R],{skipPreflight:A});M.push(V)}return{txIds:M,signedTxs:C}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:o||{}}}};var mt=(...e)=>e.map(t=>{try{return typeof t=="object"?JSON.stringify(t):t}catch{return t}}).join(", "),ke=class{constructor({scope:t,moduleName:n}){this.disabled=!1;this.scope=t,this.logger=W(n)}createTxBuilder(t){return this.scope.checkOwner(),new Ue({connection:this.scope.connection,feePayer:t||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,signAllTransactions:this.scope.signAllTransactions})}logDebug(...t){this.logger.debug(mt(t))}logInfo(...t){this.logger.info(mt(t))}logAndCreateError(...t){let n=mt(t);throw new Error(n)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};import{PublicKey as Rr,TransactionInstruction as wt,SYSVAR_CLOCK_PUBKEY as _r}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Tt}from"@solana/spl-token";import{PublicKey as wu}from"@solana/web3.js";import Pu,{isBN as xu}from"bn.js";import{bits as ya,BitStructure as wa,blob as Ta,Blob as Pa,cstr as xa,f32 as Aa,f32be as ka,f64 as Sa,f64be as Ba,greedy as Ia,Layout as Ca,ns64 as La,ns64be as Na,nu64 as Dr,nu64be as Da,offset as Ea,s16 as Ma,s16be as Ra,s24 as _a,s24be as Oa,s32 as va,s32be as Ka,s40 as Fa,s40be as Va,s48 as Wa,s48be as qa,s8 as Ua,seq as Ga,struct as Ha,Structure as Er,u16 as ja,u16be as za,u24 as Ya,u24be as Za,u32 as Qa,u32be as Xa,u40 as Ja,u40be as $a,u48 as eu,u48be as tu,u8 as nu,UInt as Mr,union as ru,Union as iu,unionLayoutDiscriminator as ou,utf8 as su}from"@solana/buffer-layout";var nn=Er;var rn=Mr;var on=Dr;function ht(e){return new rn(1,e)}var gt=class extends nn{decode(t,n){return super.decode(t,n)}};function bt(e,t,n){return new gt(e,t,n)}var yt=bt([ht("instruction"),on("amount")]),Se=bt([ht("instruction")]);function Eu({programId:e,amount:t,instructionKeys:n}){let r=[{pubkey:new Rr("11111111111111111111111111111111"),isSigner:!1,isWritable:!1},{pubkey:Tt,isSigner:!1,isWritable:!1},{pubkey:zt,isSigner:!1,isWritable:!1},{pubkey:rt,isSigner:!1,isWritable:!1},...Object.entries(n).map(([o,s])=>({pubkey:s,isSigner:o==="userOwner",isWritable:!["authority","userOwner","userIdoCheck","userStakeInfo"].includes(o)}))],i=Buffer.alloc(yt.span);return yt.encode({instruction:1,amount:Number(t)},i),new wt({keys:r,programId:e,data:i})}function Ge({programId:e},t){let n=[{pubkey:Tt,isSigner:!1,isWritable:!1},{pubkey:rt,isSigner:!1,isWritable:!1},...Object.entries(t).map(([i,o])=>({pubkey:o,isSigner:i==="userOwner",isWritable:!["authority","userOwner"].includes(i)}))],r=Buffer.alloc(Se.span);return Se.encode({instruction:2},r),new wt({keys:n,programId:e,data:r})}function Pt(e){let{poolConfig:t,userKeys:n,side:r}=e,i=r==="base"?n.baseTokenAccount:n.quoteTokenAccount,o=r==="base"?t.baseVault:t.quoteVault,s=Buffer.alloc(Se.span);Se.encode({instruction:2},s);let a=[{pubkey:Tt,isWritable:!1,isSigner:!1},{pubkey:_r,isWritable:!1,isSigner:!1},{pubkey:t.id,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!1},{pubkey:o,isWritable:!0,isSigner:!1},{pubkey:i,isWritable:!0,isSigner:!1},{pubkey:n.ledgerAccount,isWritable:!0,isSigner:!1},{pubkey:n.owner,isWritable:!1,isSigner:!0}];return new wt({programId:t.programId,keys:a,data:s})}import sn from"bn.js";var Or={[we.IDO_PROGRAM_ID_V1.toString()]:1,[we.IDO_PROGRAM_ID_V2.toString()]:2,[we.IDO_PROGRAM_ID_V3.toString()]:3,[we.IDO_PROGRAM_ID_V4.toString()]:4},He=class extends ke{async claim({ownerInfo:t,idoKeys:n,associatedOnly:r=!0,checkCreateATAOwner:i=!1,txVersion:o}){let s=this.createTxBuilder(),a=Or[n.programId];a||this.logAndCreateError("invalid version",a);let c=Ve(n),[u,l]=[!new sn(t.coin).isZero(),!new sn(t.pc).isZero()],f=c.projectInfo.mint.address.equals(ge),{account:p,instructionParams:g}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:c.projectInfo.mint.programId,mint:c.projectInfo.mint.address,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!f,notUseTokenAccount:f,associatedOnly:f?!1:r,checkCreateATAOwner:i});!p&&u&&this.logAndCreateError("target token accounts not found","mint",n.projectInfo.mint.address),u&&g&&s.addInstruction(g);let w=c.buyInfo.mint.address.equals(ge),{account:m,instructionParams:b}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:c.buyInfo.mint.programId,mint:c.buyInfo.mint.address,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!w,notUseTokenAccount:w,associatedOnly:w?!1:r,checkCreateATAOwner:i});if(!p&&l&&this.logAndCreateError("target token accounts not found","mint",n.projectInfo.mint.address),l&&b&&s.addInstruction(b),(!p||!m)&&this.logAndCreateError("target token accounts not found","mint",n.projectInfo.mint.address,n.buyInfo.mint.address),a===3)return s.addInstruction({instructions:[...u?[Ge({programId:c.programId},{idoId:c.id,authority:c.authority,poolTokenAccount:c.projectInfo.vault,userTokenAccount:p,userIdoInfo:new Be(t.userIdoInfo),userOwner:this.scope.ownerPubKey})]:[],...l?[Ge({programId:new Be(n.programId)},{idoId:c.id,authority:c.authority,poolTokenAccount:c.buyInfo.vault,userTokenAccount:m,userIdoInfo:new Be(t.userIdoInfo),userOwner:this.scope.ownerPubKey})]:[]]}).versionBuild({txVersion:o});if(a<3)return!u&&!l&&this.logAndCreateError("no claimable rewards"),s.addInstruction({instructions:[Ge({programId:c.programId},{idoId:c.id,authority:c.authority,poolQuoteTokenAccount:c.buyInfo.vault,poolBaseTokenAccount:c.projectInfo.vault,userQuoteTokenAccount:m,userBaseTokenAccount:p,userIdoInfo:new Be(t.userIdoInfo),userOwner:this.scope.ownerPubKey})]}).versionBuild({txVersion:o});let h={poolConfig:{id:c.id,programId:c.programId,authority:c.authority,baseVault:c.projectInfo.vault,quoteVault:c.buyInfo.vault,baseToken:n.projectInfo.mint,quoteToken:n.buyInfo.mint},userKeys:{baseTokenAccount:p,quoteTokenAccount:m,ledgerAccount:new Be(t.userIdoInfo),owner:this.scope.ownerPubKey}};return s.addInstruction({instructions:[...u?[Pt({...h,side:"base"})]:[],...l?[Pt({...h,side:"quote"})]:[]]}).versionBuild({txVersion:o})}};export{Se as claimLayout,He as default,Ge as makeClaimInstruction,Pt as makeClaimInstructionV4,Eu as makePurchaseInstruction,yt as purchaseLayout};
/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */
//# sourceMappingURL=index.mjs.map