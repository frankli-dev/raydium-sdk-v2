import{PublicKey as Or}from"@solana/web3.js";import Ot,{isBN as Ut}from"bn.js";import{bits as Vi,BitStructure as Fi,blob as vr,Blob as vi,cstr as Ei,f32 as _i,f32be as Mi,f64 as Di,f64be as Wi,greedy as Oi,Layout as Er,ns64 as Ui,ns64be as qi,nu64 as Gi,nu64be as Hi,offset as ji,s16 as Yi,s16be as zi,s24 as Zi,s24be as Xi,s32 as Ji,s32be as Qi,s40 as $i,s40be as eo,s48 as to,s48be as ro,s8 as no,seq as _r,struct as io,Structure as Mr,u16 as oo,u16be as so,u24 as ao,u24be as uo,u32 as co,u32be as lo,u40 as fo,u40be as po,u48 as mo,u48be as go,u8 as Dr,UInt as Wr,union as yo,Union as bo,unionLayoutDiscriminator as ho,utf8 as wo}from"@solana/buffer-layout";var it=Er,Mt=Mr;var ot=Wr;var Dt=Dr;var Wt=_r;var me=vr;var xe=class extends it{constructor(r,n,i){super(r,i);this.blob=me(r),this.signed=n}decode(r,n=0){let i=new Ot(this.blob.decode(r,n),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(r,n,i=0){return typeof r=="number"&&(r=new Ot(r)),this.signed&&(r=r.toTwos(this.span*8)),this.blob.encode(r.toArrayLike(Buffer,"le",this.span),n,i)}};function C(e){return new ot(1,e)}function Se(e){return new ot(4,e)}function y(e){return new xe(8,!1,e)}function ie(e){return new xe(16,!1,e)}function qt(e){return new xe(1,!0,e)}function Oe(e){return new xe(8,!0,e)}var We=class extends it{constructor(r,n,i,o){super(r.span,o);this.layout=r,this.decoder=n,this.encoder=i}decode(r,n){return this.decoder(this.layout.decode(r,n))}encode(r,n,i){return this.layout.encode(this.encoder(r),n,i)}getSpan(r,n){return this.layout.getSpan(r,n)}};function A(e){return new We(me(32),t=>new Or(t),t=>t.toBuffer(),e)}function Re(e){return new We(Dt(),Ur,qr,e)}function Ur(e){if(e===0)return!1;if(e===1)return!0;throw new Error("Invalid bool: "+e)}function qr(e){return e?1:0}var st=class extends Mt{decode(t,r){return super.decode(t,r)}};function K(e,t,r){return new st(e,t,r)}function E(e,t,r){let n,i=typeof t=="number"?t:Ut(t)?t.toNumber():new Proxy(t,{get(o,s){if(!n){let a=Reflect.get(o,"count");n=Ut(a)?a.toNumber():a,Reflect.set(o,"count",n)}return Reflect.get(o,s)},set(o,s,a){return s==="count"&&(n=a),Reflect.set(o,s,a)}});return Wt(e,i,r)}import{PublicKey as Xt}from"@solana/web3.js";import{get as Gt,set as Gr}from"lodash";import jt from"dayjs";import Hr from"dayjs/plugin/utc";jt.extend(Hr);var at=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return jt().utc().format("YYYY/MM/DD HH:mm:ss UTC")}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let r=t.map(n=>typeof n=="object"?JSON.stringify(n):n).join(", ");throw new Error(r)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},Ht={},jr={};function W(e){let t=Gt(Ht,e);if(!t){let r=Gt(jr,e);t=new at({name:e,logLevel:r}),Gr(Ht,e,t)}return t}import{PublicKey as D}from"@solana/web3.js";var Yt=new D("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),zt=new D("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Zt=new D("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),_o=new D("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Mo=new D("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Do=new D("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Wo=new D("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Oo=new D("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Uo=new D("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),qo=new D("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Go=new D("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Ho=new D("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),jo=new D("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Yo=new D("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),zo=new D("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Zo=new D("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Xo=new D("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Jo=new D("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),Qo=new D("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),$o=new D("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2");var as=W("Raydium_farm_config"),us=new Xt("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),cs=new Xt("FrspKwj8i3pNmKwXreTveC4fu7KL5ZbGeXdZBe2XViu1"),Jt={3:$t,5:er,6:tr},Qt={3:Ke,5:rr,6:nr},ls=e=>[3,5,6].indexOf(e)!==-1,ds=e=>{var s;let{version:t,rewardInfos:r,rewardTokenAccountsPublicKeys:n}=e,i=`rewardInfo:${JSON.stringify(r)}, rewardAccount:${JSON.stringify(n)}`,o={3:()=>{if(r.length!==1||n.length!==1)return`rewardInfos or rewardTokenAccounts lengths not equal 1: ${i}`},5:()=>{if(r.length!==n.length)return`rewardInfos and rewardTokenAccounts lengths not equal: ${i}`},6:()=>{if(!n.length||r.length!==n.length)return`no rewardTokenAccounts or rewardInfos and rewardTokenAccounts lengths not equal: ${i}`}};return(s=o[t])==null?void 0:s.call(o)},ke={"Standard SPL":0,"Option tokens":1},fs={[Yt.toString()]:3,[zt.toString()]:5,[Zt.toString()]:6};var ut=K([C("instruction")]),ct=K([C("instruction")]),Yr=K([y("rewardState"),y("rewardOpenTime"),y("rewardEndTime"),y("rewardLastUpdateTime"),y("totalReward"),y("totalRewardEmissioned"),y("rewardClaimed"),y("rewardPerSecond"),ie("accRewardPerShare"),A("rewardVault"),A("rewardMint"),A("rewardSender"),y("rewardType"),E(y(),15,"padding")]),zr=K([y("state"),y("nonce"),A("lpVault"),A("rewardVault"),A(),A(),y(),y(),y("totalReward"),ie("perShareReward"),y("lastSlot"),y("perSlotReward")]),Zr=K([y("state"),y("nonce"),A("lpVault"),A("rewardVaultA"),y("totalRewardA"),ie("perShareRewardA"),y("perSlotRewardA"),C("option"),A("rewardVaultB"),me(7),y("totalRewardB"),ie("perShareRewardB"),y("perSlotRewardB"),y("lastSlot"),A()]),Xr=K([y(),y("state"),y("nonce"),y("validRewardTokenNum"),ie("rewardMultiplier"),y("rewardPeriodMax"),y("rewardPeriodMin"),y("rewardPeriodExtend"),A("lpMint"),A("lpVault"),E(Yr,5,"rewardInfos"),A("creator"),A(),E(y(),32,"padding")]),$t=new Proxy(zr,{get(e,t,r){return t==="decode"?(...n)=>{let i=e.decode(...n);return{...i,version:3,rewardInfos:[{rewardVault:i.rewardVault,totalReward:i.totalReward,perSlotReward:i.perSlotReward,perShareReward:i.perShareReward}]}}:Reflect.get(e,t,r)}}),er=new Proxy(Zr,{get(e,t,r){return t==="decode"?(...n)=>{let i=e.decode(...n);return{...i,version:5,rewardInfos:[{rewardVault:i.rewardVaultA,totalReward:i.totalRewardA,perSlotReward:i.perSlotRewardA,perShareReward:i.perShareRewardA},{rewardVault:i.rewardVaultB,totalReward:i.totalRewardB,perSlotReward:i.perSlotRewardB,perShareReward:i.perShareRewardB}]}}:Reflect.get(e,t,r)}}),tr=new Proxy(Xr,{get(e,t,r){return t==="decode"?(...n)=>{let i=e.decode(...n);return{...i,version:6,rewardInfos:i.rewardInfos.map(o=>{var s;return{...o,rewardType:((s=Object.entries(ke).find(a=>String(a[1])===o.rewardType.toString()))!=null?s:["Standard SPL"])[0]}})}}:Reflect.get(e,t,r)}}),Jr=K([y("isSet"),y("rewardPerSecond"),y("rewardOpenTime"),y("rewardEndTime"),y("rewardType")]),lt=K([C("instruction"),y("nonce"),E(Jr,5,"rewardTimeInfo")]),dt=K([C("instruction"),y("rewardReopenTime"),y("rewardEndTime"),y("rewardPerSecond")]),ft=K([C("instruction"),y("isSet"),y("rewardPerSecond"),y("rewardOpenTime"),y("rewardEndTime"),y("rewardType")]),ws=K([y("state"),A("id"),A("owner"),y("deposited"),E(y(),1,"rewardDebts")]),Ke=K([y("state"),A("id"),A("owner"),y("deposited"),E(ie(),1,"rewardDebts"),y(""),y("voteLockedBalance"),E(y(),15)]),Ps=K([y("state"),A("id"),A("owner"),y("deposited"),E(y(),2,"rewardDebts")]),rr=K([y("state"),A("id"),A("owner"),y("deposited"),E(ie(),2,"rewardDebts"),E(y(),17)]),nr=K([y(),y("state"),A("id"),A("owner"),y("deposited"),E(ie(),5,"rewardDebts"),E(y(),16)]),Y=K([C("instruction"),y("amount")]),Qr=K([A("mint"),A("grantAuthority"),y("baselineVoteWeightScaledFactor"),y("maxExtraLockupVoteWeightScaledFactor"),y("lockupSaturationSecs"),qt("digitShift"),E(C(),7,"reserved1"),E(y(),7,"reserved2")]),ir=K([me(8),A("governanceProgramId"),A("realm"),A("realmGoverningTokenMint"),A("realmAuthority"),E(C(),32,"reserved1"),E(Qr,4,"votingMints"),Oe("timeOffset"),C("bump"),E(C(),7,"reserved2"),E(y(),11,"reserved3")]),$r=K([Oe("startTime"),Oe("endTime"),C("kind"),E(C(),15,"reserved")]),en=K([E($r,1,"lockup"),y("amountDeposited_native"),y("amountInitiallyLockedNative"),Re("isUsed"),Re("allowClawback"),C("votingMintConfigIdx"),E(C(),29,"reserved")]),or=K([me(8),A("voterAuthority"),A("registrar"),E(en,32,"deposits"),C("voterBump"),C("voterWweightRecordBump"),E(C(),94,"reserved")]);import X from"bn.js";import{PublicKey as hi}from"@solana/web3.js";import{getTransferFeeConfig as Mc,unpackMint as Dc}from"@solana/spl-token";import{PublicKey as di}from"@solana/web3.js";import fi from"bn.js";import ui from"big.js";import et from"bn.js";import Z from"bn.js";var Ae=9e15,fe=1e9,pt="0123456789abcdef",qe="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Ge="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",mt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Ae,maxE:Ae,crypto:!1},cr,oe,x=!0,je="[DecimalError] ",de=je+"Invalid argument: ",lr=je+"Precision limit exceeded",dr=je+"crypto unavailable",fr="[object Decimal]",H=Math.floor,O=Math.pow,tn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,rn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,nn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,pr=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,te=1e7,P=7,on=9007199254740991,sn=qe.length-1,gt=Ge.length-1,g={toStringTag:fr};g.absoluteValue=g.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),w(e)};g.ceil=function(){return w(new this.constructor(this),this.e+1,2)};g.clampedTo=g.clamp=function(e,t){var r,n=this,i=n.constructor;if(e=new i(e),t=new i(t),!e.s||!t.s)return new i(NaN);if(e.gt(t))throw Error(de+t);return r=n.cmp(e),r<0?e:n.cmp(t)>0?t:new i(n)};g.comparedTo=g.cmp=function(e){var t,r,n,i,o=this,s=o.d,a=(e=new o.constructor(e)).d,c=o.s,u=e.s;if(!s||!a)return!c||!u?NaN:c!==u?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-u:0;if(c!==u)return c;if(o.e!==e.e)return o.e>e.e^c<0?1:-1;for(n=s.length,i=a.length,t=0,r=n<i?n:i;t<r;++t)if(s[t]!==a[t])return s[t]>a[t]^c<0?1:-1;return n===i?0:n>i^c<0?1:-1};g.cosine=g.cos=function(){var e,t,r=this,n=r.constructor;return r.d?r.d[0]?(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+P,n.rounding=1,r=an(n,hr(n,r)),n.precision=e,n.rounding=t,w(oe==2||oe==3?r.neg():r,e,t,!0)):new n(1):new n(NaN)};g.cubeRoot=g.cbrt=function(){var e,t,r,n,i,o,s,a,c,u,l=this,d=l.constructor;if(!l.isFinite()||l.isZero())return new d(l);for(x=!1,o=l.s*O(l.s*l,1/3),!o||Math.abs(o)==1/0?(r=q(l.d),e=l.e,(o=(e-r.length+1)%3)&&(r+=o==1||o==-2?"0":"00"),o=O(r,1/3),e=H((e+1)/3)-(e%3==(e<0?-1:2)),o==1/0?r="5e"+e:(r=o.toExponential(),r=r.slice(0,r.indexOf("e")+1)+e),n=new d(r),n.s=l.s):n=new d(o.toString()),s=(e=d.precision)+3;;)if(a=n,c=a.times(a).times(a),u=c.plus(l),n=V(u.plus(l).times(a),u.plus(c),s+2,1),q(a.d).slice(0,s)===(r=q(n.d)).slice(0,s))if(r=r.slice(s-3,s+1),r=="9999"||!i&&r=="4999"){if(!i&&(w(a,e+1,0),a.times(a).times(a).eq(l))){n=a;break}s+=4,i=1}else{(!+r||!+r.slice(1)&&r.charAt(0)=="5")&&(w(n,e+1,1),t=!n.times(n).times(n).eq(l));break}return x=!0,w(n,e,d.rounding,t)};g.decimalPlaces=g.dp=function(){var e,t=this.d,r=NaN;if(t){if(e=t.length-1,r=(e-H(this.e/P))*P,e=t[e],e)for(;e%10==0;e/=10)r--;r<0&&(r=0)}return r};g.dividedBy=g.div=function(e){return V(this,new this.constructor(e))};g.dividedToIntegerBy=g.divToInt=function(e){var t=this,r=t.constructor;return w(V(t,new r(e),0,1,1),r.precision,r.rounding)};g.equals=g.eq=function(e){return this.cmp(e)===0};g.floor=function(){return w(new this.constructor(this),this.e+1,3)};g.greaterThan=g.gt=function(e){return this.cmp(e)>0};g.greaterThanOrEqualTo=g.gte=function(e){var t=this.cmp(e);return t==1||t===0};g.hyperbolicCosine=g.cosh=function(){var e,t,r,n,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;r=s.precision,n=s.rounding,s.precision=r+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(e=Math.ceil(i/3),t=(1/ze(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),o=Le(s,1,o.times(t),new s(1),!0);for(var c,u=e,l=new s(8);u--;)c=o.times(o),o=a.minus(c.times(l.minus(c.times(l))));return w(o,s.precision=r,s.rounding=n,!0)};g.hyperbolicSine=g.sinh=function(){var e,t,r,n,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(t=o.precision,r=o.rounding,o.precision=t+Math.max(i.e,i.sd())+4,o.rounding=1,n=i.d.length,n<3)i=Le(o,2,i,i,!0);else{e=1.4*Math.sqrt(n),e=e>16?16:e|0,i=i.times(1/ze(5,e)),i=Le(o,2,i,i,!0);for(var s,a=new o(5),c=new o(16),u=new o(20);e--;)s=i.times(i),i=i.times(a.plus(s.times(c.times(s).plus(u))))}return o.precision=t,o.rounding=r,w(i,t,r,!0)};g.hyperbolicTangent=g.tanh=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+7,n.rounding=1,V(r.sinh(),r.cosh(),n.precision=e,n.rounding=t)):new n(r.s)};g.inverseCosine=g.acos=function(){var e,t=this,r=t.constructor,n=t.abs().cmp(1),i=r.precision,o=r.rounding;return n!==-1?n===0?t.isNeg()?ee(r,i,o):new r(0):new r(NaN):t.isZero()?ee(r,i+4,o).times(.5):(r.precision=i+6,r.rounding=1,t=t.asin(),e=ee(r,i+4,o).times(.5),r.precision=i,r.rounding=o,e.minus(t))};g.inverseHyperbolicCosine=g.acosh=function(){var e,t,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(e=n.precision,t=n.rounding,n.precision=e+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,x=!1,r=r.times(r).minus(1).sqrt().plus(r),x=!0,n.precision=e,n.rounding=t,r.ln()):new n(r)};g.inverseHyperbolicSine=g.asinh=function(){var e,t,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,x=!1,r=r.times(r).plus(1).sqrt().plus(r),x=!0,n.precision=e,n.rounding=t,r.ln())};g.inverseHyperbolicTangent=g.atanh=function(){var e,t,r,n,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=o.precision,t=o.rounding,n=i.sd(),Math.max(n,e)<2*-i.e-1?w(new o(i),e,t,!0):(o.precision=r=n-i.e,i=V(i.plus(1),new o(1).minus(i),r+e,1),o.precision=e+4,o.rounding=1,i=i.ln(),o.precision=e,o.rounding=t,i.times(.5))):new o(NaN)};g.inverseSine=g.asin=function(){var e,t,r,n,i=this,o=i.constructor;return i.isZero()?new o(i):(t=i.abs().cmp(1),r=o.precision,n=o.rounding,t!==-1?t===0?(e=ee(o,r+4,n).times(.5),e.s=i.s,e):new o(NaN):(o.precision=r+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=r,o.rounding=n,i.times(2)))};g.inverseTangent=g.atan=function(){var e,t,r,n,i,o,s,a,c,u=this,l=u.constructor,d=l.precision,f=l.rounding;if(u.isFinite()){if(u.isZero())return new l(u);if(u.abs().eq(1)&&d+4<=gt)return s=ee(l,d+4,f).times(.25),s.s=u.s,s}else{if(!u.s)return new l(NaN);if(d+4<=gt)return s=ee(l,d+4,f).times(.5),s.s=u.s,s}for(l.precision=a=d+10,l.rounding=1,r=Math.min(28,a/P+2|0),e=r;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(x=!1,t=Math.ceil(a/P),n=1,c=u.times(u),s=new l(u),i=u;e!==-1;)if(i=i.times(c),o=s.minus(i.div(n+=2)),i=i.times(c),s=o.plus(i.div(n+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===o.d[e]&&e--;);return r&&(s=s.times(2<<r-1)),x=!0,w(s,l.precision=d,l.rounding=f,!0)};g.isFinite=function(){return!!this.d};g.isInteger=g.isInt=function(){return!!this.d&&H(this.e/P)>this.d.length-2};g.isNaN=function(){return!this.s};g.isNegative=g.isNeg=function(){return this.s<0};g.isPositive=g.isPos=function(){return this.s>0};g.isZero=function(){return!!this.d&&this.d[0]===0};g.lessThan=g.lt=function(e){return this.cmp(e)<0};g.lessThanOrEqualTo=g.lte=function(e){return this.cmp(e)<1};g.logarithm=g.log=function(e){var t,r,n,i,o,s,a,c,u=this,l=u.constructor,d=l.precision,f=l.rounding,m=5;if(e==null)e=new l(10),t=!0;else{if(e=new l(e),r=e.d,e.s<0||!r||!r[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(r=u.d,u.s<0||!r||!r[0]||u.eq(1))return new l(r&&!r[0]?-1/0:u.s!=1?NaN:r?0:1/0);if(t)if(r.length>1)o=!0;else{for(i=r[0];i%10===0;)i/=10;o=i!==1}if(x=!1,a=d+m,s=le(u,a),n=t?He(l,a+10):le(e,a),c=V(s,n,a,1),Ne(c.d,i=d,f))do if(a+=10,s=le(u,a),n=t?He(l,a+10):le(e,a),c=V(s,n,a,1),!o){+q(c.d).slice(i+1,i+15)+1==1e14&&(c=w(c,d+1,0));break}while(Ne(c.d,i+=10,f));return x=!0,w(c,d,f)};g.minus=g.sub=function(e){var t,r,n,i,o,s,a,c,u,l,d,f,m=this,h=m.constructor;if(e=new h(e),!m.d||!e.d)return!m.s||!e.s?e=new h(NaN):m.d?e.s=-e.s:e=new h(e.d||m.s!==e.s?m:NaN),e;if(m.s!=e.s)return e.s=-e.s,m.plus(e);if(u=m.d,f=e.d,a=h.precision,c=h.rounding,!u[0]||!f[0]){if(f[0])e.s=-e.s;else if(u[0])e=new h(m);else return new h(c===3?-0:0);return x?w(e,a,c):e}if(r=H(e.e/P),l=H(m.e/P),u=u.slice(),o=l-r,o){for(d=o<0,d?(t=u,o=-o,s=f.length):(t=f,r=l,s=u.length),n=Math.max(Math.ceil(a/P),s)+2,o>n&&(o=n,t.length=1),t.reverse(),n=o;n--;)t.push(0);t.reverse()}else{for(n=u.length,s=f.length,d=n<s,d&&(s=n),n=0;n<s;n++)if(u[n]!=f[n]){d=u[n]<f[n];break}o=0}for(d&&(t=u,u=f,f=t,e.s=-e.s),s=u.length,n=f.length-s;n>0;--n)u[s++]=0;for(n=f.length;n>o;){if(u[--n]<f[n]){for(i=n;i&&u[--i]===0;)u[i]=te-1;--u[i],u[n]+=te}u[n]-=f[n]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--r;return u[0]?(e.d=u,e.e=Ye(u,r),x?w(e,a,c):e):new h(c===3?-0:0)};g.modulo=g.mod=function(e){var t,r=this,n=r.constructor;return e=new n(e),!r.d||!e.s||e.d&&!e.d[0]?new n(NaN):!e.d||r.d&&!r.d[0]?w(new n(r),n.precision,n.rounding):(x=!1,n.modulo==9?(t=V(r,e.abs(),0,3,1),t.s*=e.s):t=V(r,e,0,n.modulo,1),t=t.times(e),x=!0,r.minus(t))};g.naturalExponential=g.exp=function(){return yt(this)};g.naturalLogarithm=g.ln=function(){return le(this)};g.negated=g.neg=function(){var e=new this.constructor(this);return e.s=-e.s,w(e)};g.plus=g.add=function(e){var t,r,n,i,o,s,a,c,u,l,d=this,f=d.constructor;if(e=new f(e),!d.d||!e.d)return!d.s||!e.s?e=new f(NaN):d.d||(e=new f(e.d||d.s===e.s?d:NaN)),e;if(d.s!=e.s)return e.s=-e.s,d.minus(e);if(u=d.d,l=e.d,a=f.precision,c=f.rounding,!u[0]||!l[0])return l[0]||(e=new f(d)),x?w(e,a,c):e;if(o=H(d.e/P),n=H(e.e/P),u=u.slice(),i=o-n,i){for(i<0?(r=u,i=-i,s=l.length):(r=l,n=o,s=u.length),o=Math.ceil(a/P),s=o>s?o+1:s+1,i>s&&(i=s,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for(s=u.length,i=l.length,s-i<0&&(i=s,r=l,l=u,u=r),t=0;i;)t=(u[--i]=u[i]+l[i]+t)/te|0,u[i]%=te;for(t&&(u.unshift(t),++n),s=u.length;u[--s]==0;)u.pop();return e.d=u,e.e=Ye(u,n),x?w(e,a,c):e};g.precision=g.sd=function(e){var t,r=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(de+e);return r.d?(t=mr(r.d),e&&r.e+1>t&&(t=r.e+1)):t=NaN,t};g.round=function(){var e=this,t=e.constructor;return w(new t(e),e.e+1,t.rounding)};g.sine=g.sin=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+P,n.rounding=1,r=cn(n,hr(n,r)),n.precision=e,n.rounding=t,w(oe>2?r.neg():r,e,t,!0)):new n(NaN)};g.squareRoot=g.sqrt=function(){var e,t,r,n,i,o,s=this,a=s.d,c=s.e,u=s.s,l=s.constructor;if(u!==1||!a||!a[0])return new l(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);for(x=!1,u=Math.sqrt(+s),u==0||u==1/0?(t=q(a),(t.length+c)%2==0&&(t+="0"),u=Math.sqrt(t),c=H((c+1)/2)-(c<0||c%2),u==1/0?t="5e"+c:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),n=new l(t)):n=new l(u.toString()),r=(c=l.precision)+3;;)if(o=n,n=o.plus(V(s,o,r+2,1)).times(.5),q(o.d).slice(0,r)===(t=q(n.d)).slice(0,r))if(t=t.slice(r-3,r+1),t=="9999"||!i&&t=="4999"){if(!i&&(w(o,c+1,0),o.times(o).eq(s))){n=o;break}r+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(w(n,c+1,1),e=!n.times(n).eq(s));break}return x=!0,w(n,c,l.rounding,e)};g.tangent=g.tan=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+10,n.rounding=1,r=r.sin(),r.s=1,r=V(r,new n(1).minus(r.times(r)).sqrt(),e+10,0),n.precision=e,n.rounding=t,w(oe==2||oe==4?r.neg():r,e,t,!0)):new n(NaN)};g.times=g.mul=function(e){var t,r,n,i,o,s,a,c,u,l=this,d=l.constructor,f=l.d,m=(e=new d(e)).d;if(e.s*=l.s,!f||!f[0]||!m||!m[0])return new d(!e.s||f&&!f[0]&&!m||m&&!m[0]&&!f?NaN:!f||!m?e.s/0:e.s*0);for(r=H(l.e/P)+H(e.e/P),c=f.length,u=m.length,c<u&&(o=f,f=m,m=o,s=c,c=u,u=s),o=[],s=c+u,n=s;n--;)o.push(0);for(n=u;--n>=0;){for(t=0,i=c+n;i>n;)a=o[i]+m[n]*f[i-n-1]+t,o[i--]=a%te|0,t=a/te|0;o[i]=(o[i]+t)%te|0}for(;!o[--s];)o.pop();return t?++r:o.shift(),e.d=o,e.e=Ye(o,r),x?w(e,d.precision,d.rounding):e};g.toBinary=function(e,t){return ht(this,2,e,t)};g.toDecimalPlaces=g.toDP=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(z(e,0,fe),t===void 0?t=n.rounding:z(t,0,8),w(r,e+r.e+1,t))};g.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=ne(n,!0):(z(e,0,fe),t===void 0?t=i.rounding:z(t,0,8),n=w(new i(n),e+1,t),r=ne(n,!0,e+1)),n.isNeg()&&!n.isZero()?"-"+r:r};g.toFixed=function(e,t){var r,n,i=this,o=i.constructor;return e===void 0?r=ne(i):(z(e,0,fe),t===void 0?t=o.rounding:z(t,0,8),n=w(new o(i),e+i.e+1,t),r=ne(n,!1,e+n.e+1)),i.isNeg()&&!i.isZero()?"-"+r:r};g.toFraction=function(e){var t,r,n,i,o,s,a,c,u,l,d,f,m=this,h=m.d,b=m.constructor;if(!h)return new b(m);if(u=r=new b(1),n=c=new b(0),t=new b(n),o=t.e=mr(h)-m.e-1,s=o%P,t.d[0]=O(10,s<0?P+s:s),e==null)e=o>0?t:u;else{if(a=new b(e),!a.isInt()||a.lt(u))throw Error(de+a);e=a.gt(t)?o>0?t:u:a}for(x=!1,a=new b(q(h)),l=b.precision,b.precision=o=h.length*P*2;d=V(a,t,0,1,1),i=r.plus(d.times(n)),i.cmp(e)!=1;)r=n,n=i,i=u,u=c.plus(d.times(i)),c=i,i=t,t=a.minus(d.times(i)),a=i;return i=V(e.minus(r),n,0,1,1),c=c.plus(i.times(u)),r=r.plus(i.times(n)),c.s=u.s=m.s,f=V(u,n,o,1).minus(m).abs().cmp(V(c,r,o,1).minus(m).abs())<1?[u,n]:[c,r],b.precision=l,x=!0,f};g.toHexadecimal=g.toHex=function(e,t){return ht(this,16,e,t)};g.toNearest=function(e,t){var r=this,n=r.constructor;if(r=new n(r),e==null){if(!r.d)return r;e=new n(1),t=n.rounding}else{if(e=new n(e),t===void 0?t=n.rounding:z(t,0,8),!r.d)return e.s?r:e;if(!e.d)return e.s&&(e.s=r.s),e}return e.d[0]?(x=!1,r=V(r,e,0,t,1).times(e),x=!0,w(r)):(e.s=r.s,r=e),r};g.toNumber=function(){return+this};g.toOctal=function(e,t){return ht(this,8,e,t)};g.toPower=g.pow=function(e){var t,r,n,i,o,s,a=this,c=a.constructor,u=+(e=new c(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new c(O(+a,u));if(a=new c(a),a.eq(1))return a;if(n=c.precision,o=c.rounding,e.eq(1))return w(a,n,o);if(t=H(e.e/P),t>=e.d.length-1&&(r=u<0?-u:u)<=on)return i=gr(c,a,r,n),e.s<0?new c(1).div(i):w(i,n,o);if(s=a.s,s<0){if(t<e.d.length-1)return new c(NaN);if((e.d[t]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return r=O(+a,u),t=r==0||!isFinite(r)?H(u*(Math.log("0."+q(a.d))/Math.LN10+a.e+1)):new c(r+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?s/0:0):(x=!1,c.rounding=a.s=1,r=Math.min(12,(t+"").length),i=yt(e.times(le(a,n+r)),n),i.d&&(i=w(i,n+5,1),Ne(i.d,n,o)&&(t=n+10,i=w(yt(e.times(le(a,t+r)),t),t+5,1),+q(i.d).slice(n+1,n+15)+1==1e14&&(i=w(i,n+1,0)))),i.s=s,x=!0,c.rounding=o,w(i,n,o))};g.toPrecision=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=ne(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(z(e,1,fe),t===void 0?t=i.rounding:z(t,0,8),n=w(new i(n),e,t),r=ne(n,e<=n.e||n.e<=i.toExpNeg,e)),n.isNeg()&&!n.isZero()?"-"+r:r};g.toSignificantDigits=g.toSD=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(z(e,1,fe),t===void 0?t=n.rounding:z(t,0,8)),w(new n(r),e,t)};g.toString=function(){var e=this,t=e.constructor,r=ne(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+r:r};g.truncated=g.trunc=function(){return w(new this.constructor(this),this.e+1,1)};g.valueOf=g.toJSON=function(){var e=this,t=e.constructor,r=ne(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+r:r};function q(e){var t,r,n,i=e.length-1,o="",s=e[0];if(i>0){for(o+=s,t=1;t<i;t++)n=e[t]+"",r=P-n.length,r&&(o+=ce(r)),o+=n;s=e[t],n=s+"",r=P-n.length,r&&(o+=ce(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function z(e,t,r){if(e!==~~e||e<t||e>r)throw Error(de+e)}function Ne(e,t,r,n){var i,o,s,a;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=P,i=0):(i=Math.ceil((t+1)/P),t%=P),o=O(10,P-t),a=e[i]%o|0,n==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),s=r<4&&a==99999||r>3&&a==49999||a==5e4||a==0):s=(r<4&&a+1==o||r>3&&a+1==o/2)&&(e[i+1]/o/100|0)==O(10,t-2)-1||(a==o/2||a==0)&&(e[i+1]/o/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),s=(n||r<4)&&a==9999||!n&&r>3&&a==4999):s=((n||r<4)&&a+1==o||!n&&r>3&&a+1==o/2)&&(e[i+1]/o/1e3|0)==O(10,t-3)-1,s}function Ue(e,t,r){for(var n,i=[0],o,s=0,a=e.length;s<a;){for(o=i.length;o--;)i[o]*=t;for(i[0]+=pt.indexOf(e.charAt(s++)),n=0;n<i.length;n++)i[n]>r-1&&(i[n+1]===void 0&&(i[n+1]=0),i[n+1]+=i[n]/r|0,i[n]%=r)}return i.reverse()}function an(e,t){var r,n,i;if(t.isZero())return t;n=t.d.length,n<32?(r=Math.ceil(n/3),i=(1/ze(4,r)).toString()):(r=16,i="2.3283064365386962890625e-10"),e.precision+=r,t=Le(e,1,t.times(i),new e(1));for(var o=r;o--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=r,t}var V=function(){function e(n,i,o){var s,a=0,c=n.length;for(n=n.slice();c--;)s=n[c]*i+a,n[c]=s%o|0,a=s/o|0;return a&&n.unshift(a),n}function t(n,i,o,s){var a,c;if(o!=s)c=o>s?1:-1;else for(a=c=0;a<o;a++)if(n[a]!=i[a]){c=n[a]>i[a]?1:-1;break}return c}function r(n,i,o,s){for(var a=0;o--;)n[o]-=a,a=n[o]<i[o]?1:0,n[o]=a*s+n[o]-i[o];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,o,s,a,c){var u,l,d,f,m,h,b,T,k,F,B,M,ue,j,pe,Be,we,Pe,J,Te,De=n.constructor,nt=n.s==i.s?1:-1,G=n.d,v=i.d;if(!G||!G[0]||!v||!v[0])return new De(!n.s||!i.s||(G?v&&G[0]==v[0]:!v)?NaN:G&&G[0]==0||!v?nt*0:nt/0);for(c?(m=1,l=n.e-i.e):(c=te,m=P,l=H(n.e/m)-H(i.e/m)),J=v.length,we=G.length,k=new De(nt),F=k.d=[],d=0;v[d]==(G[d]||0);d++);if(v[d]>(G[d]||0)&&l--,o==null?(j=o=De.precision,s=De.rounding):a?j=o+(n.e-i.e)+1:j=o,j<0)F.push(1),h=!0;else{if(j=j/m+2|0,d=0,J==1){for(f=0,v=v[0],j++;(d<we||f)&&j--;d++)pe=f*c+(G[d]||0),F[d]=pe/v|0,f=pe%v|0;h=f||d<we}else{for(f=c/(v[0]+1)|0,f>1&&(v=e(v,f,c),G=e(G,f,c),J=v.length,we=G.length),Be=J,B=G.slice(0,J),M=B.length;M<J;)B[M++]=0;Te=v.slice(),Te.unshift(0),Pe=v[0],v[1]>=c/2&&++Pe;do f=0,u=t(v,B,J,M),u<0?(ue=B[0],J!=M&&(ue=ue*c+(B[1]||0)),f=ue/Pe|0,f>1?(f>=c&&(f=c-1),b=e(v,f,c),T=b.length,M=B.length,u=t(b,B,T,M),u==1&&(f--,r(b,J<T?Te:v,T,c))):(f==0&&(u=f=1),b=v.slice()),T=b.length,T<M&&b.unshift(0),r(B,b,M,c),u==-1&&(M=B.length,u=t(v,B,J,M),u<1&&(f++,r(B,J<M?Te:v,M,c))),M=B.length):u===0&&(f++,B=[0]),F[d++]=f,u&&B[0]?B[M++]=G[Be]||0:(B=[G[Be]],M=1);while((Be++<we||B[0]!==void 0)&&j--);h=B[0]!==void 0}F[0]||F.shift()}if(m==1)k.e=l,cr=h;else{for(d=1,f=F[0];f>=10;f/=10)d++;k.e=d+l*m-1,w(k,a?o+k.e+1:o,s,h)}return k}}();function w(e,t,r,n){var i,o,s,a,c,u,l,d,f,m=e.constructor;e:if(t!=null){if(d=e.d,!d)return e;for(i=1,a=d[0];a>=10;a/=10)i++;if(o=t-i,o<0)o+=P,s=t,l=d[f=0],c=l/O(10,i-s-1)%10|0;else if(f=Math.ceil((o+1)/P),a=d.length,f>=a)if(n){for(;a++<=f;)d.push(0);l=c=0,i=1,o%=P,s=o-P+1}else break e;else{for(l=a=d[f],i=1;a>=10;a/=10)i++;o%=P,s=o-P+i,c=s<0?0:l/O(10,i-s-1)%10|0}if(n=n||t<0||d[f+1]!==void 0||(s<0?l:l%O(10,i-s-1)),u=r<4?(c||n)&&(r==0||r==(e.s<0?3:2)):c>5||c==5&&(r==4||n||r==6&&(o>0?s>0?l/O(10,i-s):0:d[f-1])%10&1||r==(e.s<0?8:7)),t<1||!d[0])return d.length=0,u?(t-=e.e+1,d[0]=O(10,(P-t%P)%P),e.e=-t||0):d[0]=e.e=0,e;if(o==0?(d.length=f,a=1,f--):(d.length=f+1,a=O(10,P-o),d[f]=s>0?(l/O(10,i-s)%O(10,s)|0)*a:0),u)for(;;)if(f==0){for(o=1,s=d[0];s>=10;s/=10)o++;for(s=d[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(e.e++,d[0]==te&&(d[0]=1));break}else{if(d[f]+=a,d[f]!=te)break;d[f--]=0,a=1}for(o=d.length;d[--o]===0;)d.pop()}return x&&(e.e>m.maxE?(e.d=null,e.e=NaN):e.e<m.minE&&(e.e=0,e.d=[0])),e}function ne(e,t,r){if(!e.isFinite())return br(e);var n,i=e.e,o=q(e.d),s=o.length;return t?(r&&(n=r-s)>0?o=o.charAt(0)+"."+o.slice(1)+ce(n):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):i<0?(o="0."+ce(-i-1)+o,r&&(n=r-s)>0&&(o+=ce(n))):i>=s?(o+=ce(i+1-s),r&&(n=r-i-1)>0&&(o=o+"."+ce(n))):((n=i+1)<s&&(o=o.slice(0,n)+"."+o.slice(n)),r&&(n=r-s)>0&&(i+1===s&&(o+="."),o+=ce(n))),o}function Ye(e,t){var r=e[0];for(t*=P;r>=10;r/=10)t++;return t}function He(e,t,r){if(t>sn)throw x=!0,r&&(e.precision=r),Error(lr);return w(new e(qe),t,1,!0)}function ee(e,t,r){if(t>gt)throw Error(lr);return w(new e(Ge),t,r,!0)}function mr(e){var t=e.length-1,r=t*P+1;if(t=e[t],t){for(;t%10==0;t/=10)r--;for(t=e[0];t>=10;t/=10)r++}return r}function ce(e){for(var t="";e--;)t+="0";return t}function gr(e,t,r,n){var i,o=new e(1),s=Math.ceil(n/P+4);for(x=!1;;){if(r%2&&(o=o.times(t),ar(o.d,s)&&(i=!0)),r=H(r/2),r===0){r=o.d.length-1,i&&o.d[r]===0&&++o.d[r];break}t=t.times(t),ar(t.d,s)}return x=!0,o}function sr(e){return e.d[e.d.length-1]&1}function yr(e,t,r){for(var n,i=new e(t[0]),o=0;++o<t.length;)if(n=new e(t[o]),n.s)i[r](n)&&(i=n);else{i=n;break}return i}function yt(e,t){var r,n,i,o,s,a,c,u=0,l=0,d=0,f=e.constructor,m=f.rounding,h=f.precision;if(!e.d||!e.d[0]||e.e>17)return new f(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(x=!1,c=h):c=t,a=new f(.03125);e.e>-2;)e=e.times(a),d+=5;for(n=Math.log(O(2,d))/Math.LN10*2+5|0,c+=n,r=o=s=new f(1),f.precision=c;;){if(o=w(o.times(e),c,1),r=r.times(++l),a=s.plus(V(o,r,c,1)),q(a.d).slice(0,c)===q(s.d).slice(0,c)){for(i=d;i--;)s=w(s.times(s),c,1);if(t==null)if(u<3&&Ne(s.d,c-n,m,u))f.precision=c+=10,r=o=a=new f(1),l=0,u++;else return w(s,f.precision=h,m,x=!0);else return f.precision=h,s}s=a}}function le(e,t){var r,n,i,o,s,a,c,u,l,d,f,m=1,h=10,b=e,T=b.d,k=b.constructor,F=k.rounding,B=k.precision;if(b.s<0||!T||!T[0]||!b.e&&T[0]==1&&T.length==1)return new k(T&&!T[0]?-1/0:b.s!=1?NaN:T?0:b);if(t==null?(x=!1,l=B):l=t,k.precision=l+=h,r=q(T),n=r.charAt(0),Math.abs(o=b.e)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)b=b.times(e),r=q(b.d),n=r.charAt(0),m++;o=b.e,n>1?(b=new k("0."+r),o++):b=new k(n+"."+r.slice(1))}else return u=He(k,l+2,B).times(o+""),b=le(new k(n+"."+r.slice(1)),l-h).plus(u),k.precision=B,t==null?w(b,B,F,x=!0):b;for(d=b,c=s=b=V(b.minus(1),b.plus(1),l,1),f=w(b.times(b),l,1),i=3;;){if(s=w(s.times(f),l,1),u=c.plus(V(s,new k(i),l,1)),q(u.d).slice(0,l)===q(c.d).slice(0,l))if(c=c.times(2),o!==0&&(c=c.plus(He(k,l+2,B).times(o+""))),c=V(c,new k(m),l,1),t==null)if(Ne(c.d,l-h,F,a))k.precision=l+=h,u=s=b=V(d.minus(1),d.plus(1),l,1),f=w(b.times(b),l,1),i=a=1;else return w(c,k.precision=B,F,x=!0);else return k.precision=B,c;c=u,i+=2}}function br(e){return String(e.s*e.s/0)}function bt(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;n++);for(i=t.length;t.charCodeAt(i-1)===48;--i);if(t=t.slice(n,i),t){if(i-=n,e.e=r=r-n-1,e.d=[],n=(r+1)%P,r<0&&(n+=P),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=P;n<i;)e.d.push(+t.slice(n,n+=P));t=t.slice(n),n=P-t.length}else n-=i;for(;n--;)t+="0";e.d.push(+t),x&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function un(e,t){var r,n,i,o,s,a,c,u,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),pr.test(t))return bt(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(rn.test(t))r=16,t=t.toLowerCase();else if(tn.test(t))r=2;else if(nn.test(t))r=8;else throw Error(de+t);for(o=t.search(/p/i),o>0?(c=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),o=t.indexOf("."),s=o>=0,n=e.constructor,s&&(t=t.replace(".",""),a=t.length,o=a-o,i=gr(n,new n(r),o,o*2)),u=Ue(t,r,te),l=u.length-1,o=l;u[o]===0;--o)u.pop();return o<0?new n(e.s*0):(e.e=Ye(u,l),e.d=u,x=!1,s&&(e=V(e,i,a*4)),c&&(e=e.times(Math.abs(c)<54?O(2,c):Ze.pow(2,c))),x=!0,e)}function cn(e,t){var r,n=t.d.length;if(n<3)return t.isZero()?t:Le(e,2,t,t);r=1.4*Math.sqrt(n),r=r>16?16:r|0,t=t.times(1/ze(5,r)),t=Le(e,2,t,t);for(var i,o=new e(5),s=new e(16),a=new e(20);r--;)i=t.times(t),t=t.times(o.plus(i.times(s.times(i).minus(a))));return t}function Le(e,t,r,n,i){var o,s,a,c,u=1,l=e.precision,d=Math.ceil(l/P);for(x=!1,c=r.times(r),a=new e(n);;){if(s=V(a.times(c),new e(t++*t++),l,1),a=i?n.plus(s):n.minus(s),n=V(s.times(c),new e(t++*t++),l,1),s=a.plus(n),s.d[d]!==void 0){for(o=d;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=n,n=s,s=o,u++}return x=!0,s.d.length=d+1,s}function ze(e,t){for(var r=e;--t;)r*=e;return r}function hr(e,t){var r,n=t.s<0,i=ee(e,e.precision,1),o=i.times(.5);if(t=t.abs(),t.lte(o))return oe=n?4:1,t;if(r=t.divToInt(i),r.isZero())oe=n?3:2;else{if(t=t.minus(r.times(i)),t.lte(o))return oe=sr(r)?n?2:3:n?4:1,t;oe=sr(r)?n?1:4:n?3:2}return t.minus(i).abs()}function ht(e,t,r,n){var i,o,s,a,c,u,l,d,f,m=e.constructor,h=r!==void 0;if(h?(z(r,1,fe),n===void 0?n=m.rounding:z(n,0,8)):(r=m.precision,n=m.rounding),!e.isFinite())l=br(e);else{for(l=ne(e),s=l.indexOf("."),h?(i=2,t==16?r=r*4-3:t==8&&(r=r*3-2)):i=t,s>=0&&(l=l.replace(".",""),f=new m(1),f.e=l.length-s,f.d=Ue(ne(f),10,i),f.e=f.d.length),d=Ue(l,10,i),o=c=d.length;d[--c]==0;)d.pop();if(!d[0])l=h?"0p+0":"0";else{if(s<0?o--:(e=new m(e),e.d=d,e.e=o,e=V(e,f,r,n,0,i),d=e.d,o=e.e,u=cr),s=d[r],a=i/2,u=u||d[r+1]!==void 0,u=n<4?(s!==void 0||u)&&(n===0||n===(e.s<0?3:2)):s>a||s===a&&(n===4||u||n===6&&d[r-1]&1||n===(e.s<0?8:7)),d.length=r,u)for(;++d[--r]>i-1;)d[r]=0,r||(++o,d.unshift(1));for(c=d.length;!d[c-1];--c);for(s=0,l="";s<c;s++)l+=pt.charAt(d[s]);if(h){if(c>1)if(t==16||t==8){for(s=t==16?4:3,--c;c%s;c++)l+="0";for(d=Ue(l,i,t),c=d.length;!d[c-1];--c);for(s=1,l="1.";s<c;s++)l+=pt.charAt(d[s])}else l=l.charAt(0)+"."+l.slice(1);l=l+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)l="0"+l;l="0."+l}else if(++o>c)for(o-=c;o--;)l+="0";else o<c&&(l=l.slice(0,o)+"."+l.slice(o))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return e.s<0?"-"+l:l}function ar(e,t){if(e.length>t)return e.length=t,!0}function ln(e){return new this(e).abs()}function dn(e){return new this(e).acos()}function fn(e){return new this(e).acosh()}function pn(e,t){return new this(e).plus(t)}function mn(e){return new this(e).asin()}function gn(e){return new this(e).asinh()}function yn(e){return new this(e).atan()}function bn(e){return new this(e).atanh()}function hn(e,t){e=new this(e),t=new this(t);var r,n=this.precision,i=this.rounding,o=n+4;return!e.s||!t.s?r=new this(NaN):!e.d&&!t.d?(r=ee(this,o,1).times(t.s>0?.25:.75),r.s=e.s):!t.d||e.isZero()?(r=t.s<0?ee(this,n,i):new this(0),r.s=e.s):!e.d||t.isZero()?(r=ee(this,o,1).times(.5),r.s=e.s):t.s<0?(this.precision=o,this.rounding=1,r=this.atan(V(e,t,o,1)),t=ee(this,o,1),this.precision=n,this.rounding=i,r=e.s<0?r.minus(t):r.plus(t)):r=this.atan(V(e,t,o,1)),r}function wn(e){return new this(e).cbrt()}function Pn(e){return w(e=new this(e),e.e+1,2)}function Tn(e,t,r){return new this(e).clamp(t,r)}function xn(e){if(!e||typeof e!="object")throw Error(je+"Object expected");var t,r,n,i=e.defaults===!0,o=["precision",1,fe,"rounding",0,8,"toExpNeg",-Ae,0,"toExpPos",0,Ae,"maxE",0,Ae,"minE",-Ae,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(r=o[t],i&&(this[r]=mt[r]),(n=e[r])!==void 0)if(H(n)===n&&n>=o[t+1]&&n<=o[t+2])this[r]=n;else throw Error(de+r+": "+n);if(r="crypto",i&&(this[r]=mt[r]),(n=e[r])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[r]=!0;else throw Error(dr);else this[r]=!1;else throw Error(de+r+": "+n);return this}function Sn(e){return new this(e).cos()}function kn(e){return new this(e).cosh()}function wr(e){var t,r,n;function i(o){var s,a,c,u=this;if(!(u instanceof i))return new i(o);if(u.constructor=i,ur(o)){u.s=o.s,x?!o.d||o.e>i.maxE?(u.e=NaN,u.d=null):o.e<i.minE?(u.e=0,u.d=[0]):(u.e=o.e,u.d=o.d.slice()):(u.e=o.e,u.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){u.s=1/o<0?-1:1,u.e=0,u.d=[0];return}if(o<0?(o=-o,u.s=-1):u.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;x?s>i.maxE?(u.e=NaN,u.d=null):s<i.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[o]):(u.e=s,u.d=[o]);return}else if(o*0!==0){o||(u.s=NaN),u.e=NaN,u.d=null;return}return bt(u,o.toString())}else if(c!=="string")throw Error(de+o);return(a=o.charCodeAt(0))===45?(o=o.slice(1),u.s=-1):(a===43&&(o=o.slice(1)),u.s=1),pr.test(o)?bt(u,o):un(u,o)}if(i.prototype=g,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=xn,i.clone=wr,i.isDecimal=ur,i.abs=ln,i.acos=dn,i.acosh=fn,i.add=pn,i.asin=mn,i.asinh=gn,i.atan=yn,i.atanh=bn,i.atan2=hn,i.cbrt=wn,i.ceil=Pn,i.clamp=Tn,i.cos=Sn,i.cosh=kn,i.div=An,i.exp=Ln,i.floor=In,i.hypot=Bn,i.ln=Rn,i.log=Kn,i.log10=Cn,i.log2=Nn,i.max=Vn,i.min=Fn,i.mod=vn,i.mul=En,i.pow=_n,i.random=Mn,i.round=Dn,i.sign=Wn,i.sin=On,i.sinh=Un,i.sqrt=qn,i.sub=Gn,i.sum=Hn,i.tan=jn,i.tanh=Yn,i.trunc=zn,e===void 0&&(e={}),e&&e.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function An(e,t){return new this(e).div(t)}function Ln(e){return new this(e).exp()}function In(e){return w(e=new this(e),e.e+1,3)}function Bn(){var e,t,r=new this(0);for(x=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)r.d&&(r=r.plus(t.times(t)));else{if(t.s)return x=!0,new this(1/0);r=t}return x=!0,r.sqrt()}function ur(e){return e instanceof Ze||e&&e.toStringTag===fr||!1}function Rn(e){return new this(e).ln()}function Kn(e,t){return new this(e).log(t)}function Nn(e){return new this(e).log(2)}function Cn(e){return new this(e).log(10)}function Vn(){return yr(this,arguments,"lt")}function Fn(){return yr(this,arguments,"gt")}function vn(e,t){return new this(e).mod(t)}function En(e,t){return new this(e).mul(t)}function _n(e,t){return new this(e).pow(t)}function Mn(e){var t,r,n,i,o=0,s=new this(1),a=[];if(e===void 0?e=this.precision:z(e,1,fe),n=Math.ceil(e/P),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(n));o<n;)i=t[o],i>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(n*=4);o<n;)i=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((t[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(t,o):(a.push(i%1e7),o+=4);o=n/4}else throw Error(dr);else for(;o<n;)a[o++]=Math.random()*1e7|0;for(n=a[--o],e%=P,n&&e&&(i=O(10,P-e),a[o]=(n/i|0)*i);a[o]===0;o--)a.pop();if(o<0)r=0,a=[0];else{for(r=-1;a[0]===0;r-=P)a.shift();for(n=1,i=a[0];i>=10;i/=10)n++;n<P&&(r-=P-n)}return s.e=r,s.d=a,s}function Dn(e){return w(e=new this(e),e.e+1,this.rounding)}function Wn(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function On(e){return new this(e).sin()}function Un(e){return new this(e).sinh()}function qn(e){return new this(e).sqrt()}function Gn(e,t){return new this(e).sub(t)}function Hn(){var e=0,t=arguments,r=new this(t[e]);for(x=!1;r.s&&++e<t.length;)r=r.plus(t[e]);return x=!0,w(r,this.precision,this.rounding)}function jn(e){return new this(e).tan()}function Yn(e){return new this(e).tanh()}function zn(e){return w(e=new this(e),e.e+1,1)}g[Symbol.for("nodejs.util.inspect.custom")]=g.toString;g[Symbol.toStringTag]="Decimal";var Ze=g.constructor=wr(mt);qe=new Ze(qe);Ge=new Ze(Ge);import{PublicKey as xt}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Zn}from"@solana/spl-token";import{PublicKey as _,SystemProgram as Tr,SYSVAR_RENT_PUBKEY as Xn}from"@solana/web3.js";function p({pubkey:e,isSigner:t=!1,isWritable:r=!0}){return{pubkey:e,isWritable:r,isSigner:t}}var wt=[p({pubkey:Zn,isWritable:!1}),p({pubkey:Tr.programId,isWritable:!1}),p({pubkey:Xn,isWritable:!1})];function xr({publicKey:e,transformSol:t}){let r=Pt(e.toString());if(r instanceof _)return t&&r.equals(ge)?Pr:r;if(t&&r.toString()===ge.toBase58())return Pr;if(typeof r=="string"){if(r===_.default.toBase58())return _.default;try{return new _(r)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Pt(e){try{return new _(e)}catch{return e}}var Ls=new _("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Is=new _("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Tt=new _("SysvarRent111111111111111111111111111111111"),Bs=new _("SysvarC1ock11111111111111111111111111111111"),Rs=new _("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Xe=new _("Sysvar1nstructions1111111111111111111111111"),Ks=Tr.programId,Ns=new _("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Cs=new _("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Vs=new _("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),Fs=new _("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),vs=new _("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Es=new _("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),_s=new _("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Ms=new _("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Ds=new _("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Ws=new _("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Os=new _("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Pr=new _("So11111111111111111111111111111111111111112"),ge=_.default;import{PublicKey as Jn}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Sr}from"@solana/spl-token";var kr={chainId:101,address:Jn.default.toBase58(),programId:Sr.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},ye={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Sr.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var St=class{constructor({mint:t,decimals:r,symbol:n,name:i,skipMint:o=!1,isToken2022:s=!1}){if(t===ge.toBase58()||t instanceof xt&&ge.equals(t)){this.decimals=ye.decimals,this.symbol=ye.symbol,this.name=ye.name,this.mint=new xt(ye.address),this.isToken2022=!1;return}this.decimals=r,this.symbol=n||t.toString().substring(0,6),this.name=i||t.toString().substring(0,6),this.mint=o?xt.default:xr({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},be=St;be.WSOL=new St({...ye,mint:ye.address});import Qe from"big.js";import ei from"bn.js";import ti from"decimal.js-light";import Qn from"toformat";var $n=Qn,Ce=$n;var Je=W("module/fraction"),kt=Ce(Qe),Ve=Ce(ti),ri={[0]:Ve.ROUND_DOWN,[1]:Ve.ROUND_HALF_UP,[2]:Ve.ROUND_UP},ni={[0]:Qe.roundDown,[1]:Qe.roundHalfUp,[2]:Qe.roundUp},N=class{constructor(t,r=new ei(1)){this.numerator=R(t),this.denominator=R(r)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new N(this.denominator,this.numerator)}add(t){let r=t instanceof N?t:new N(R(t));return this.denominator.eq(r.denominator)?new N(this.numerator.add(r.numerator),this.denominator):new N(this.numerator.mul(r.denominator).add(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}sub(t){let r=t instanceof N?t:new N(R(t));return this.denominator.eq(r.denominator)?new N(this.numerator.sub(r.numerator),this.denominator):new N(this.numerator.mul(r.denominator).sub(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}mul(t){let r=t instanceof N?t:new N(R(t));return new N(this.numerator.mul(r.numerator),this.denominator.mul(r.denominator))}div(t){let r=t instanceof N?t:new N(R(t));return new N(this.numerator.mul(r.denominator),this.denominator.mul(r.numerator))}toSignificant(t,r={groupSeparator:""},n=1){Number.isInteger(t)||Je.logWithError(`${t} is not an integer.`),t<=0&&Je.logWithError(`${t} is not positive.`),Ve.set({precision:t+1,rounding:ri[n]});let i=new Ve(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return i.toFormat(i.decimalPlaces(),r)}toFixed(t,r={groupSeparator:""},n=1){return Number.isInteger(t)||Je.logWithError(`${t} is not an integer.`),t<0&&Je.logWithError(`${t} is negative.`),kt.DP=t,kt.RM=ni[n]||1,new kt(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,r)}isZero(){return this.numerator.isZero()}};var oi=W("Raydium_price"),se=class extends N{constructor(r){let{baseToken:n,quoteToken:i,numerator:o,denominator:s}=r;super(o,s);this.baseToken=n,this.quoteToken=i,this.scalar=new N(At(n.decimals),At(i.decimals))}get raw(){return new N(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new se({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(r){this.quoteToken!==r.baseToken&&oi.logWithError("mul token not equals");let n=super.mul(r);return new se({baseToken:this.baseToken,quoteToken:r.quoteToken,denominator:n.denominator,numerator:n.numerator})}toSignificant(r=this.quoteToken.decimals,n,i){return this.adjusted.toSignificant(r,n,i)}toFixed(r=this.quoteToken.decimals,n,i){return this.adjusted.toFixed(r,n,i)}};var Lt=class{constructor({decimals:t,symbol:r="UNKNOWN",name:n="UNKNOWN"}){this.decimals=t,this.symbol=r,this.name=n}equals(t){return this===t}},$e=Lt;$e.SOL=new Lt(kr);import si from"bn.js";var Ar=new N(new si(100)),Ie=class extends N{toSignificant(t=5,r,n){return this.mul(Ar).toSignificant(t,r,n)}toFixed(t=2,r,n){return this.mul(Ar).toFixed(t,r,n)}};var ai=new Z(0),Ma=new Z(1),Da=new Z(2),Wa=new Z(3),Oa=new Z(5),It=new Z(10),Ua=new Z(100),qa=new Z(1e3),Ga=new Z(1e4),Lr=9007199254740991;function R(e){let t=W("Raydium_parseBigNumberish");if(e instanceof Z)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new Z(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=Lr||e<=-Lr)&&t.logWithError(`BigNumberish number overflow: ${e}`),new Z(String(e))):typeof e=="bigint"?new Z(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new Z(0))}function At(e){return It.pow(R(e))}var ci=W("Raydium_amount"),Br=Ce(ui);function li(e,t){let r="0",n="0";if(e.includes(".")){let i=e.split(".");i.length===2?([r,n]=i,n=n.padEnd(t,"0")):ci.logWithError(`invalid number string, num: ${e}`)}else r=e;return[r,n.slice(0,t)||n]}var ae=class extends N{constructor(r,n,i=!0,o){let s=new et(0),a=It.pow(new et(r.decimals));if(i)s=R(n);else{let c=new et(0),u=new et(0);if(typeof n=="string"||typeof n=="number"||typeof n=="bigint"){let[l,d]=li(n.toString(),r.decimals);c=R(l),u=R(d)}c=c.mul(a),s=c.add(u)}super(s,a);this.logger=W(o||"TokenAmount"),this.token=r}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(r){return this.token.equals(r.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(r.raw)}lt(r){return this.token.equals(r.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(r.raw)}add(r){return this.token.equals(r.token)||this.logger.logWithError("add token not equals"),new ae(this.token,this.raw.add(r.raw))}subtract(r){return this.token.equals(r.token)||this.logger.logWithError("sub token not equals"),new ae(this.token,this.raw.sub(r.raw))}toSignificant(r=this.token.decimals,n,i=0){return super.toSignificant(r,n,i)}toFixed(r=this.token.decimals,n,i=0){return r>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(r,n,i)}toExact(r={groupSeparator:""}){return Br.DP=this.token.decimals,new Br(this.numerator.toString()).div(this.denominator.toString()).toFormat(r)}};function Ir(e){return typeof e=="object"&&e!==null&&![be,ae,di,N,fi,se,Ie].some(t=>typeof t=="object"&&e instanceof t)}function tt(e){return typeof e=="string"?Pt(e):Array.isArray(e)?e.map(t=>tt(t)):Ir(e)?Object.fromEntries(Object.entries(e).map(([t,r])=>[t,tt(r)])):e}import{PublicKey as ju,sendAndConfirmTransaction as Yu,Transaction as Zu,TransactionMessage as Ju,VersionedTransaction as Qu}from"@solana/web3.js";import ec from"axios";var Fe={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut"};import{PublicKey as pi,ComputeBudgetProgram as wu,Transaction as Tu,TransactionMessage as Su,Keypair as ku,VersionedTransaction as Lu}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Bu}from"@solana/spl-token";var Nu=W("Raydium_txUtil");function Q(e,t){let[r,n]=pi.findProgramAddressSync(e,t);return{publicKey:r,nonce:n}}import{PublicKey as mi,AddressLookupTableAccount as Rr}from"@solana/web3.js";var gi={"2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17":new Rr({key:new mi("2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17"),state:Rr.deserialize(Buffer.from("AQAAAP//////////d49+DAAAAAAAAQZMWvw7GUNJdaccNBVnb57OKakxL2BHLYvhRwVILRsgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAABt324ddloZPZy+FGzut5rBy0he1fWzeROoz1hX7/AKkG3fbh7nWP3hhCXbzkbM3athr8TYO5DSf+vfko2KGL/AVKU1D4XciC1hSlVnJ4iilt3x6rq9CmBniISTL07vagBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvDQdRqCgtphMF/imcN7mY5YRx2xE1A3MQ+L4QRaYK9u4GRfZP3LsAd00a+IkCpA22UNQMKdq5BFbJuwuOLqc8zxCTDlqxBG8J0HcxtfogQHDK06ukzfaXiNDKAob1MqBHS9lJxDYCwz8gd5DtFqNSTKG5l1zxIaKpDP/sffi2is1H9aKveyXSu5StXElYRl9SD5As0DHE4N0GLnf84/siiKXVyp4Ez121kLcUui/jLLFZEz/BwZK3Ilf9B9OcsEAeDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu9N9LMnrw/JNO0hqMVB4rk/2ou4AB1loQ7FZoPwut2o4KZB+0p9xnbrQKw038qjpHar+PyDwvxBRcu5hpHw3dguezeWv+IwvgW5icu8EGkhGa9AkFPPJT7VMSFb8xowveU=","base64"))})};function Bt(e,t=1,r=[]){let n=[...e];if(t<=0)return r;for(;n.length;)r.push(n.splice(0,t));return r}var Nr=e=>typeof e=="number";function Cr(e,t,r){let n=Nr(t)?t*((r==null?void 0:r.unit)==="s"?1e3:1):t;return new Date(e).getTime()<=+n}function Vr(e,t,r){let n=Nr(t)?t*((r==null?void 0:r.unit)==="s"?1e3:1):t;return new Date(e).getTime()>+n}import{PublicKey as yi}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as bi}from"@solana/spl-token";function ve(e,t,r){return Q([e.toBuffer(),(r!=null?r:bi).toBuffer(),t.toBuffer()],new yi("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}import mc from"bn.js";var Rt=W("Raydium_accountInfo_util");async function Kr(e,t,r){let{batchRequest:n,commitment:i="confirmed"}={batchRequest:!1,...r},o=Bt(t,100),s=new Array(o.length).fill([]);if(n){let a=o.map(l=>{let d=e._buildArgs([l.map(f=>f.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:d}}),c=Bt(a,10);s=(await(await Promise.all(c.map(async l=>await e._rpcBatchRequest(l)))).flat()).map(l=>(l.error&&Rt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${l.error.message}`),l.result.value.map(d=>{if(d){let{data:f,executable:m,lamports:h,owner:b,rentEpoch:T}=d;return f.length!==2&&f[1]!=="base64"&&Rt.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(f[0],"base64"),executable:m,lamports:h,owner:new hi(b),rentEpoch:T}}return null})))}else try{s=await Promise.all(o.map(a=>e.getMultipleAccountsInfo(a,i)))}catch(a){a instanceof Error&&Rt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${a.message}`)}return s.flat()}async function Fr(e,t,r){let n=await Kr(e,t.map(i=>i.pubkey),r);return t.map((i,o)=>({...i,accountInfo:n[o]}))}var Kt=K([A("mint"),A("owner"),y("amount"),Se("delegateOption"),A("delegate"),C("state"),Se("isNativeOption"),y("isNative"),y("delegatedAmount"),Se("closeAuthorityOption"),A("closeAuthority")]);var Ee=W("Raydium.farm.util");function il({programId:e,poolId:t,mint:r,type:n}){let{publicKey:i}=Q([t.toBuffer(),r.toBuffer(),Buffer.from(n==="lpVault"?"lp_vault_associated_seed":n==="rewardVault"?"reward_vault_associated_seed":"","utf-8")],e);return i}function re({programId:e,poolId:t,owner:r,version:n}){let{publicKey:i}=Q([t.toBuffer(),r.toBuffer(),Buffer.from(n===6?"farmer_info_associated_seed":"staker_info_v2_associated_seed","utf-8")],e);return i}var ol=({programId:e,poolId:t})=>Q([t.toBuffer()],e);function sl(e){return{isSet:new X(1),rewardPerSecond:R(e.perSecond),rewardOpenTime:R(e.openTime),rewardEndTime:R(e.endTime),rewardType:R(ke[e.rewardType])}}function al(e){return R(e.endTime).sub(R(e.openTime)).mul(R(e.perSecond))}function wi(e){let t=Qt[e];return t||Ee.logWithError("invalid version",e),t}function Pi(e){let t=Jt[e];return t||Ee.logWithError("invalid version",e),t}function Ti(e,t,r,n){if(e.version===3||e.version===5){if(e.lastSlot.gte(new X(r)))return e;let i=new X(r).sub(e.lastSlot);e.lastSlot=new X(r);for(let o of e.rewardInfos){if(t.amount.eq(new X(0)))continue;let s=o.perSlotReward.mul(i);o.perShareReward=o.perShareReward.add(s.mul(new X(10).pow(new X(e.version===3?9:15))).div(t.amount)),o.totalReward=o.totalReward.add(s)}}else if(e.version===6)for(let i of e.rewardInfos){if(i.rewardState.eq(new X(0)))continue;let o=X.min(new X(n),i.rewardEndTime);if(i.rewardOpenTime.gte(o))continue;let a=o.sub(i.rewardLastUpdateTime).mul(i.rewardPerSecond),c=i.totalReward.sub(i.totalRewardEmissioned);c.lt(a)?(a=c,i.rewardLastUpdateTime=i.rewardLastUpdateTime.add(c.div(i.rewardPerSecond))):i.rewardLastUpdateTime=o,!t.amount.eq(new X(0))&&(i.accRewardPerShare=i.accRewardPerShare.add(a.mul(e.rewardMultiplier).div(t.amount)),i.totalRewardEmissioned=i.totalRewardEmissioned.add(a))}return e}async function ul({connection:e,farmPools:t,owner:r,config:n,chainTime:i}){let o=!1,s=!1,a=new X(10),c=[];for(let f of t){let m=tt(f);m.version===6?s=!0:o=!0,c.push({pubkey:m.id,version:m.version,key:"state",poolId:m.id},{pubkey:m.lpVault,version:m.version,key:"lpVault",poolId:m.id}),r&&c.push({pubkey:re({programId:m.programId,poolId:m.id,owner:r,version:f.version}),version:m.version,key:"ledger",poolId:m.id})}let u={},l=await Fr(e,c,n);for(let{pubkey:f,version:m,key:h,poolId:b,accountInfo:T}of l){let k=b.toBase58();if(u[k]={...u[k]},h==="state"){let F=Pi(m);(!T||!T.data||T.data.length!==F.span)&&Ee.logWithError(`invalid farm state account info, pools.id, ${f}`),u[k].state=F.decode(T.data)}else if(h==="lpVault")(!T||!T.data||T.data.length!==Kt.span)&&Ee.logWithError(`invalid farm lp vault account info, pools.lpVault, ${f}`),u[k].lpVault=Kt.decode(T.data);else if(h==="ledger"){let F=wi(m);T&&T.data&&(T.data.length!==F.span&&Ee.logWithError(`invalid farm ledger account info, ledger, ${f}`),u[k].ledger=F.decode(T.data))}}let d=s||o?await e.getSlot():0;for(let f of Object.keys(u))u[f]!==void 0&&(u[f].state=Ti(u[f].state,u[f].lpVault,d,i));for(let[f,{state:m,ledger:h}]of Object.entries(u))if(h){let b=m.version===6?m.rewardMultiplier:m.rewardInfos.length===1?a.pow(new X(9)):a.pow(new X(15)),T=m.rewardInfos.map((k,F)=>{let B=h.rewardDebts[F];return h.deposited.mul(m.version===6?k.accRewardPerShare:k.perShareReward).div(b).sub(B)});u[f].wrapped={...u[f].wrapped,pendingRewards:T}}return u}function cl(e,t=Date.now()){if(e.version===6){let r=e.state.rewardInfos;if(r.every(({rewardOpenTime:n})=>Cr(t,n.toNumber(),{unit:"s"})))return"upcoming pool";if(r.every(({rewardEndTime:n})=>Vr(t,n.toNumber(),{unit:"s"})))return"closed pool"}else{let r=e.state.rewardInfos.map(({perSlotReward:n})=>n);if(r.length===2){if(String(r[0])==="0"&&String(r[1])!=="0")return"normal fusion pool";if(String(r[0])!=="0"&&String(r[1])!=="0")return"dual fusion pool";if(String(r[0])==="0"&&String(r[1])==="0")return"closed pool"}else if(r.length===1&&String(r[0])==="0")return"closed pool"}}async function Nt(e,t,r,n){let i=await e.getAccountInfo(t);if(i===null)throw Error("registrar info check error");let s=ir.decode(i.data).votingMints.findIndex(l=>l.mint.equals(n));if(s===-1)throw Error("find voter mint error");let a=await e.getAccountInfo(r);if(a===null)return{index:s,isInit:!1};let u=or.decode(a.data).deposits.findIndex(l=>l.isUsed&&l.votingMintConfigIdx===s);return u===-1?{index:s,isInit:!1}:{index:u,isInit:!0}}import{PublicKey as S,SystemProgram as he,SYSVAR_RENT_PUBKEY as xi,SYSVAR_CLOCK_PUBKEY as _e,TransactionInstruction as U}from"@solana/web3.js";import{createAssociatedTokenAccountInstruction as Si,TOKEN_PROGRAM_ID as $,ASSOCIATED_TOKEN_PROGRAM_ID as ki}from"@solana/spl-token";import rt from"bn.js";function Ct(e,t,r){return Q([t.toBuffer(),Buffer.from("registrar","utf8"),r.toBuffer()],e)}function Vt(e,t){return Q([t.toBuffer(),Buffer.from("voting_mint_seed","utf8")],e)}function Ft(e,t){return Q([t.toBuffer()],e)}function vt(e,t,r){return Q([t.toBuffer(),Buffer.from("voter","utf8"),r.toBuffer()],e)}function Et(e,t,r){return Q([t.toBuffer(),Buffer.from("voter-weight-record","utf8"),r.toBuffer()],e)}function _t(e,t,r,n){return Q([Buffer.from("governance","utf8"),t.toBuffer(),r.toBuffer(),n.toBuffer()],e)}var Ai=W("Raydium_farm_instruction"),Me={voterStakeRegistryCreateVoter:Buffer.from([6,24,245,52,243,255,148,25]),voterStakeRegistryCreateDepositEntry:Buffer.from([185,131,167,186,159,125,19,67]),voterStakeRegistryDeposit:Buffer.from([242,35,198,137,82,225,242,182]),voterStakeRegistryWithdraw:Buffer.from([183,18,70,156,148,109,161,34]),voterStakeRegistryUpdateVoterWeightRecord:Buffer.from([45,185,3,36,109,190,115,169])};function Bl(e){let{version:t,id:r,ledger:n,programId:i,owner:o}=e,s={3:9,5:10}[t];s||Ai.logWithError(`invalid farm pool version: ${t}`);let a=Buffer.alloc(ut.span);ut.encode({instruction:s},a);let c=[p({pubkey:r}),p({pubkey:n}),p({pubkey:o,isWritable:!1}),p({pubkey:he.programId,isWritable:!1}),p({pubkey:xi,isWritable:!1})];return{instruction:new U({programId:i,keys:c,data:a}),instructionType:Fe.FarmV3CreateLedger}}function Rl(e){var n;let t=Buffer.alloc(lt.span);lt.encode({instruction:0,nonce:new rt(e.nonce),rewardTimeInfo:e.rewardInfoConfig},t);let r=[...wt,p({pubkey:e.farmId}),p({pubkey:e.farmAuthority,isWritable:!1}),p({pubkey:e.lpVault}),p({pubkey:e.lpMint,isWritable:!1}),p({pubkey:e.lockVault}),p({pubkey:e.lockMint,isWritable:!1}),p({pubkey:(n=e.lockUserAccount)!=null?n:ge}),p({pubkey:e.owner,isWritable:!1,isSigner:!0})];for(let i of e.rewardInfo)r.push(p({pubkey:i.rewardMint,isWritable:!1}),p({pubkey:i.rewardVault}),p({pubkey:i.userRewardToken}));return{instruction:new U({programId:e.programId,keys:r,data:t}),instructionType:Fe.FarmV6Create}}function Kl(e){let t=Buffer.alloc(ct.span);ct.encode({instruction:5},t);let r=[p({pubkey:$,isWritable:!1}),p({pubkey:e.id}),p({pubkey:e.authority,isWritable:!1}),p({pubkey:e.lpVault,isWritable:!1}),p({pubkey:e.rewardVault}),p({pubkey:e.userRewardToken}),p({pubkey:e.owner,isWritable:!1,isSigner:!0})];return{instruction:new U({programId:e.programId,keys:r,data:t}),instructionType:Fe.FarmV6CreatorWithdraw}}function Li(e,t,r,n,i,o,s,a,c,u,l,d,f){let m=K([C("depositEntryIndex"),y("amount")]),h=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:$,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:Xe,isSigner:!1,isWritable:!1}],b=Buffer.alloc(m.span);m.encode({depositEntryIndex:d,amount:f},b);let T=Buffer.from([...Me.voterStakeRegistryDeposit,...b]);return new U({keys:h,programId:e,data:T})}function Ii(e,t,r,n){let i=K([]),o=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:he.programId,isSigner:!1,isWritable:!1}],s=Buffer.alloc(i.span);i.encode({},s);let a=Buffer.from([...Me.voterStakeRegistryUpdateVoterWeightRecord,...s]);return new U({keys:o,programId:e,data:a})}function Bi(e,t,r,n,i,o,s,a,c,u,l,d,f,m,h){let b=K([C("depositEntryIndex"),y("amount")]),T=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:$,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:Xe,isSigner:!1,isWritable:!1}],k=Buffer.alloc(b.span);b.encode({depositEntryIndex:m,amount:h},k);let F=Buffer.from([...Me.voterStakeRegistryWithdraw,...k]);return new U({keys:T,programId:e,data:F})}function Ri(e,t,r,n,i,o){let s=K([C("ins")]),a=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!0,isWritable:!0},{pubkey:he.programId,isSigner:!1,isWritable:!1}],c=Buffer.alloc(s.span);return s.encode({ins:23},c),new U({keys:a,programId:e,data:c})}function Ki(e,t,r,n,i,o,s,a){let c=K([C("voterBump"),C("voterWeightRecordBump")]),u=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!0,isWritable:!0},{pubkey:he.programId,isSigner:!1,isWritable:!1},{pubkey:Tt,isSigner:!1,isWritable:!1},{pubkey:Xe,isSigner:!1,isWritable:!1}],l=Buffer.alloc(c.span);c.encode({voterBump:s,voterWeightRecordBump:a},l);let d=Buffer.from([...Me.voterStakeRegistryCreateVoter,...l]);return new U({keys:u,programId:e,data:d})}function Ni(e,t,r,n,i,o,s,a,c,u,l,d){let f=K([C("depositEntryIndex"),C("kind"),C("option"),y("startTs"),Se("periods"),Re("allowClawback")]),m=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!0,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:he.programId,isSigner:!1,isWritable:!1},{pubkey:$,isSigner:!1,isWritable:!1},{pubkey:ki,isSigner:!1,isWritable:!1},{pubkey:Tt,isSigner:!1,isWritable:!1}],h=Buffer.alloc(f.span);f.encode({depositEntryIndex:a,kind:c,option:u===void 0?0:1,startTs:u,periods:l,allowClawback:d},h);let b=Buffer.from([...Me.voterStakeRegistryCreateDepositEntry,...h]);return new U({keys:m,programId:e,data:b})}async function Nl({connection:e,programId:t,governanceProgramId:r,voteWeightAddinProgramId:n,realm:i,communityTokenMint:o,owner:s,poolId:a,tokenProgram:c}){let u=Ct(n,i,o).publicKey,l=re({programId:t,poolId:a,owner:s,version:3}),d=await e.getAccountInfo(l);if(d===null)throw Error("user is not staker");let f=Ke.decode(d.data),m=f.deposited.sub(f.voteLockedBalance);if(console.log("amount",m.toString()),m.eq(new rt(0)))throw Error("user do not has new stake amount");let h=Vt(t,a).publicKey,b=Ft(t,a).publicKey,{publicKey:T,nonce:k}=vt(n,u,s),F=ve(T,h,c).publicKey,{publicKey:B,nonce:M}=Et(n,u,s),ue=_t(r,i,o,s).publicKey,j=[],pe=ve(s,h,c).publicKey;if(await e.getAccountInfo(pe)===null&&j.push(Si(s,pe,s,h)),await e.getAccountInfo(T)===null){let Te=Ri(r,i,s,o,s,ue);j.push(Te,Ki(n,u,T,B,s,s,k,M))}let{index:Pe,isInit:J}=await Nt(e,u,T,h);return J||j.push(Ni(n,u,T,F,s,s,h,Pe,0,void 0,0,!1)),j.push(Li(n,u,T,F,pe,s,l,a,h,b,t,Pe,m),Ii(n,u,T,B)),j}async function Cl({connection:e,programId:t,governanceProgramId:r,voteWeightAddinProgramId:n,realm:i,communityTokenMint:o,owner:s,poolId:a,tokenProgram:c}){let u=Ct(n,i,o).publicKey,l=re({programId:t,poolId:a,owner:s,version:3}),d=await e.getAccountInfo(l);if(d===null)throw Error("user is not staker");let f=Ke.decode(d.data);if(f.voteLockedBalance.eq(new rt(0)))throw Error("user has vote locked balance = 0");let m=Vt(t,a).publicKey,h=Ft(t,a).publicKey,{publicKey:b}=vt(n,u,s),T=ve(b,m,c).publicKey,{publicKey:k}=Et(n,u,s),F=_t(r,i,o,s).publicKey,B=[],{index:M,isInit:ue}=await Nt(e,u,b,m);if(!ue)throw Error("deposit entry index check error");return B.push(Bi(n,u,b,s,F,k,T,ve(s,m,c).publicKey,l,a,m,h,t,M,f.voteLockedBalance)),B}function Vl({payer:e,rewardVault:t,userRewardTokenPub:r,farmKeys:n,rewardInfo:i}){let o=Buffer.alloc(dt.span);dt.encode({instruction:3,rewardReopenTime:R(i.openTime),rewardEndTime:R(i.endTime),rewardPerSecond:R(i.perSecond)},o);let s=[p({pubkey:$,isWritable:!1}),p({pubkey:n.id}),p({pubkey:n.lpVault,isWritable:!1}),p({pubkey:t}),p({pubkey:r}),p({pubkey:e,isWritable:!1,isSigner:!0})];return new U({programId:n.programId,keys:s,data:o})}function Fl({payer:e,userRewardTokenPub:t,farmKeys:r,rewardVault:n,rewardInfo:i}){let o=Buffer.alloc(ft.span);ft.encode({instruction:4,isSet:new rt(1),rewardPerSecond:R(i.perSecond),rewardOpenTime:R(i.openTime),rewardEndTime:R(i.endTime),rewardType:R(ke[i.rewardType])},o);let s=[...wt,p({pubkey:r.id}),p({pubkey:r.authority,isWritable:!1}),p({pubkey:i.mint,isWritable:!1}),p({pubkey:n}),p({pubkey:t}),p({pubkey:e,isWritable:!1,isSigner:!0})];return new U({programId:r.programId,keys:s,data:o})}function vl(e){let{farmInfo:t,farmKeys:r,version:n,lpAccount:i,rewardAccounts:o,owner:s,instruction:a,amount:c,deposit:u}=e,[l,d]=[new S(t.programId),new S(t.id)],f=re({programId:l,poolId:d,owner:s,version:n}),m=Buffer.alloc(Y.span);Y.encode({instruction:a,amount:c},m);let h=n===6?[p({pubkey:$,isWritable:!1}),...u?[p({pubkey:he.programId,isWritable:!1})]:[],p({pubkey:d}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:new S(r.lpVault)}),p({pubkey:f}),p({pubkey:s,isWritable:!1,isSigner:!0}),p({pubkey:i})]:[p({pubkey:d}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:f}),p({pubkey:s,isWritable:!1,isSigner:!0}),p({pubkey:i}),p({pubkey:new S(r.lpVault)}),p({pubkey:o[0]}),p({pubkey:new S(r.rewardInfos[0].vault)}),p({pubkey:_e,isWritable:!1}),p({pubkey:$,isWritable:!1})];if(n===5)for(let b=1;b<r.rewardInfos.length;b++)h.push(p({pubkey:o[b]})),h.push(p({pubkey:new S(r.rewardInfos[b].vault)}));if(n===6)for(let b=0;b<r.rewardInfos.length;b++)h.push(p({pubkey:new S(r.rewardInfos[b].vault)})),h.push(p({pubkey:o[b]}));return new U({programId:l,keys:h,data:m})}function El(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:i,owner:o,amount:s}=e,[a,c]=[new S(t.programId),new S(t.id)],u=re({programId:a,poolId:c,owner:o,version:6}),l=Buffer.alloc(Y.span);Y.encode({instruction:2,amount:R(s)},l);let d=[p({pubkey:$,isWritable:!1}),p({pubkey:c}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:new S(r.lpVault)}),p({pubkey:u}),p({pubkey:o,isWritable:!1,isSigner:!0}),p({pubkey:n})];for(let f=0;f<r.rewardInfos.length;f++)d.push(p({pubkey:new S(r.rewardInfos[f].vault)})),d.push(p({pubkey:i[f]}));return new U({programId:a,keys:d,data:l})}function _l(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:i,owner:o,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new S(t.programId),new S(t.id)],l=re({programId:c,poolId:u,owner:o,version:5}),d=Buffer.alloc(Y.span);Y.encode({instruction:12,amount:R(s)},d);let f=[p({pubkey:u}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:l}),p({pubkey:o,isWritable:!1,isSigner:!0}),p({pubkey:n}),p({pubkey:new S(r.lpVault)}),p({pubkey:i[0]}),p({pubkey:new S(r.rewardInfos[0].vault)}),p({pubkey:_e,isWritable:!1}),p({pubkey:$,isWritable:!1})];for(let m=1;m<r.rewardInfos.length;m++)f.push(p({pubkey:i[m]})),f.push(p({pubkey:new S(r.rewardInfos[m].vault)}));if(a)for(let m of a)f.push(p({pubkey:m}));return new U({programId:c,keys:f,data:d})}function Ml(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:i,owner:o,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new S(t.programId),new S(t.id)],l=re({programId:c,poolId:u,owner:o,version:3}),d=Buffer.alloc(Y.span);Y.encode({instruction:11,amount:R(s)},d);let f=[p({pubkey:u}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:l}),p({pubkey:o,isWritable:!1,isSigner:!0}),p({pubkey:n}),p({pubkey:new S(r.lpVault)}),p({pubkey:i[0]}),p({pubkey:new S(r.rewardInfos[0].vault)}),p({pubkey:_e,isWritable:!1}),p({pubkey:$,isWritable:!1})];if(a)for(let m of a)f.push(p({pubkey:m}));return new U({programId:c,keys:f,data:d})}function Dl(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:i,owner:o,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new S(t.programId),new S(t.id)],l=re({programId:c,poolId:u,owner:o,version:3}),d=Buffer.alloc(Y.span);Y.encode({instruction:10,amount:R(s)},d);let f=[p({pubkey:u}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:l}),p({pubkey:o,isWritable:!1,isSigner:!0}),p({pubkey:n}),p({pubkey:new S(r.lpVault)}),p({pubkey:i[0]}),p({pubkey:new S(r.rewardInfos[0].vault)}),p({pubkey:_e,isWritable:!1}),p({pubkey:$,isWritable:!1})];if(a)for(let m of a)f.push(p({pubkey:m}));return new U({programId:c,keys:f,data:d})}function Wl(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:i,owner:o,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new S(t.programId),new S(t.id)],l=re({programId:c,poolId:u,owner:o,version:5}),d=Buffer.alloc(Y.span);Y.encode({instruction:11,amount:R(s)},d);let f=[p({pubkey:u}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:l}),p({pubkey:o,isWritable:!1,isSigner:!0}),p({pubkey:n}),p({pubkey:new S(r.lpVault)}),p({pubkey:i[0]}),p({pubkey:new S(r.rewardInfos[0].vault)}),p({pubkey:_e,isWritable:!1}),p({pubkey:$,isWritable:!1})];for(let m=1;m<r.rewardInfos.length;m++)f.push(p({pubkey:i[m]})),f.push(p({pubkey:new S(r.rewardInfos[m].vault)}));if(a)for(let m of a)f.push(p({pubkey:m}));return new U({programId:c,keys:f,data:d})}function Ol(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:i,owner:o,amount:s}=e,[a,c]=[new S(t.programId),new S(t.id)],u=re({programId:a,poolId:c,owner:o,version:6}),l=Buffer.alloc(Y.span);Y.encode({instruction:1,amount:R(s)},l);let d=[p({pubkey:$,isWritable:!1}),p({pubkey:he.programId,isWritable:!1}),p({pubkey:c}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:new S(r.lpVault)}),p({pubkey:u}),p({pubkey:o,isWritable:!1,isSigner:!0}),p({pubkey:n})];for(let f=0;f<r.rewardInfos.length;f++)d.push(p({pubkey:new S(r.rewardInfos[f].vault)})),d.push(p({pubkey:i[f]}));return new U({programId:a,keys:d,data:l})}export{us as FARM_LOCK_MINT,cs as FARM_LOCK_VAULT,fs as FARM_PROGRAM_TO_VERSION,Qt as FARM_VERSION_TO_LEDGER_LAYOUT,Jt as FARM_VERSION_TO_STATE_LAYOUT,or as Voter,en as VoterDepositEntry,$r as VoterLockup,ir as VoterRegistrar,Qr as VoterVotingMintConfig,ut as associatedLedgerAccountLayout,al as calFarmRewardAmount,Bl as createAssociatedLedgerAccountInstruction,Y as dwLayout,ft as farmAddRewardLayout,ws as farmLedgerLayoutV3_1,Ke as farmLedgerLayoutV3_2,Ps as farmLedgerLayoutV5_1,rr as farmLedgerLayoutV5_2,nr as farmLedgerLayoutV6_1,sl as farmRewardInfoToConfig,lt as farmRewardLayout,dt as farmRewardRestartLayout,Jr as farmRewardTimeInfoLayout,$t as farmStateV3Layout,er as farmStateV5Layout,tr as farmStateV6Layout,ul as fetchMultipleFarmInfoAndUpdate,ol as getAssociatedAuthority,re as getAssociatedLedgerAccount,il as getAssociatedLedgerPoolAccount,Nt as getDepositEntryIndex,wi as getFarmLedgerLayout,Pi as getFarmStateLayout,Ct as getRegistrarAddress,_t as getTokenOwnerRecordAddress,vt as getVoterAddress,Et as getVoterWeightRecordAddress,Ft as getVotingMintAuthority,Vt as getVotingTokenMint,Ri as governanceCreateTokenOwnerRecord,ls as isValidFarmVersion,cl as judgeFarmType,Fl as makeAddNewRewardInstruction,Rl as makeCreateFarmInstruction,Kl as makeCreatorWithdrawFarmRewardInstruction,Dl as makeDepositInstructionV3,Wl as makeDepositInstructionV5,Ol as makeDepositInstructionV6,Nl as makeDepositTokenInstruction,vl as makeDepositWithdrawInstruction,Vl as makeRestartRewardInstruction,Ml as makeWithdrawInstructionV3,_l as makeWithdrawInstructionV5,El as makeWithdrawInstructionV6,Cl as makeWithdrawTokenInstruction,ke as poolTypeV6,zr as realFarmStateV3Layout,Zr as realFarmStateV5Layout,Xr as realFarmV6Layout,Ti as updateFarmPoolInfo,ds as validateFarmRewards,Ni as voterStakeRegistryCreateDepositEntry,Ki as voterStakeRegistryCreateVoter,Li as voterStakeRegistryDeposit,Ii as voterStakeRegistryUpdateVoterWeightRecord,Bi as voterStakeRegistryWithdraw,ct as withdrawRewardLayout};
/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */
//# sourceMappingURL=index.mjs.map